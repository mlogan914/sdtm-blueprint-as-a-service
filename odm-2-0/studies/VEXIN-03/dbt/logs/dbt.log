[0m21:27:43.410369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084d9c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084c730490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084c730430>]}


============================== 21:27:43.413638 | 4cc70c26-c26d-4ec8-9d23-6a4c085529a8 ==============================
[0m21:27:43.413638 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:27:43.414524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:27:43.424056 [info ] [MainThread]: dbt version: 1.10.4
[0m21:27:43.424736 [info ] [MainThread]: python version: 3.10.12
[0m21:27:43.425197 [info ] [MainThread]: python path: /home/mlogan/projects/baas/adapters/tests/odm_json/.venv/bin/python3
[0m21:27:43.425650 [info ] [MainThread]: os info: Linux-6.8.0-60-generic-x86_64-with-glibc2.35
[0m21:27:43.585454 [info ] [MainThread]: Using profiles dir at /home/mlogan/.dbt
[0m21:27:43.586269 [info ] [MainThread]: Using profiles.yml file at /home/mlogan/.dbt/profiles.yml
[0m21:27:43.586765 [info ] [MainThread]: Using dbt_project.yml file at /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml
[0m21:27:43.589886 [info ] [MainThread]: adapter type: duckdb
[0m21:27:43.590611 [info ] [MainThread]: adapter version: 1.9.4
[0m21:27:43.778182 [info ] [MainThread]: Configuration:
[0m21:27:43.779022 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:27:43.779529 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:27:43.780054 [info ] [MainThread]: Required dependencies:
[0m21:27:43.780447 [debug] [MainThread]: Executing "git --help"
[0m21:27:43.785842 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:27:43.786307 [debug] [MainThread]: STDERR: "b''"
[0m21:27:43.786698 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:27:43.787485 [info ] [MainThread]: Connection:
[0m21:27:43.787997 [info ] [MainThread]:   database: dev
[0m21:27:43.788392 [info ] [MainThread]:   schema: main
[0m21:27:43.788820 [info ] [MainThread]:   path: dev.duckdb
[0m21:27:43.789209 [info ] [MainThread]:   config_options: None
[0m21:27:43.789640 [info ] [MainThread]:   extensions: None
[0m21:27:43.790093 [info ] [MainThread]:   settings: {}
[0m21:27:43.790550 [info ] [MainThread]:   external_root: .
[0m21:27:43.790935 [info ] [MainThread]:   use_credential_provider: None
[0m21:27:43.791315 [info ] [MainThread]:   attach: None
[0m21:27:43.793776 [info ] [MainThread]:   filesystems: None
[0m21:27:43.794098 [info ] [MainThread]:   remote: None
[0m21:27:43.794903 [info ] [MainThread]:   plugins: None
[0m21:27:43.795382 [info ] [MainThread]:   disable_transactions: False
[0m21:27:43.795984 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m21:27:43.993169 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:27:44.031199 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:27:44.031989 [debug] [MainThread]: On debug: select 1 as id
[0m21:27:44.033033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:44.097358 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m21:27:44.101099 [debug] [MainThread]: On debug: Close
[0m21:27:44.103070 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:27:44.103831 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:27:44.105071 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7794222, "process_in_blocks": "0", "process_kernel_time": 1.933793, "process_mem_max_rss": "135628", "process_out_blocks": "48", "process_user_time": 0.859131}
[0m21:27:44.105731 [debug] [MainThread]: Command `dbt debug` succeeded at 21:27:44.105610 after 0.78 seconds
[0m21:27:44.106237 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:27:44.106709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084d9c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084c7303d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e084edb65f0>]}
[0m21:27:44.107207 [debug] [MainThread]: Flushing usage events
[0m21:27:44.467254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:55.076641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7064b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7052200a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df705220100>]}


============================== 14:25:55.082641 | 92a29987-12a0-4b74-b18a-53376ac2ea8b ==============================
[0m14:25:55.082641 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:25:55.083913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:55.097014 [info ] [MainThread]: dbt version: 1.10.4
[0m14:25:55.097622 [info ] [MainThread]: python version: 3.10.12
[0m14:25:55.098107 [info ] [MainThread]: python path: /home/mlogan/projects/baas/adapters/tests/odm_json/.venv/bin/python3
[0m14:25:55.098627 [info ] [MainThread]: os info: Linux-6.8.0-60-generic-x86_64-with-glibc2.35
[0m14:25:55.236969 [info ] [MainThread]: Using profiles dir at /home/mlogan/.dbt
[0m14:25:55.238319 [info ] [MainThread]: Using profiles.yml file at /home/mlogan/.dbt/profiles.yml
[0m14:25:55.239323 [info ] [MainThread]: Using dbt_project.yml file at /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml
[0m14:25:55.242746 [info ] [MainThread]: adapter type: duckdb
[0m14:25:55.243665 [info ] [MainThread]: adapter version: 1.9.4
[0m14:25:55.459250 [info ] [MainThread]: Configuration:
[0m14:25:55.460318 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:25:55.460939 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:25:55.461418 [info ] [MainThread]: Required dependencies:
[0m14:25:55.461955 [debug] [MainThread]: Executing "git --help"
[0m14:25:55.465674 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:25:55.466266 [debug] [MainThread]: STDERR: "b''"
[0m14:25:55.466700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:25:55.467474 [info ] [MainThread]: Connection:
[0m14:25:55.468025 [info ] [MainThread]:   database: dev
[0m14:25:55.468471 [info ] [MainThread]:   schema: main
[0m14:25:55.468931 [info ] [MainThread]:   path: dev.duckdb
[0m14:25:55.469400 [info ] [MainThread]:   config_options: None
[0m14:25:55.469864 [info ] [MainThread]:   extensions: None
[0m14:25:55.470330 [info ] [MainThread]:   settings: {}
[0m14:25:55.470819 [info ] [MainThread]:   external_root: .
[0m14:25:55.471284 [info ] [MainThread]:   use_credential_provider: None
[0m14:25:55.471842 [info ] [MainThread]:   attach: None
[0m14:25:55.472600 [info ] [MainThread]:   filesystems: None
[0m14:25:55.473050 [info ] [MainThread]:   remote: None
[0m14:25:55.473650 [info ] [MainThread]:   plugins: None
[0m14:25:55.476651 [info ] [MainThread]:   disable_transactions: False
[0m14:25:55.477615 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:25:55.644755 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:25:55.669889 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:25:55.670526 [debug] [MainThread]: On debug: select 1 as id
[0m14:25:55.671014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:55.683009 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m14:25:55.684300 [debug] [MainThread]: On debug: Close
[0m14:25:55.685177 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:25:55.698866 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:25:55.699989 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7298081, "process_in_blocks": "0", "process_kernel_time": 0.195405, "process_mem_max_rss": "135628", "process_out_blocks": "24", "process_user_time": 2.042873}
[0m14:25:55.700608 [debug] [MainThread]: Command `dbt debug` succeeded at 14:25:55.700490 after 0.73 seconds
[0m14:25:55.701000 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:25:55.701444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7064b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df70508d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df7061775b0>]}
[0m14:25:55.701890 [debug] [MainThread]: Flushing usage events
[0m14:25:56.054650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:03.515714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b27c74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b15401f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b1540190>]}


============================== 15:26:03.521112 | 5416ae83-febe-4717-8cdc-68e55378a4af ==============================
[0m15:26:03.521112 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:26:03.523101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select example', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:03.886195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5416ae83-febe-4717-8cdc-68e55378a4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b14e9870>]}
[0m15:26:03.974420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5416ae83-febe-4717-8cdc-68e55378a4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b150ece0>]}
[0m15:26:03.976284 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:26:04.140434 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:26:04.141456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:26:04.142190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5416ae83-febe-4717-8cdc-68e55378a4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2ad5f8970>]}
[0m15:26:05.667493 [error] [MainThread]: Encountered an error:
Compilation Error in model dm (models/sdtm/dm.sql)
  no loader for this environment specified
[0m15:26:05.670904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.232993, "process_in_blocks": "3520", "process_kernel_time": 0.739582, "process_mem_max_rss": "120904", "process_out_blocks": "16", "process_user_time": 2.815185}
[0m15:26:05.671755 [debug] [MainThread]: Command `dbt run` failed at 15:26:05.671603 after 2.24 seconds
[0m15:26:05.672326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2b27c74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2ad03fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f2ad03fc10>]}
[0m15:26:05.672966 [debug] [MainThread]: Flushing usage events
[0m15:26:06.014928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:13.846624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae42cb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae304d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae304d2d0>]}


============================== 15:27:13.852644 | c39b3bc7-74f7-49ec-95bf-4cb00d20da51 ==============================
[0m15:27:13.852644 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:27:13.854289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:14.206565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae2ff1870>]}
[0m15:27:14.307921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae301ace0>]}
[0m15:27:14.311119 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:27:14.501855 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:27:14.503159 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:27:14.504397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735adf0fc970>]}
[0m15:27:16.477524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.sdtm
[0m15:27:16.487902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ade8e4370>]}
[0m15:27:16.644863 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:27:16.651196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:27:16.677565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ade711960>]}
[0m15:27:16.678706 [info ] [MainThread]: Found 3 models, 4 data tests, 429 macros
[0m15:27:16.680021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ade712980>]}
[0m15:27:16.683687 [info ] [MainThread]: 
[0m15:27:16.684656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:16.685462 [info ] [MainThread]: 
[0m15:27:16.686447 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:27:16.696292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:27:16.776970 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:27:16.777610 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:27:16.778026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:16.840511 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m15:27:16.853754 [debug] [ThreadPool]: On list_dev: Close
[0m15:27:16.855620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:27:16.856874 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:27:16.881017 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:16.935851 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:27:16.936575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:16.938273 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:27:16.939921 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:16.940347 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:27:16.940872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:16.941249 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:16.941583 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:27:16.942316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:16.943332 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:27:16.943701 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:27:16.944037 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:27:16.944717 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:16.945136 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:27:17.021883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:27:17.038327 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:27:17.039017 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:27:17.039508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:17.040588 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:27:17.041088 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:27:17.041571 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:27:17.278235 [debug] [ThreadPool]: SQL status: OK in 0.236 seconds
[0m15:27:17.307046 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:27:17.341349 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:27:17.345846 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:27:17.403081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae5a370a0>]}
[0m15:27:17.403911 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:17.404326 [debug] [MainThread]: On master: BEGIN
[0m15:27:17.404686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:17.405514 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:27:17.405785 [debug] [MainThread]: On master: COMMIT
[0m15:27:17.406030 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:17.456809 [debug] [MainThread]: On master: COMMIT
[0m15:27:17.458023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:27:17.458718 [debug] [MainThread]: On master: Close
[0m15:27:17.560176 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m15:27:17.561789 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:27:17.567173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m15:27:17.570479 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m15:27:17.600180 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.606949 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m15:27:17.935029 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.937277 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.937850 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m15:27:17.938312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:17.939269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:17.939742 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.940233 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:27:17.952071 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:27:17.959002 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.959524 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:27:17.960685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:17.973467 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:27:17.973989 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.974426 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:27:17.979220 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:27:17.985072 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:27:17.985579 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m15:27:17.986412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:17.989072 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m15:27:17.992577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae59275e0>]}
[0m15:27:17.993404 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.42s]
[0m15:27:17.994315 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m15:27:17.995176 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m15:27:17.995763 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:27:17.996418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.my_second_dbt_model)
[0m15:27:17.996867 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m15:27:17.999947 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.000658 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m15:27:18.020963 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.023776 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.024363 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m15:27:18.024869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:18.025808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:18.026317 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.026781 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:27:18.027673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:18.034502 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.035258 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:27:18.036363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:27:18.038054 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:27:18.038549 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.039029 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:27:18.044979 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:27:18.054226 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:27:18.055887 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m15:27:18.057357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:18.059492 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m15:27:18.060680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39b3bc7-74f7-49ec-95bf-4cb00d20da51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735aded85570>]}
[0m15:27:18.061603 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m15:27:18.062730 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m15:27:18.063948 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:18.064342 [debug] [MainThread]: On master: BEGIN
[0m15:27:18.065093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:18.065910 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:27:18.066327 [debug] [MainThread]: On master: COMMIT
[0m15:27:18.066813 [debug] [MainThread]: Using duckdb connection "master"
[0m15:27:18.068709 [debug] [MainThread]: On master: COMMIT
[0m15:27:18.069485 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:27:18.069941 [debug] [MainThread]: On master: Close
[0m15:27:18.070627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:18.071042 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m15:27:18.071489 [info ] [MainThread]: 
[0m15:27:18.072089 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m15:27:18.073009 [debug] [MainThread]: Command end result
[0m15:27:18.128647 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:27:18.134480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:27:18.153016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:27:18.154014 [info ] [MainThread]: 
[0m15:27:18.155857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:18.157102 [info ] [MainThread]: 
[0m15:27:18.158234 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:27:18.161017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4277635, "process_in_blocks": "3400", "process_kernel_time": 0.774063, "process_mem_max_rss": "151032", "process_out_blocks": "2752", "process_user_time": 3.99254}
[0m15:27:18.162359 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:18.162056 after 4.43 seconds
[0m15:27:18.163385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae42cb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ade8ede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735ae4e4b9d0>]}
[0m15:27:18.164415 [debug] [MainThread]: Flushing usage events
[0m15:27:18.529984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:06.374619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e72ebb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e71c45540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e71c454e0>]}


============================== 09:07:06.379751 | bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f ==============================
[0m09:07:06.379751 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:07:06.380823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --vars {domain: "DM"}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:07:06.895125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e71e69510>]}
[0m09:07:07.019408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e724cc220>]}
[0m09:07:07.023578 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:07:07.221160 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m09:07:07.437209 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:07:07.438856 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m09:07:07.440329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6da92980>]}
[0m09:07:09.675610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.sdtm
[0m09:07:09.684053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6d344d90>]}
[0m09:07:09.845021 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m09:07:09.852443 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m09:07:09.917249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6d31d840>]}
[0m09:07:09.918437 [info ] [MainThread]: Found 3 models, 4 data tests, 430 macros
[0m09:07:09.919584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc9ae01d-c39b-40a5-a9fb-4e5240a88d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6d31d7b0>]}
[0m09:07:09.922073 [info ] [MainThread]: 
[0m09:07:09.922845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:09.923384 [info ] [MainThread]: 
[0m09:07:09.924152 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:07:09.942202 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:07:10.015979 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:07:10.016676 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:07:10.017135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:10.144041 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:07:10.145604 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:07:10.148165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:10.148615 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:07:10.148996 [info ] [MainThread]: 
[0m09:07:10.150907 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m09:07:10.151637 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dev.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 23099) by user mlogan. See also https://duckdb.org/docs/stable/connect/concurrency
[0m09:07:10.154346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.873601, "process_in_blocks": "11520", "process_kernel_time": 1.467034, "process_mem_max_rss": "143424", "process_out_blocks": "1784", "process_user_time": 3.986184}
[0m09:07:10.154914 [debug] [MainThread]: Command `dbt run` failed at 09:07:10.154797 after 3.87 seconds
[0m09:07:10.155421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e72ebb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6d31dfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796e6d390790>]}
[0m09:07:10.155875 [debug] [MainThread]: Flushing usage events
[0m09:07:10.543631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:07:47.565737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7658930b35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765891e3d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765891e3d420>]}


============================== 09:07:47.572243 | 2fc16477-0ccf-42c2-b5d4-a1d03ecedaee ==============================
[0m09:07:47.572243 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:07:47.573861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m09:07:47.962738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fc16477-0ccf-42c2-b5d4-a1d03ecedaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765891e06020>]}
[0m09:07:48.100350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fc16477-0ccf-42c2-b5d4-a1d03ecedaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765891e3f070>]}
[0m09:07:48.107884 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:07:48.327005 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m09:07:48.550489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:07:48.551496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:07:48.568458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.sdtm
[0m09:07:48.659215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fc16477-0ccf-42c2-b5d4-a1d03ecedaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76588da50130>]}
[0m09:07:48.805405 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m09:07:48.808147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m09:07:48.820197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fc16477-0ccf-42c2-b5d4-a1d03ecedaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76588dbfcbb0>]}
[0m09:07:48.820821 [info ] [MainThread]: Found 3 models, 4 data tests, 430 macros
[0m09:07:48.821526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fc16477-0ccf-42c2-b5d4-a1d03ecedaee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76588df83730>]}
[0m09:07:48.823543 [info ] [MainThread]: 
[0m09:07:48.824124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:07:48.824567 [info ] [MainThread]: 
[0m09:07:48.825208 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:07:48.830479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:07:48.962342 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:07:48.963728 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:07:48.964817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:07:48.986081 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:07:48.987467 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:07:48.992415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:48.992791 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:07:48.993063 [info ] [MainThread]: 
[0m09:07:49.003275 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m09:07:49.005022 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dev.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 23099) by user mlogan. See also https://duckdb.org/docs/stable/connect/concurrency
[0m09:07:49.007413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5209707, "process_in_blocks": "0", "process_kernel_time": 0.515891, "process_mem_max_rss": "136232", "process_out_blocks": "920", "process_user_time": 2.978857}
[0m09:07:49.008464 [debug] [MainThread]: Command `dbt run` failed at 09:07:49.008237 after 1.52 seconds
[0m09:07:49.009322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7658930b35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76588debb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76588deb8e20>]}
[0m09:07:49.010223 [debug] [MainThread]: Flushing usage events
[0m09:07:49.382747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:32.882318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfdcbb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfca45540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfca454e0>]}


============================== 09:08:32.887718 | e607361f-fb3c-4d16-86f2-0cdee209690f ==============================
[0m09:08:32.887718 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:08:32.889070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --vars {domain: "DM"}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:08:33.182814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e607361f-fb3c-4d16-86f2-0cdee209690f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfcc69510>]}
[0m09:08:33.306202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e607361f-fb3c-4d16-86f2-0cdee209690f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfd2cc220>]}
[0m09:08:33.309202 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:08:33.515672 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m09:08:33.773625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:33.774698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:33.791249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.sdtm
[0m09:08:33.882215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e607361f-fb3c-4d16-86f2-0cdee209690f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bf8658130>]}
[0m09:08:33.985901 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m09:08:33.989132 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m09:08:34.001669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e607361f-fb3c-4d16-86f2-0cdee209690f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bf860e7a0>]}
[0m09:08:34.002244 [info ] [MainThread]: Found 3 models, 4 data tests, 430 macros
[0m09:08:34.002895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e607361f-fb3c-4d16-86f2-0cdee209690f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bf860dc30>]}
[0m09:08:34.004641 [info ] [MainThread]: 
[0m09:08:34.005209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:34.005656 [info ] [MainThread]: 
[0m09:08:34.006302 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:08:34.014983 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:08:34.200640 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:08:34.201460 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:08:34.202091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:34.210072 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:08:34.211780 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:08:34.213604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:34.214645 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m09:08:34.215568 [info ] [MainThread]: 
[0m09:08:34.216834 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m09:08:34.218390 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dev.duckdb": Conflicting lock is held in /snap/duckdb/9/duckdb (PID 23099) by user mlogan. See also https://duckdb.org/docs/stable/connect/concurrency
[0m09:08:34.220668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4828, "process_in_blocks": "0", "process_kernel_time": 0.514426, "process_mem_max_rss": "136336", "process_out_blocks": "912", "process_user_time": 2.837644}
[0m09:08:34.222792 [debug] [MainThread]: Command `dbt run` failed at 09:08:34.222528 after 1.49 seconds
[0m09:08:34.223933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bfdcbb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bf860fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743bf8ac2e60>]}
[0m09:08:34.224984 [debug] [MainThread]: Flushing usage events
[0m09:08:34.573538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:52.861707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2454bb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a244241480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a244241420>]}


============================== 09:08:52.867940 | 5c6e511a-b438-401e-bb01-96b3591e5865 ==============================
[0m09:08:52.867940 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:08:52.869484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --vars {domain: "DM"}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:08:53.266207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a24420e020>]}
[0m09:08:53.394875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a244243070>]}
[0m09:08:53.398160 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:08:53.623233 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m09:08:53.827196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:08:53.827770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:08:53.840202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.sdtm
[0m09:08:53.922306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a23fe58130>]}
[0m09:08:54.068674 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m09:08:54.071653 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m09:08:54.100436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a23fffcbb0>]}
[0m09:08:54.101726 [info ] [MainThread]: Found 3 models, 4 data tests, 430 macros
[0m09:08:54.102730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a24038b730>]}
[0m09:08:54.106307 [info ] [MainThread]: 
[0m09:08:54.106979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:08:54.107549 [info ] [MainThread]: 
[0m09:08:54.108356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:08:54.113832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m09:08:54.227120 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m09:08:54.227914 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m09:08:54.228563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:08:54.291231 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m09:08:54.295816 [debug] [ThreadPool]: On list_dev: Close
[0m09:08:54.297760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m09:08:54.299133 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m09:08:54.311726 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:08:54.314011 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m09:08:54.315027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:54.318301 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:08:54.321538 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:08:54.322730 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m09:08:54.323944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:08:54.324852 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:08:54.325638 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m09:08:54.326600 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:08:54.335782 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:08:54.336263 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m09:08:54.336594 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m09:08:54.337303 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:08:54.337655 [debug] [ThreadPool]: On create_dev_main: Close
[0m09:08:54.339557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m09:08:54.346189 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:08:54.346689 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m09:08:54.347070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:08:54.347831 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m09:08:54.348214 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m09:08:54.348968 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m09:08:54.366908 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m09:08:54.368999 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m09:08:54.375349 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m09:08:54.375903 [debug] [ThreadPool]: On list_dev_main: Close
[0m09:08:54.379873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a23fe91a50>]}
[0m09:08:54.382359 [debug] [MainThread]: Using duckdb connection "master"
[0m09:08:54.382913 [debug] [MainThread]: On master: BEGIN
[0m09:08:54.383343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:08:54.384310 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:08:54.384798 [debug] [MainThread]: On master: COMMIT
[0m09:08:54.385230 [debug] [MainThread]: Using duckdb connection "master"
[0m09:08:54.385633 [debug] [MainThread]: On master: COMMIT
[0m09:08:54.386335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:08:54.386845 [debug] [MainThread]: On master: Close
[0m09:08:54.392944 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m09:08:54.393938 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:08:54.395023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m09:08:54.395752 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m09:08:54.410176 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.412819 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m09:08:54.492039 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.494910 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.495827 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m09:08:54.496592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:54.497848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.498401 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.498947 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:08:54.504541 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:08:54.525658 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.527314 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:08:54.531128 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:08:54.541472 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.542827 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:08:54.544601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.592940 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m09:08:54.594036 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.595324 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m09:08:54.606257 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m09:08:54.623840 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m09:08:54.624924 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m09:08:54.631242 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m09:08:54.640098 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m09:08:54.647658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a246a5b6d0>]}
[0m09:08:54.649416 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.25s]
[0m09:08:54.651290 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m09:08:54.652797 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m09:08:54.654330 [info ] [Thread-1 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:08:54.655710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.my_second_dbt_model)
[0m09:08:54.656717 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m09:08:54.666510 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.671034 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m09:08:54.718261 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.721142 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.722155 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m09:08:54.723381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:54.724625 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.725278 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.726579 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:08:54.729337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.741606 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.742421 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:08:54.743900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.753750 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.755373 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:08:54.757166 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:08:54.759952 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m09:08:54.761140 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.762267 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m09:08:54.769909 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:08:54.777201 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m09:08:54.778278 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m09:08:54.785236 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m09:08:54.789121 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m09:08:54.790877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6e511a-b438-401e-bb01-96b3591e5865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a240396440>]}
[0m09:08:54.792733 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m09:08:54.794626 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m09:08:54.797035 [debug] [MainThread]: Using duckdb connection "master"
[0m09:08:54.798449 [debug] [MainThread]: On master: BEGIN
[0m09:08:54.799354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:08:54.800797 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m09:08:54.801774 [debug] [MainThread]: On master: COMMIT
[0m09:08:54.802674 [debug] [MainThread]: Using duckdb connection "master"
[0m09:08:54.803526 [debug] [MainThread]: On master: COMMIT
[0m09:08:54.804742 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:08:54.805688 [debug] [MainThread]: On master: Close
[0m09:08:54.806903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:08:54.807815 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m09:08:54.809608 [info ] [MainThread]: 
[0m09:08:54.810775 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m09:08:54.812779 [debug] [MainThread]: Command end result
[0m09:08:54.890332 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m09:08:54.896574 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m09:08:54.905649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m09:08:54.906281 [info ] [MainThread]: 
[0m09:08:54.907037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:08:54.907583 [info ] [MainThread]: 
[0m09:08:54.908294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m09:08:54.910581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1550512, "process_in_blocks": "816", "process_kernel_time": 0.694124, "process_mem_max_rss": "145628", "process_out_blocks": "1872", "process_user_time": 3.260768}
[0m09:08:54.911445 [debug] [MainThread]: Command `dbt run` succeeded at 09:08:54.911254 after 2.16 seconds
[0m09:08:54.912090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2454bb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a246a5a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a23ffea5f0>]}
[0m09:08:54.912556 [debug] [MainThread]: Flushing usage events
[0m09:08:55.297323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:09:52.966916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3efebf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3eec45330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3eec452d0>]}


============================== 09:09:52.971261 | 6009345c-8a9c-4be0-87ec-35b6f54fcca2 ==============================
[0m09:09:52.971261 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:09:52.972023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --vars {domain: "DM"}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:09:53.386641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6009345c-8a9c-4be0-87ec-35b6f54fcca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3ef401900>]}
[0m09:09:53.458831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6009345c-8a9c-4be0-87ec-35b6f54fcca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3eec45420>]}
[0m09:09:53.460442 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m09:09:53.647780 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m09:09:53.863683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:09:53.865018 [debug] [MainThread]: Partial parsing: added file: VEXIN_03://models/sdtm/dm.sql
[0m09:09:54.225900 [error] [MainThread]: Encountered an error:
Compilation Error in model dm (models/sdtm/dm.sql)
  no loader for this environment specified
[0m09:09:54.227403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3862531, "process_in_blocks": "8", "process_kernel_time": 0.420929, "process_mem_max_rss": "121276", "process_out_blocks": "8", "process_user_time": 2.817647}
[0m09:09:54.228031 [debug] [MainThread]: Command `dbt run` failed at 09:09:54.227913 after 1.39 seconds
[0m09:09:54.228529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3efebf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3ea7444f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b3ea746e00>]}
[0m09:09:54.228989 [debug] [MainThread]: Flushing usage events
[0m09:09:54.573619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:02.494235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e838c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e82645420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e826453c0>]}


============================== 10:06:02.497526 | aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5 ==============================
[0m10:06:02.497526 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:06:02.498299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:06:02.877891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e82e05930>]}
[0m10:06:03.000001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e84ca7b20>]}
[0m10:06:03.004005 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:06:03.180922 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:06:03.402747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:06:03.403613 [debug] [MainThread]: Partial parsing: added file: VEXIN_03://models/sdtm/dm.sql
[0m10:06:03.915182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e7e3d6c20>]}
[0m10:06:04.083766 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:06:04.090666 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:06:04.111300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e7e23f880>]}
[0m10:06:04.112005 [info ] [MainThread]: Found 4 models, 4 data tests, 430 macros
[0m10:06:04.112947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e7e23e8c0>]}
[0m10:06:04.114580 [info ] [MainThread]: 
[0m10:06:04.115205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:06:04.115690 [info ] [MainThread]: 
[0m10:06:04.116367 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:06:04.118437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:06:04.171845 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:06:04.173480 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:06:04.174663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:04.215632 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m10:06:04.217512 [debug] [ThreadPool]: On list_dev: Close
[0m10:06:04.218588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:06:04.219246 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:06:04.227428 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:06:04.227793 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:06:04.228090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:04.229061 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:06:04.230280 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:06:04.231131 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:06:04.231710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:06:04.232068 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:06:04.232450 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:06:04.232967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:06:04.233649 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:06:04.233923 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:06:04.234277 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:06:04.234736 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:06:04.235092 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:06:04.241060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m10:06:04.247756 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:06:04.248732 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:06:04.249534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:04.250340 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:06:04.251158 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:06:04.251937 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:06:04.286443 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m10:06:04.290159 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:06:04.291547 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:06:04.292483 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:06:04.295659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e7e23dff0>]}
[0m10:06:04.296963 [debug] [MainThread]: Using duckdb connection "master"
[0m10:06:04.297897 [debug] [MainThread]: On master: BEGIN
[0m10:06:04.298802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:04.300261 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:06:04.301015 [debug] [MainThread]: On master: COMMIT
[0m10:06:04.301481 [debug] [MainThread]: Using duckdb connection "master"
[0m10:06:04.302299 [debug] [MainThread]: On master: COMMIT
[0m10:06:04.303397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:06:04.304253 [debug] [MainThread]: On master: Close
[0m10:06:04.308237 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m10:06:04.309372 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m10:06:04.310608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m10:06:04.311437 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m10:06:04.334453 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m10:06:04.339162 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m10:06:04.388131 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m10:06:04.391397 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:06:04.392002 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m10:06:04.392546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:04.393564 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:06:04.394106 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:06:04.394737 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM { ref('raw_dm') };
  );

[0m10:06:04.402787 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM { ref('raw_dm') };
  );

[0m10:06:04.403399 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:06:04.404036 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m10:06:04.423559 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m10:06:04.424186 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m10:06:04.425636 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{"
[0m10:06:04.429422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa8f3c01-bb2a-454f-bc99-7e861ed8c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e7e2570a0>]}
[0m10:06:04.431068 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.12s]
[0m10:06:04.433688 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m10:06:04.434881 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{".
[0m10:06:04.438143 [debug] [MainThread]: Using duckdb connection "master"
[0m10:06:04.439064 [debug] [MainThread]: On master: BEGIN
[0m10:06:04.439873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:04.441305 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:06:04.442125 [debug] [MainThread]: On master: COMMIT
[0m10:06:04.443861 [debug] [MainThread]: Using duckdb connection "master"
[0m10:06:04.444609 [debug] [MainThread]: On master: COMMIT
[0m10:06:04.445663 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:06:04.446461 [debug] [MainThread]: On master: Close
[0m10:06:04.447598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:04.448340 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m10:06:04.448790 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m10:06:04.449377 [info ] [MainThread]: 
[0m10:06:04.450253 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:06:04.451473 [debug] [MainThread]: Command end result
[0m10:06:04.508579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:06:04.513133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:06:04.532680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:06:04.533864 [info ] [MainThread]: 
[0m10:06:04.536269 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:06:04.537513 [info ] [MainThread]: 
[0m10:06:04.540258 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m10:06:04.541508 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{"
[0m10:06:04.542901 [info ] [MainThread]: 
[0m10:06:04.544139 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m10:06:04.545197 [info ] [MainThread]: 
[0m10:06:04.546350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:06:04.550201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1336384, "process_in_blocks": "1728", "process_kernel_time": 0.684261, "process_mem_max_rss": "148756", "process_out_blocks": "2776", "process_user_time": 3.252256}
[0m10:06:04.551294 [debug] [MainThread]: Command `dbt run` failed at 10:06:04.550989 after 2.14 seconds
[0m10:06:04.552416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e838c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e84ca7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8e837276a0>]}
[0m10:06:04.553536 [debug] [MainThread]: Flushing usage events
[0m10:06:04.914357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:30.896047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316d5b3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316c335420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316c3353c0>]}


============================== 10:10:30.901358 | 48f5c715-2f2e-40da-9017-60d7703c19a4 ==============================
[0m10:10:30.901358 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:10:30.902791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m10:10:31.300088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48f5c715-2f2e-40da-9017-60d7703c19a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316caf5930>]}
[0m10:10:31.398759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48f5c715-2f2e-40da-9017-60d7703c19a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316e957b20>]}
[0m10:10:31.402768 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:10:31.598451 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:10:31.770329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:31.772486 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m10:10:32.122198 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.VEXIN_03.dm' (models/sdtm/dm.sql) depends on a node named 'raw_dm' which was not found
[0m10:10:32.124112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3234487, "process_in_blocks": "0", "process_kernel_time": 0.443985, "process_mem_max_rss": "121652", "process_out_blocks": "16", "process_user_time": 2.872846}
[0m10:10:32.125049 [debug] [MainThread]: Command `dbt run` failed at 10:10:32.124880 after 1.32 seconds
[0m10:10:32.125655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72316d5b3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723168156e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723168155210>]}
[0m10:10:32.126229 [debug] [MainThread]: Flushing usage events
[0m10:10:32.506085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:55.256160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417dbab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417c9c83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417c9c8370>]}


============================== 10:15:55.261757 | 030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b ==============================
[0m10:15:55.261757 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:15:55.263387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.596232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417f1b5900>]}
[0m10:15:55.737696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417c9cb370>]}
[0m10:15:55.741885 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:15:55.951262 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:15:56.164972 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:56.166230 [debug] [MainThread]: previous checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, current checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d
[0m10:15:56.167095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417d9c4040>]}
[0m10:15:58.535031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7441782a7ee0>]}
[0m10:15:58.806176 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:15:58.811754 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:15:58.845635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744173e70f40>]}
[0m10:15:58.847313 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m10:15:58.848609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744173e514e0>]}
[0m10:15:58.852740 [info ] [MainThread]: 
[0m10:15:58.853863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:58.854808 [info ] [MainThread]: 
[0m10:15:58.856146 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:15:58.858344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:15:58.931633 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:15:58.933176 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:15:58.933957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:58.950477 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:15:58.952382 [debug] [ThreadPool]: On list_dev: Close
[0m10:15:58.953444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:15:58.954162 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:15:58.962884 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:15:58.963333 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:15:58.963741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:58.964873 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:15:58.966681 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:15:58.967135 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:15:58.967757 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:15:58.968168 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:15:58.968559 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:15:58.969099 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:15:58.969971 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:15:58.970240 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:15:58.970567 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:15:58.971024 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:15:58.971376 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:15:58.978874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:15:58.985956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:15:58.986459 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:15:58.986861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:58.988023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:15:58.988467 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:15:58.988928 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:15:58.999605 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:15:59.001365 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:15:59.002111 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:15:59.002558 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:15:59.003816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744173e702b0>]}
[0m10:15:59.004528 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:59.005018 [debug] [MainThread]: On master: BEGIN
[0m10:15:59.005423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:59.006150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:15:59.006588 [debug] [MainThread]: On master: COMMIT
[0m10:15:59.006999 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:59.007393 [debug] [MainThread]: On master: COMMIT
[0m10:15:59.007966 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:15:59.009755 [debug] [MainThread]: On master: Close
[0m10:15:59.012145 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m10:15:59.014379 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m10:15:59.015357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m10:15:59.015906 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m10:15:59.016458 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m10:15:59.097056 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m10:15:59.097863 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m10:15:59.098481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:59.099569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:59.100120 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m10:15:59.100589 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"SITE" integer,"SUBJECT" integer,"SUBJID" integer,"RESCREENNUM_RAW" integer,"PREVSTUDY" text,"PREVSUBJ" integer,"RFICDTC" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m10:15:59.101832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:15:59.141444 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m10:15:59.142297 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m10:15:59.191484 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m10:15:59.206680 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m10:15:59.250464 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m10:15:59.253098 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m10:15:59.253668 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m10:15:59.261884 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m10:15:59.268632 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m10:15:59.272673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030e9ca1-dcd8-4c5c-8129-271cfa2aaf1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417f2635e0>]}
[0m10:15:59.275751 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mINSERT 40[0m in 0.26s]
[0m10:15:59.279232 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m10:15:59.281701 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:59.282666 [debug] [MainThread]: On master: BEGIN
[0m10:15:59.283261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:59.284025 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:15:59.284395 [debug] [MainThread]: On master: COMMIT
[0m10:15:59.284697 [debug] [MainThread]: Using duckdb connection "master"
[0m10:15:59.284964 [debug] [MainThread]: On master: COMMIT
[0m10:15:59.289813 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m10:15:59.292468 [debug] [MainThread]: On master: Close
[0m10:15:59.293261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:59.293639 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m10:15:59.294013 [info ] [MainThread]: 
[0m10:15:59.296247 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m10:15:59.297812 [debug] [MainThread]: Command end result
[0m10:15:59.393266 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:15:59.398181 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:15:59.406890 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:15:59.407476 [info ] [MainThread]: 
[0m10:15:59.408149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:59.408542 [info ] [MainThread]: 
[0m10:15:59.409229 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:15:59.410493 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.275365, "process_in_blocks": "1664", "process_kernel_time": 0.811906, "process_mem_max_rss": "155272", "process_out_blocks": "2760", "process_user_time": 5.125162}
[0m10:15:59.411148 [debug] [MainThread]: Command `dbt seed` succeeded at 10:15:59.410967 after 4.28 seconds
[0m10:15:59.411898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417dbab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74417da7cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744173e719f0>]}
[0m10:15:59.412462 [debug] [MainThread]: Flushing usage events
[0m10:15:59.763920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:09.390083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7309543c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730953145480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730953145420>]}


============================== 10:20:09.396293 | b1022d8c-6768-4cc6-b141-740f042a363d ==============================
[0m10:20:09.396293 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:20:09.398296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m10:20:09.749732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7309559ce2f0>]}
[0m10:20:09.840422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730953112920>]}
[0m10:20:09.842963 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:20:09.997090 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:20:10.183413 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:20:10.184227 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m10:20:10.184755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73095397eb90>]}
[0m10:20:12.211181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094e7c25c0>]}
[0m10:20:12.436689 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:20:12.439805 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:20:12.463633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094e827d60>]}
[0m10:20:12.464601 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m10:20:12.465295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094e865210>]}
[0m10:20:12.466950 [info ] [MainThread]: 
[0m10:20:12.467526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:12.467964 [info ] [MainThread]: 
[0m10:20:12.468587 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:20:12.469809 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:20:12.518065 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:20:12.519085 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:20:12.519834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:12.537992 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:20:12.539927 [debug] [ThreadPool]: On list_dev: Close
[0m10:20:12.540952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:20:12.541633 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:20:12.552558 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:20:12.553194 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:20:12.553598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:12.556132 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:20:12.557813 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:20:12.558296 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:20:12.558902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:12.559330 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:20:12.559722 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:20:12.560322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:12.561245 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:20:12.561577 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:20:12.561986 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:20:12.562494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:12.562929 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:20:12.570581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:20:12.578629 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:20:12.579118 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:20:12.579547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:12.580293 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:20:12.580725 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:20:12.581115 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:20:12.591353 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:20:12.593088 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:20:12.593834 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:20:12.594246 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:20:12.595616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094e825840>]}
[0m10:20:12.596232 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:12.596613 [debug] [MainThread]: On master: BEGIN
[0m10:20:12.596970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:12.598172 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:20:12.598607 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.599034 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:12.599426 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.599965 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:20:12.600315 [debug] [MainThread]: On master: Close
[0m10:20:12.602305 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m10:20:12.603050 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m10:20:12.604125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m10:20:12.605183 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m10:20:12.629236 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m10:20:12.634743 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m10:20:12.689696 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m10:20:12.692699 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:20:12.693540 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m10:20:12.693911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:12.694755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:20:12.695125 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:20:12.695687 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm";
  );

[0m10:20:12.696631 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm";
  );

[0m10:20:12.697070 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:20:12.697607 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m10:20:12.699400 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m10:20:12.699873 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m10:20:12.702060 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";"
[0m10:20:12.706462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1022d8c-6768-4cc6-b141-740f042a363d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730954489a50>]}
[0m10:20:12.707963 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.10s]
[0m10:20:12.709552 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m10:20:12.710672 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";".
[0m10:20:12.713488 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:12.715569 [debug] [MainThread]: On master: BEGIN
[0m10:20:12.716350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:12.717663 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:20:12.718462 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.719220 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:12.719943 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.721022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:20:12.721804 [debug] [MainThread]: On master: Close
[0m10:20:12.722707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:12.723328 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m10:20:12.724034 [info ] [MainThread]: 
[0m10:20:12.725753 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m10:20:12.728238 [debug] [MainThread]: Command end result
[0m10:20:12.780763 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:20:12.785350 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:20:12.808482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:20:12.809402 [info ] [MainThread]: 
[0m10:20:12.810884 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:20:12.811818 [info ] [MainThread]: 
[0m10:20:12.812769 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m10:20:12.813621 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";"
[0m10:20:12.814305 [info ] [MainThread]: 
[0m10:20:12.815217 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m10:20:12.816313 [info ] [MainThread]: 
[0m10:20:12.817358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:20:12.819413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.526614, "process_in_blocks": "0", "process_kernel_time": 0.671593, "process_mem_max_rss": "152560", "process_out_blocks": "2792", "process_user_time": 4.314988}
[0m10:20:12.820508 [debug] [MainThread]: Command `dbt run` failed at 10:20:12.820293 after 3.53 seconds
[0m10:20:12.822495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7309543c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094ec81ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73094ec81f30>]}
[0m10:20:12.823691 [debug] [MainThread]: Flushing usage events
[0m10:20:13.189888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:05.217734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087b3bf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087a145420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087a1453c0>]}


============================== 10:22:05.223360 | b878ca83-ad62-4960-8829-8799cc22cee8 ==============================
[0m10:22:05.223360 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:22:05.224748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:05.565386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087a901930>]}
[0m10:22:05.673958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087c757b20>]}
[0m10:22:05.677440 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:22:05.886497 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:22:06.172764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:22:06.174323 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m10:22:06.808634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087a369840>]}
[0m10:22:06.970824 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:22:06.976678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:22:06.993334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0875f55d50>]}
[0m10:22:06.994112 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m10:22:06.994916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0875f542b0>]}
[0m10:22:06.997870 [info ] [MainThread]: 
[0m10:22:07.000269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:07.001421 [info ] [MainThread]: 
[0m10:22:07.002943 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:22:07.005198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:22:07.059330 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:22:07.060663 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:22:07.061383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:07.099884 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m10:22:07.103314 [debug] [ThreadPool]: On list_dev: Close
[0m10:22:07.105133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:22:07.106886 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:22:07.120787 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:07.121725 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:22:07.122326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:07.124068 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:22:07.126156 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:07.126634 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:22:07.127558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:07.127996 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:07.128309 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:22:07.128846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:07.129875 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:22:07.130330 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:22:07.130721 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:22:07.131245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:22:07.131590 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:22:07.139628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:22:07.153543 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:22:07.157594 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:22:07.158693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:07.162137 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:22:07.162879 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:22:07.163453 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:22:07.187789 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m10:22:07.190735 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:22:07.192507 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:22:07.193163 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:22:07.194727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0875d4bb20>]}
[0m10:22:07.195393 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:07.196338 [debug] [MainThread]: On master: BEGIN
[0m10:22:07.197035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:07.198187 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:22:07.198866 [debug] [MainThread]: On master: COMMIT
[0m10:22:07.199500 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:07.200062 [debug] [MainThread]: On master: COMMIT
[0m10:22:07.201021 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:07.201687 [debug] [MainThread]: On master: Close
[0m10:22:07.205999 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m10:22:07.207352 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m10:22:07.208755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m10:22:07.209712 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m10:22:07.230491 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m10:22:07.233256 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m10:22:07.311511 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m10:22:07.315078 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:22:07.316238 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m10:22:07.317133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:07.318788 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:22:07.319769 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:22:07.321577 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:22:07.333510 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(prevstudy) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(rescreennum_raw) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(prevsubj) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:22:07.334410 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:22:07.335091 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m10:22:07.337171 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m10:22:07.337563 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m10:22:07.338855 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: No function matches the given name and argument types 'trim(INTEGER)'. You might need to add explicit type casts.
  	Candidate functions:
  	trim(VARCHAR) -> VARCHAR
  	trim(VARCHAR, VARCHAR) -> VARCHAR
  
  
  LINE 24:             WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                                                     ^
[0m10:22:07.340504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b878ca83-ad62-4960-8829-8799cc22cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087600d2d0>]}
[0m10:22:07.341269 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.13s]
[0m10:22:07.342011 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m10:22:07.342601 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: No function matches the given name and argument types 'trim(INTEGER)'. You might need to add explicit type casts.
  	Candidate functions:
  	trim(VARCHAR) -> VARCHAR
  	trim(VARCHAR, VARCHAR) -> VARCHAR
  
  
  LINE 24:             WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                                                     ^.
[0m10:22:07.344451 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:07.345201 [debug] [MainThread]: On master: BEGIN
[0m10:22:07.346016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:07.347339 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:22:07.348145 [debug] [MainThread]: On master: COMMIT
[0m10:22:07.348932 [debug] [MainThread]: Using duckdb connection "master"
[0m10:22:07.349688 [debug] [MainThread]: On master: COMMIT
[0m10:22:07.350691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:22:07.351471 [debug] [MainThread]: On master: Close
[0m10:22:07.352530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:07.353268 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m10:22:07.355499 [info ] [MainThread]: 
[0m10:22:07.356645 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m10:22:07.358389 [debug] [MainThread]: Command end result
[0m10:22:07.409536 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:22:07.416964 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:22:07.434709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:22:07.435279 [info ] [MainThread]: 
[0m10:22:07.437717 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:22:07.438419 [info ] [MainThread]: 
[0m10:22:07.438803 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m10:22:07.439342 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: No function matches the given name and argument types 'trim(INTEGER)'. You might need to add explicit type casts.
  	Candidate functions:
  	trim(VARCHAR) -> VARCHAR
  	trim(VARCHAR, VARCHAR) -> VARCHAR
  
  
  LINE 24:             WHEN prevsubj IS NOT NULL AND TRIM(prevsubj) <> '' THEN
                                                     ^
[0m10:22:07.441301 [info ] [MainThread]: 
[0m10:22:07.441721 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m10:22:07.442073 [info ] [MainThread]: 
[0m10:22:07.442399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:22:07.444503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3458357, "process_in_blocks": "832", "process_kernel_time": 0.676438, "process_mem_max_rss": "149588", "process_out_blocks": "2784", "process_user_time": 3.632724}
[0m10:22:07.444941 [debug] [MainThread]: Command `dbt run` failed at 10:22:07.444858 after 2.35 seconds
[0m10:22:07.446407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087b3bf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087a901930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c087b03a500>]}
[0m10:22:07.446816 [debug] [MainThread]: Flushing usage events
[0m10:22:07.845397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:11.526753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fabebb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746faac454e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746faac45480>]}


============================== 10:26:11.532383 | 45423dff-16ad-4190-b979-b51a33340f1c ==============================
[0m10:26:11.532383 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:26:11.534118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:26:11.863248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa6cc6ec0>]}
[0m10:26:11.957342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa6d8e260>]}
[0m10:26:11.959525 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:26:12.104935 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:26:12.327915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:12.328687 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m10:26:12.728678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fab4a2cb0>]}
[0m10:26:12.865541 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:26:12.868606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:26:12.888752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa682a1a0>]}
[0m10:26:12.889440 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m10:26:12.890394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa6820af0>]}
[0m10:26:12.891985 [info ] [MainThread]: 
[0m10:26:12.892438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:12.892817 [info ] [MainThread]: 
[0m10:26:12.893660 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:26:12.895507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:26:12.944559 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:26:12.946732 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:26:12.947909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:12.966554 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m10:26:12.968344 [debug] [ThreadPool]: On list_dev: Close
[0m10:26:12.969367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:26:12.969944 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:26:12.987318 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:26:12.988462 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:26:12.989361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:12.991416 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:26:12.996100 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:26:12.996828 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:26:12.997797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:26:12.998428 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:26:12.999052 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:26:12.999962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:26:13.001258 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:26:13.001717 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:26:13.002182 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:26:13.003296 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:26:13.003855 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:26:13.010766 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m10:26:13.020619 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:26:13.021652 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:26:13.022464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:13.023806 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:26:13.026786 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:26:13.027595 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:26:13.057679 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m10:26:13.060629 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:26:13.061674 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:26:13.062382 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:26:13.065120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa682a1a0>]}
[0m10:26:13.066440 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:13.067862 [debug] [MainThread]: On master: BEGIN
[0m10:26:13.068637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:13.069769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:26:13.070370 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.070974 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:13.071538 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.072358 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:26:13.073042 [debug] [MainThread]: On master: Close
[0m10:26:13.076799 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m10:26:13.079204 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m10:26:13.081339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m10:26:13.082787 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m10:26:13.124653 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m10:26:13.129728 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m10:26:13.185234 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m10:26:13.188462 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:26:13.189012 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m10:26:13.189815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:13.191467 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:26:13.192329 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:26:13.193343 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:26:13.197687 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:26:13.198960 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:26:13.200039 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m10:26:13.204301 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m10:26:13.205048 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m10:26:13.207892 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Column "siteid" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m10:26:13.211401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45423dff-16ad-4190-b979-b51a33340f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa6cf2920>]}
[0m10:26:13.212975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.13s]
[0m10:26:13.214644 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m10:26:13.215864 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Column "siteid" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m10:26:13.219608 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:13.220513 [debug] [MainThread]: On master: BEGIN
[0m10:26:13.221296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:13.222629 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:26:13.223434 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.224210 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:13.224927 [debug] [MainThread]: On master: COMMIT
[0m10:26:13.226019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:26:13.226831 [debug] [MainThread]: On master: Close
[0m10:26:13.228822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:13.229554 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m10:26:13.230217 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m10:26:13.230918 [info ] [MainThread]: 
[0m10:26:13.231929 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:26:13.233432 [debug] [MainThread]: Command end result
[0m10:26:13.282508 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:26:13.285712 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:26:13.305301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:26:13.305952 [info ] [MainThread]: 
[0m10:26:13.306669 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:26:13.307223 [info ] [MainThread]: 
[0m10:26:13.307785 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m10:26:13.308277 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Column "siteid" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m10:26:13.308740 [info ] [MainThread]: 
[0m10:26:13.309179 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m10:26:13.309580 [info ] [MainThread]: 
[0m10:26:13.310002 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:26:13.311051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8889879, "process_in_blocks": "88", "process_kernel_time": 0.522734, "process_mem_max_rss": "149640", "process_out_blocks": "2784", "process_user_time": 2.989387}
[0m10:26:13.311868 [debug] [MainThread]: Command `dbt run` failed at 10:26:13.311482 after 1.89 seconds
[0m10:26:13.312369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fabebb5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fa6cc6ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746fabd2d120>]}
[0m10:26:13.312898 [debug] [MainThread]: Flushing usage events
[0m10:26:13.682026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:07.325008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc85bf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc7349480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc7349420>]}


============================== 10:30:07.331118 | 261b79ec-2455-4a18-969b-45102d77b41c ==============================
[0m10:30:07.331118 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:30:07.332666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:30:07.694501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc9b922f0>]}
[0m10:30:07.872122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc7312920>]}
[0m10:30:07.874413 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m10:30:08.030589 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m10:30:08.261232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:08.262609 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m10:30:08.947389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc73128f0>]}
[0m10:30:09.117539 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:30:09.120677 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:30:09.135308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc2f581c0>]}
[0m10:30:09.136232 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m10:30:09.136898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc2f591e0>]}
[0m10:30:09.138386 [info ] [MainThread]: 
[0m10:30:09.139041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:09.139636 [info ] [MainThread]: 
[0m10:30:09.140365 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:30:09.141581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:30:09.197223 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:30:09.198109 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:30:09.198899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:09.215589 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:30:09.217909 [debug] [ThreadPool]: On list_dev: Close
[0m10:30:09.219328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:30:09.222069 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:30:09.230813 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:30:09.231418 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:30:09.231867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:09.233193 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:30:09.234555 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:30:09.234938 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:30:09.235485 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:30:09.235837 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:30:09.236203 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:30:09.236707 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:30:09.237583 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:30:09.237926 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:30:09.238270 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:30:09.238616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:30:09.238967 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:30:09.247720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:30:09.261878 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:30:09.263546 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:30:09.264410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:09.265942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:30:09.266755 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:30:09.267559 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:30:09.298418 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m10:30:09.303162 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:30:09.304628 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:30:09.306235 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:30:09.309709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc2f30ac0>]}
[0m10:30:09.311036 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:09.311635 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.312464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:09.313895 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m10:30:09.314794 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.315641 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:09.317196 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.318242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:30:09.318950 [debug] [MainThread]: On master: Close
[0m10:30:09.322088 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m10:30:09.323332 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m10:30:09.324857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m10:30:09.326077 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m10:30:09.345654 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m10:30:09.350775 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m10:30:09.400169 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m10:30:09.401939 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:30:09.402622 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m10:30:09.403110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:09.404901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:30:09.405472 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m10:30:09.406126 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:30:09.418372 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m10:30:09.420399 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:30:09.422007 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m10:30:09.427105 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m10:30:09.427986 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m10:30:09.430878 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m10:30:09.435771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '261b79ec-2455-4a18-969b-45102d77b41c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc72e44c0>]}
[0m10:30:09.437549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.11s]
[0m10:30:09.439392 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m10:30:09.440792 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^.
[0m10:30:09.443254 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:09.444067 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.446053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:09.447618 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:30:09.448557 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.449447 [debug] [MainThread]: Using duckdb connection "master"
[0m10:30:09.450275 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.451341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:30:09.452144 [debug] [MainThread]: On master: Close
[0m10:30:09.453224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:09.453952 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m10:30:09.454712 [info ] [MainThread]: 
[0m10:30:09.460294 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:30:09.461742 [debug] [MainThread]: Command end result
[0m10:30:09.504441 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m10:30:09.507164 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m10:30:09.522281 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m10:30:09.523574 [info ] [MainThread]: 
[0m10:30:09.525097 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:30:09.526058 [info ] [MainThread]: 
[0m10:30:09.527161 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m10:30:09.527673 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m10:30:09.528243 [info ] [MainThread]: 
[0m10:30:09.528581 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m10:30:09.528873 [info ] [MainThread]: 
[0m10:30:09.529531 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:30:09.531838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3217402, "process_in_blocks": "0", "process_kernel_time": 0.66626, "process_mem_max_rss": "149636", "process_out_blocks": "2792", "process_user_time": 3.553387}
[0m10:30:09.532896 [debug] [MainThread]: Command `dbt run` failed at 10:30:09.532724 after 2.32 seconds
[0m10:30:09.533466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc85bf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc7ba3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741dc73aff70>]}
[0m10:30:09.533868 [debug] [MainThread]: Flushing usage events
[0m10:30:09.892851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:08.756916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073babf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073a845570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073a845510>]}


============================== 15:13:08.763231 | bcf741b6-d3b7-4c69-8416-483b9d6b2bef ==============================
[0m15:13:08.763231 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:13:08.765532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:13:09.147963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073aa69540>]}
[0m15:13:09.248808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073a80e500>]}
[0m15:13:09.252187 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:13:09.432953 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:13:09.702218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:09.703098 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m15:13:10.272421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507369a6350>]}
[0m15:13:10.437173 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:13:10.440571 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:13:10.453581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073642be20>]}
[0m15:13:10.454235 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:13:10.454895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7507364202e0>]}
[0m15:13:10.456197 [info ] [MainThread]: 
[0m15:13:10.456765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:10.457203 [info ] [MainThread]: 
[0m15:13:10.457837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:10.459375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:13:10.507166 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:13:10.507941 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:13:10.508771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:10.525696 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:13:10.527366 [debug] [ThreadPool]: On list_dev: Close
[0m15:13:10.528338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:13:10.528954 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:13:10.545418 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:13:10.546552 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:13:10.547436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.549595 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:13:10.551953 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:13:10.552598 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:13:10.553522 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:13:10.553878 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:13:10.554548 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:13:10.555257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:13:10.556249 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:13:10.556570 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:13:10.557826 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:13:10.559495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:13:10.560683 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:13:10.588149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:13:10.599395 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:13:10.600037 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:13:10.600367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:10.601259 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:13:10.601611 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:13:10.601977 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:13:10.624155 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:13:10.627876 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:13:10.630180 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:13:10.631149 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:13:10.634453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073642be20>]}
[0m15:13:10.635512 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.636239 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.637102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:10.638550 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:10.639527 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.640932 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.641818 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.642970 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:13:10.643826 [debug] [MainThread]: On master: Close
[0m15:13:10.647377 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:13:10.648775 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:13:10.650481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:13:10.652183 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:13:10.670809 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:13:10.676096 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:13:10.732226 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:13:10.734811 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:13:10.735389 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:13:10.735809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:10.736906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:13:10.737400 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:13:10.737948 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:13:10.739970 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:13:10.740561 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:13:10.741137 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:13:10.743511 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:13:10.743831 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:13:10.745091 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m15:13:10.747156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcf741b6-d3b7-4c69-8416-483b9d6b2bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750736464eb0>]}
[0m15:13:10.747992 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.10s]
[0m15:13:10.748894 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:13:10.749489 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^.
[0m15:13:10.751155 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.751592 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.752009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:10.752746 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:13:10.753095 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.753346 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:10.753592 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.754146 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:13:10.754483 [debug] [MainThread]: On master: Close
[0m15:13:10.754889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:10.755226 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:13:10.755573 [info ] [MainThread]: 
[0m15:13:10.756105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:13:10.756904 [debug] [MainThread]: Command end result
[0m15:13:10.800704 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:13:10.803507 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:13:10.811320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:13:10.811819 [info ] [MainThread]: 
[0m15:13:10.812502 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:13:10.813067 [info ] [MainThread]: 
[0m15:13:10.813499 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:13:10.814040 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m15:13:10.814565 [info ] [MainThread]: 
[0m15:13:10.815056 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:13:10.815448 [info ] [MainThread]: 
[0m15:13:10.815893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:13:10.816891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.153876, "process_in_blocks": "0", "process_kernel_time": 0.671599, "process_mem_max_rss": "149636", "process_out_blocks": "2784", "process_user_time": 3.059508}
[0m15:13:10.817420 [debug] [MainThread]: Command `dbt run` failed at 15:13:10.817310 after 2.15 seconds
[0m15:13:10.817916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073babf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073aa69540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75073c6403d0>]}
[0m15:13:10.818387 [debug] [MainThread]: Flushing usage events
[0m15:13:11.161580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:23.928349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f4fbf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f3d49480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f3d49420>]}


============================== 15:15:23.935380 | 1dda2614-7aa3-41da-a57e-22aad06bb564 ==============================
[0m15:15:23.935380 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:15:23.937124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:24.282500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f655a2f0>]}
[0m15:15:24.412444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f3d12920>]}
[0m15:15:24.415582 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:15:24.706699 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:15:24.965902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:24.966560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:25.080483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835ef981ab0>]}
[0m15:15:25.215758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:15:25.218761 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:15:25.233279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835ef9813f0>]}
[0m15:15:25.233852 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:15:25.234402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835ef981450>]}
[0m15:15:25.235906 [info ] [MainThread]: 
[0m15:15:25.236392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:25.236724 [info ] [MainThread]: 
[0m15:15:25.237322 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:15:25.238281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:15:25.404935 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:15:25.408036 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:15:25.408855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:25.440117 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m15:15:25.443270 [debug] [ThreadPool]: On list_dev: Close
[0m15:15:25.445338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:15:25.446639 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:15:25.462815 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:25.463713 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:15:25.464464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:25.466265 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:15:25.468091 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:25.468976 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:15:25.469750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:15:25.470542 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:25.471392 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:15:25.472514 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:15:25.473961 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:15:25.474545 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:15:25.475172 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:15:25.476001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:15:25.476696 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:15:25.489219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:15:25.501904 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:15:25.502931 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:15:25.503684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:25.504824 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:15:25.505454 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:15:25.506009 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:15:25.518594 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:15:25.520695 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:15:25.521497 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:15:25.522254 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:15:25.523681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835ef9825f0>]}
[0m15:15:25.524196 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:25.524532 [debug] [MainThread]: On master: BEGIN
[0m15:15:25.524820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:25.525454 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:15:25.525705 [debug] [MainThread]: On master: COMMIT
[0m15:15:25.525929 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:25.526153 [debug] [MainThread]: On master: COMMIT
[0m15:15:25.526627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:15:25.526923 [debug] [MainThread]: On master: Close
[0m15:15:25.528851 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:15:25.529523 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:15:25.530352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now model.VEXIN_03.dm)
[0m15:15:25.530696 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:15:25.540571 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:15:25.542298 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:15:25.599243 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:15:25.603037 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:15:25.603640 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:15:25.604035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:25.604918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:15:25.605361 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:15:25.605783 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:15:25.608077 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    studyid AS STUDYID
    ,domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.subjid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa, 0) + COALESCE(racenhopi, 0) + COALESCE(racewhite, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:15:25.608642 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:15:25.609142 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:15:25.611342 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:15:25.611673 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:15:25.612693 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m15:15:25.614500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dda2614-7aa3-41da-a57e-22aad06bb564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f5085a80>]}
[0m15:15:25.615227 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.08s]
[0m15:15:25.616226 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:15:25.616810 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^.
[0m15:15:25.620413 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:25.621525 [debug] [MainThread]: On master: BEGIN
[0m15:15:25.622408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:25.624081 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:15:25.625048 [debug] [MainThread]: On master: COMMIT
[0m15:15:25.625853 [debug] [MainThread]: Using duckdb connection "master"
[0m15:15:25.626580 [debug] [MainThread]: On master: COMMIT
[0m15:15:25.627611 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:15:25.628395 [debug] [MainThread]: On master: Close
[0m15:15:25.631002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:25.631954 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:15:25.632963 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:15:25.633899 [info ] [MainThread]: 
[0m15:15:25.635083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:15:25.636997 [debug] [MainThread]: Command end result
[0m15:15:25.694669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:15:25.698895 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:15:25.708151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:15:25.708663 [info ] [MainThread]: 
[0m15:15:25.709336 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:15:25.709838 [info ] [MainThread]: 
[0m15:15:25.710392 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:15:25.710914 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Referenced column "raceaian" not found in FROM clause!
  Candidate bindings: "SEX"
  
  LINE 69:              WHEN COALESCE(raceaian, 0) + COALESCE(raceasian, 0) + COALESCE(racebaa...
                                      ^
[0m15:15:25.711454 [info ] [MainThread]: 
[0m15:15:25.711926 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:15:25.712346 [info ] [MainThread]: 
[0m15:15:25.712929 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:15:25.715972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9174948, "process_in_blocks": "0", "process_kernel_time": 0.58521, "process_mem_max_rss": "146580", "process_out_blocks": "1904", "process_user_time": 3.174564}
[0m15:15:25.721256 [debug] [MainThread]: Command `dbt run` failed at 15:15:25.720855 after 1.92 seconds
[0m15:15:25.721888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f4fbf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835ef930c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7835f4e2eda0>]}
[0m15:15:25.722279 [debug] [MainThread]: Flushing usage events
[0m15:15:26.063123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:10.942244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73680a3b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736809139480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736809139420>]}


============================== 15:17:10.945543 | 46614dfe-811a-4309-862c-01ad579cfc26 ==============================
[0m15:17:10.945543 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:17:10.946415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:17:11.317682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73680a0508e0>]}
[0m15:17:11.409556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736809102d70>]}
[0m15:17:11.413643 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:17:11.651655 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:17:11.944111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:11.945626 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m15:17:12.446477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736805179a80>]}
[0m15:17:12.569797 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:17:12.574946 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:17:12.607652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736804d3beb0>]}
[0m15:17:12.609306 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:17:12.610790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736804d082b0>]}
[0m15:17:12.614743 [info ] [MainThread]: 
[0m15:17:12.616363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:12.617398 [info ] [MainThread]: 
[0m15:17:12.618681 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:17:12.620443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:17:12.704044 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:17:12.705278 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:17:12.706218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:12.737084 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m15:17:12.740062 [debug] [ThreadPool]: On list_dev: Close
[0m15:17:12.742759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:17:12.743945 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:17:12.760709 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:12.763190 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:17:12.764167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:12.766338 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:17:12.768988 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:12.769373 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:17:12.770112 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:12.770761 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:12.771329 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:17:12.772079 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:12.774549 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:17:12.775094 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:17:12.775629 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:17:12.776356 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:12.776909 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:17:12.785878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:17:12.791874 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:17:12.792348 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:17:12.792771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:12.793485 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:17:12.794050 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:17:12.794351 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:17:12.804779 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:17:12.806389 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:17:12.807007 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:17:12.807391 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:17:12.808691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736804d38100>]}
[0m15:17:12.809189 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:12.809502 [debug] [MainThread]: On master: BEGIN
[0m15:17:12.809780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:12.810390 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:17:12.810704 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.810983 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:12.811280 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.811696 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:17:12.811994 [debug] [MainThread]: On master: Close
[0m15:17:12.813972 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:17:12.814595 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:17:12.816310 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.VEXIN_03.dm'
[0m15:17:12.817185 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:17:12.837763 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:17:12.840534 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:17:12.888141 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:17:12.890896 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:17:12.891487 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:17:12.891980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:12.893035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:17:12.893753 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:17:12.895161 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM { ref('raw_dm') };
  );

[0m15:17:12.897372 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM { ref('raw_dm') };
  );

[0m15:17:12.898669 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:17:12.899567 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:17:12.905100 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:17:12.906390 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:17:12.909358 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{"
[0m15:17:12.914280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46614dfe-811a-4309-862c-01ad579cfc26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736809046a10>]}
[0m15:17:12.916003 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.09s]
[0m15:17:12.917930 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:17:12.919339 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{".
[0m15:17:12.923800 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:12.924791 [debug] [MainThread]: On master: BEGIN
[0m15:17:12.925664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:12.926982 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:17:12.927769 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.928535 [debug] [MainThread]: Using duckdb connection "master"
[0m15:17:12.929289 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.930099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:17:12.930799 [debug] [MainThread]: On master: Close
[0m15:17:12.931840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:12.932458 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:17:12.935190 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:17:12.935733 [info ] [MainThread]: 
[0m15:17:12.936593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:17:12.937502 [debug] [MainThread]: Command end result
[0m15:17:12.980125 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:17:12.983500 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:17:13.002571 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:17:13.004535 [info ] [MainThread]: 
[0m15:17:13.005788 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:13.009483 [info ] [MainThread]: 
[0m15:17:13.010247 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:17:13.010861 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near "{"
[0m15:17:13.011483 [info ] [MainThread]: 
[0m15:17:13.012038 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:17:13.012559 [info ] [MainThread]: 
[0m15:17:13.013270 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:17:13.014464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1730995, "process_in_blocks": "0", "process_kernel_time": 0.792221, "process_mem_max_rss": "149080", "process_out_blocks": "2792", "process_user_time": 3.514428}
[0m15:17:13.015112 [debug] [MainThread]: Command `dbt run` failed at 15:17:13.014957 after 2.17 seconds
[0m15:17:13.015661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73680a3b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73680a2176a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367ffd32590>]}
[0m15:17:13.016211 [debug] [MainThread]: Flushing usage events
[0m15:17:13.365636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:24.864237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fb3af580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fa1315d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fa131570>]}


============================== 15:21:24.867265 | 3dd003db-49b9-4a94-b71c-150a9ca95d8c ==============================
[0m15:21:24.867265 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:21:24.868097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:21:25.275221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fb070400>]}
[0m15:21:25.374740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fa0fed70>]}
[0m15:21:25.377232 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:21:25.604476 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:21:25.880739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:25.882913 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m15:21:26.498627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fa0fe440>]}
[0m15:21:26.626616 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:21:26.629437 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:21:26.640478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583f5d38c10>]}
[0m15:21:26.640970 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:21:26.641724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583f5d15540>]}
[0m15:21:26.642934 [info ] [MainThread]: 
[0m15:21:26.643366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:26.643708 [info ] [MainThread]: 
[0m15:21:26.644308 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:26.645248 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:21:26.693025 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:21:26.693670 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:21:26.694155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:26.709590 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:21:26.711311 [debug] [ThreadPool]: On list_dev: Close
[0m15:21:26.712264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:21:26.712846 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:21:26.735105 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:26.736482 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:21:26.737400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:26.740448 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:21:26.743748 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:26.744627 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:21:26.745767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:26.746512 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:26.747196 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:21:26.748827 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:26.750907 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:26.752094 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:21:26.753040 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:21:26.754211 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:21:26.755156 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:21:26.768593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:21:26.779201 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:26.780242 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:21:26.781656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:26.783019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:21:26.783867 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:21:26.784682 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:21:26.806314 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:21:26.809789 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:21:26.811305 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:21:26.812327 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:21:26.816348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583f5d3bb50>]}
[0m15:21:26.817575 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:26.818441 [debug] [MainThread]: On master: BEGIN
[0m15:21:26.819239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:26.820683 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:21:26.821554 [debug] [MainThread]: On master: COMMIT
[0m15:21:26.822366 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:26.823157 [debug] [MainThread]: On master: COMMIT
[0m15:21:26.825357 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:21:26.825987 [debug] [MainThread]: On master: Close
[0m15:21:26.829088 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:21:26.829873 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:21:26.830872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:21:26.831471 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:21:26.841429 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:21:26.843218 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:21:26.891432 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:21:26.893350 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:21:26.893754 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:21:26.894215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:26.895060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:21:26.895381 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:21:26.895927 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm";
  );

[0m15:21:26.896903 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm";
  );

[0m15:21:26.897577 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:21:26.898057 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:21:26.899881 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:21:26.900321 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:21:26.901880 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";"
[0m15:21:26.903401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd003db-49b9-4a94-b71c-150a9ca95d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583f9ffb4c0>]}
[0m15:21:26.904537 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.07s]
[0m15:21:26.905306 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:21:26.905926 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";".
[0m15:21:26.907430 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:26.907857 [debug] [MainThread]: On master: BEGIN
[0m15:21:26.908126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:26.908824 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:21:26.909192 [debug] [MainThread]: On master: COMMIT
[0m15:21:26.909446 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:26.911316 [debug] [MainThread]: On master: COMMIT
[0m15:21:26.912043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:21:26.912502 [debug] [MainThread]: On master: Close
[0m15:21:26.913099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:26.913494 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:21:26.913905 [info ] [MainThread]: 
[0m15:21:26.914404 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m15:21:26.915220 [debug] [MainThread]: Command end result
[0m15:21:26.941400 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:21:26.944526 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:21:26.952520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:21:26.953019 [info ] [MainThread]: 
[0m15:21:26.953662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:21:26.954231 [info ] [MainThread]: 
[0m15:21:26.954841 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:21:26.955433 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Parser Error: syntax error at or near ";"
[0m15:21:26.955837 [info ] [MainThread]: 
[0m15:21:26.956190 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:21:26.956623 [info ] [MainThread]: 
[0m15:21:26.957053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:21:26.958107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1760507, "process_in_blocks": "0", "process_kernel_time": 0.599487, "process_mem_max_rss": "149084", "process_out_blocks": "2792", "process_user_time": 3.391839}
[0m15:21:26.958675 [debug] [MainThread]: Command `dbt run` failed at 15:21:26.958565 after 2.18 seconds
[0m15:21:26.959141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fb3af580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fb070400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7583fa359870>]}
[0m15:21:26.959609 [debug] [MainThread]: Flushing usage events
[0m15:21:27.315563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:58.447153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96d4ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c231480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c231420>]}


============================== 15:22:58.453697 | 8b9e070a-ec6d-4357-b45d-ea6ad24769df ==============================
[0m15:22:58.453697 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:22:58.455386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:22:58.803111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96eab62f0>]}
[0m15:22:58.923797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c1fa920>]}
[0m15:22:58.927035 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:22:59.125408 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:22:59.328286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:59.329053 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m15:22:59.915235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c1fa8f0>]}
[0m15:23:00.071642 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:23:00.076322 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:23:00.092932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c967e40250>]}
[0m15:23:00.093458 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:23:00.094093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c967e41990>]}
[0m15:23:00.095581 [info ] [MainThread]: 
[0m15:23:00.096020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:00.096473 [info ] [MainThread]: 
[0m15:23:00.097058 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:23:00.098006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:23:00.184306 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:23:00.194035 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:23:00.195904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:00.248246 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m15:23:00.255288 [debug] [ThreadPool]: On list_dev: Close
[0m15:23:00.260247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:23:00.261304 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:23:00.282303 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:23:00.284203 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:23:00.284723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:00.286753 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:23:00.289620 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:23:00.290365 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:23:00.291370 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:23:00.292088 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:23:00.292711 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:23:00.293674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:23:00.296030 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:23:00.296896 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:23:00.297697 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:23:00.298728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:23:00.299569 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:23:00.312267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:23:00.324415 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:23:00.325378 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:23:00.326186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:00.328740 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:23:00.329589 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:23:00.330341 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:23:00.356851 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:23:00.360992 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:23:00.362681 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:23:00.363727 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:23:00.366952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c967e10ac0>]}
[0m15:23:00.368011 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:00.368774 [debug] [MainThread]: On master: BEGIN
[0m15:23:00.370365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:00.371466 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:23:00.372163 [debug] [MainThread]: On master: COMMIT
[0m15:23:00.372805 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:00.373448 [debug] [MainThread]: On master: COMMIT
[0m15:23:00.374349 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:23:00.375047 [debug] [MainThread]: On master: Close
[0m15:23:00.377613 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:23:00.378410 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:23:00.379393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:23:00.380260 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:23:00.395625 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:23:00.400262 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:23:00.445432 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:23:00.448738 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:23:00.449961 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:23:00.450970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:00.453293 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:23:00.456355 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:23:00.457729 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:23:00.461167 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:23:00.462292 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:23:00.463407 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:23:00.472592 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:23:00.473161 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:23:00.474569 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:23:00.476892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9e070a-ec6d-4357-b45d-ea6ad24769df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c1cc4c0>]}
[0m15:23:00.477755 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.10s]
[0m15:23:00.478632 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:23:00.479247 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^.
[0m15:23:00.480919 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:00.481387 [debug] [MainThread]: On master: BEGIN
[0m15:23:00.481785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:00.482567 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:23:00.482946 [debug] [MainThread]: On master: COMMIT
[0m15:23:00.483337 [debug] [MainThread]: Using duckdb connection "master"
[0m15:23:00.483693 [debug] [MainThread]: On master: COMMIT
[0m15:23:00.484242 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:23:00.484602 [debug] [MainThread]: On master: Close
[0m15:23:00.485091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:00.485596 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:23:00.485919 [info ] [MainThread]: 
[0m15:23:00.486468 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m15:23:00.487605 [debug] [MainThread]: Command end result
[0m15:23:00.536682 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:23:00.543957 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:23:00.559518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:23:00.560514 [info ] [MainThread]: 
[0m15:23:00.562324 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:00.563614 [info ] [MainThread]: 
[0m15:23:00.564049 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:23:00.564710 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:23:00.565297 [info ] [MainThread]: 
[0m15:23:00.565632 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:23:00.566062 [info ] [MainThread]: 
[0m15:23:00.566727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:23:00.567745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2153351, "process_in_blocks": "0", "process_kernel_time": 0.545838, "process_mem_max_rss": "149652", "process_out_blocks": "2800", "process_user_time": 3.501764}
[0m15:23:00.568250 [debug] [MainThread]: Command `dbt run` failed at 15:23:00.568080 after 2.22 seconds
[0m15:23:00.568817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96d4ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96ca8fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c96c297f70>]}
[0m15:23:00.569555 [debug] [MainThread]: Flushing usage events
[0m15:23:00.913952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:40.444057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9aadc34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a9b49330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a9b492d0>]}


============================== 15:25:40.450374 | 7572186a-34db-4cf0-843a-b290d52b8df7 ==============================
[0m15:25:40.450374 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:25:40.451913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:40.781805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9aa305900>]}
[0m15:25:40.871940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a9b12ce0>]}
[0m15:25:40.873934 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:25:41.023141 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:25:41.259139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:41.260049 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://seeds/raw_dm.csv
[0m15:25:41.773977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a56e0130>]}
[0m15:25:42.055090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:25:42.058867 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:25:42.077852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a56ae7d0>]}
[0m15:25:42.078533 [info ] [MainThread]: Found 4 models, 4 data tests, 1 seed, 430 macros
[0m15:25:42.079196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a56e3730>]}
[0m15:25:42.081291 [info ] [MainThread]: 
[0m15:25:42.081878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:42.082373 [info ] [MainThread]: 
[0m15:25:42.083003 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:25:42.083971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:25:42.131900 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:25:42.132770 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:25:42.133185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:42.167738 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:25:42.169897 [debug] [ThreadPool]: On list_dev: Close
[0m15:25:42.171164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:25:42.172014 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:25:42.194722 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:25:42.195835 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:25:42.196677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:42.198739 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:25:42.200993 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:25:42.202003 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:25:42.203030 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:25:42.203351 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:25:42.203883 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:25:42.205300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:25:42.206712 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:25:42.207457 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:25:42.208682 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:25:42.209905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:25:42.210786 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:25:42.224426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:25:42.236973 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:25:42.237885 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:25:42.238657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:42.240047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:25:42.240792 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:25:42.241966 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:25:42.264438 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:25:42.267690 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:25:42.269475 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:25:42.270351 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:25:42.273116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a56ad5a0>]}
[0m15:25:42.274041 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:42.274711 [debug] [MainThread]: On master: BEGIN
[0m15:25:42.275589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:42.276310 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:25:42.276781 [debug] [MainThread]: On master: COMMIT
[0m15:25:42.277377 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:42.277984 [debug] [MainThread]: On master: COMMIT
[0m15:25:42.278761 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:25:42.279721 [debug] [MainThread]: On master: Close
[0m15:25:42.282426 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:25:42.283281 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:25:42.284135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:25:42.284635 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:25:42.298448 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:25:42.301238 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:25:42.353577 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:25:42.357549 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:25:42.358918 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:25:42.360258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:42.362139 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:25:42.363288 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:25:42.364602 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:25:42.370633 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:25:42.372227 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:25:42.373675 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:25:42.378033 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:25:42.379221 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:25:42.381650 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:25:42.384822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7572186a-34db-4cf0-843a-b290d52b8df7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a5ba0b20>]}
[0m15:25:42.386631 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.10s]
[0m15:25:42.387853 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:25:42.388759 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^.
[0m15:25:42.390870 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:42.391597 [debug] [MainThread]: On master: BEGIN
[0m15:25:42.392158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:42.393057 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:25:42.393489 [debug] [MainThread]: On master: COMMIT
[0m15:25:42.393919 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:42.394315 [debug] [MainThread]: On master: COMMIT
[0m15:25:42.394899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:25:42.395308 [debug] [MainThread]: On master: Close
[0m15:25:42.395897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:42.396279 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:25:42.396681 [info ] [MainThread]: 
[0m15:25:42.397863 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m15:25:42.399258 [debug] [MainThread]: Command end result
[0m15:25:42.440368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:25:42.450179 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:25:42.462851 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:25:42.463436 [info ] [MainThread]: 
[0m15:25:42.464242 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:25:42.464866 [info ] [MainThread]: 
[0m15:25:42.465518 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:25:42.466095 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:25:42.466723 [info ] [MainThread]: 
[0m15:25:42.467186 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:25:42.467562 [info ] [MainThread]: 
[0m15:25:42.467994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:25:42.469119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0973868, "process_in_blocks": "0", "process_kernel_time": 0.655744, "process_mem_max_rss": "148736", "process_out_blocks": "2800", "process_user_time": 3.262123}
[0m15:25:42.469750 [debug] [MainThread]: Command `dbt run` failed at 15:25:42.469633 after 2.10 seconds
[0m15:25:42.470321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9aadc34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9aa305900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b9a58f5a50>]}
[0m15:25:42.470842 [debug] [MainThread]: Flushing usage events
[0m15:25:42.807802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:18.443739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8d4bb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8c238460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8c238400>]}


============================== 15:26:18.447908 | 681f377e-7734-4d64-8798-55814a5d70e1 ==============================
[0m15:26:18.447908 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:26:18.449139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:18.753771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8c20d210>]}
[0m15:26:18.874117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8c23b340>]}
[0m15:26:18.876931 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:26:19.063639 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:26:19.253435 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:26:19.254837 [debug] [MainThread]: previous checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, current checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d
[0m15:26:19.256277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8ca779d0>]}
[0m15:26:21.324651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8789e500>]}
[0m15:26:21.568249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:26:21.572487 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:26:21.591360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8791e4d0>]}
[0m15:26:21.592118 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:26:21.592901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec87908460>]}
[0m15:26:21.594646 [info ] [MainThread]: 
[0m15:26:21.595154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:21.595618 [info ] [MainThread]: 
[0m15:26:21.596300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:26:21.597370 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:26:21.661351 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:26:21.665625 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:26:21.666386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:21.704591 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m15:26:21.710547 [debug] [ThreadPool]: On list_dev: Close
[0m15:26:21.713511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:26:21.714775 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:26:21.723560 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:21.729104 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:26:21.730860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:21.732149 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:21.733646 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:21.734046 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:26:21.734664 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:21.734960 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:21.735497 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:26:21.736697 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:21.740822 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:21.743733 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:21.744605 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:21.745819 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:21.746680 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:26:21.761752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:26:21.774088 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:21.774936 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:26:21.775794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:21.777286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:21.778111 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:21.778877 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:26:21.799658 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:26:21.802981 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:26:21.803796 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:26:21.804226 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:26:21.805773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8791ef80>]}
[0m15:26:21.806453 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:21.806837 [debug] [MainThread]: On master: BEGIN
[0m15:26:21.807181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:21.807925 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:21.808329 [debug] [MainThread]: On master: COMMIT
[0m15:26:21.808716 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:21.809062 [debug] [MainThread]: On master: COMMIT
[0m15:26:21.809602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:21.809959 [debug] [MainThread]: On master: Close
[0m15:26:21.811798 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m15:26:21.812905 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m15:26:21.814370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m15:26:21.815384 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m15:26:21.816360 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m15:26:21.877734 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:26:21.878433 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m15:26:21.878972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:21.879962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:26:21.880370 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:26:21.880832 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m15:26:21.887637 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:26:21.906263 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:26:21.907736 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:26:21.926817 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:26:21.940179 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m15:26:21.956446 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m15:26:21.957006 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:26:21.957507 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m15:26:21.973526 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:26:21.976344 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m15:26:21.978515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '681f377e-7734-4d64-8798-55814a5d70e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec87a95ae0>]}
[0m15:26:21.979219 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mINSERT 40[0m in 0.16s]
[0m15:26:21.980003 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m15:26:21.981165 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:21.981541 [debug] [MainThread]: On master: BEGIN
[0m15:26:21.981853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:21.982521 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:21.982853 [debug] [MainThread]: On master: COMMIT
[0m15:26:21.983156 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:21.983373 [debug] [MainThread]: On master: COMMIT
[0m15:26:21.985611 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:21.986000 [debug] [MainThread]: On master: Close
[0m15:26:21.986483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:21.986745 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m15:26:21.987027 [info ] [MainThread]: 
[0m15:26:21.987539 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m15:26:21.988270 [debug] [MainThread]: Command end result
[0m15:26:22.013783 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:26:22.016166 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:26:22.023258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:26:22.023727 [info ] [MainThread]: 
[0m15:26:22.024305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:22.024820 [info ] [MainThread]: 
[0m15:26:22.025279 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:26:22.026249 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.6724584, "process_in_blocks": "408", "process_kernel_time": 0.664757, "process_mem_max_rss": "161752", "process_out_blocks": "2768", "process_user_time": 4.516939}
[0m15:26:22.027715 [debug] [MainThread]: Command `dbt seed` succeeded at 15:26:22.027598 after 3.67 seconds
[0m15:26:22.028159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8d4bb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec8d3336a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ec87abcb50>]}
[0m15:26:22.028629 [debug] [MainThread]: Flushing usage events
[0m15:26:22.368033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:30.620088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12aeab35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12ad83d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12ad83d420>]}


============================== 15:26:30.623740 | a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e ==============================
[0m15:26:30.623740 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:26:30.624656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:30.935351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12b008a2f0>]}
[0m15:26:31.044864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12ad806920>]}
[0m15:26:31.047499 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:26:31.232209 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:26:31.441874 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:26:31.442711 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m15:26:31.443122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12ae06d360>]}
[0m15:26:33.537667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12a8e9a5f0>]}
[0m15:26:33.808517 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:26:33.813262 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:26:33.834239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12a8f2bc70>]}
[0m15:26:33.834968 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:26:33.835676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12a8f2bcd0>]}
[0m15:26:33.837207 [info ] [MainThread]: 
[0m15:26:33.837749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:33.838424 [info ] [MainThread]: 
[0m15:26:33.839069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:26:33.840009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:26:33.875620 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:26:33.876424 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:26:33.876933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:33.895618 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:26:33.897339 [debug] [ThreadPool]: On list_dev: Close
[0m15:26:33.898299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:26:33.898891 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:26:33.907674 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:33.908310 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:26:33.908709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:33.910008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:33.911441 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:33.911862 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:26:33.912406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:33.912793 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:33.913608 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:26:33.914210 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:33.915118 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:33.915484 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:26:33.915845 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:26:33.916333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:26:33.917149 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:26:33.936724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:26:33.950136 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:33.951155 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:26:33.951962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:33.953384 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:26:33.954194 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:26:33.954954 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:26:33.977032 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:26:33.980120 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:26:33.981263 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:26:33.981930 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:26:33.983651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12a8f2b400>]}
[0m15:26:33.984457 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:33.985000 [debug] [MainThread]: On master: BEGIN
[0m15:26:33.985424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:33.986103 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:33.986451 [debug] [MainThread]: On master: COMMIT
[0m15:26:33.986795 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:33.987111 [debug] [MainThread]: On master: COMMIT
[0m15:26:33.987545 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:33.988246 [debug] [MainThread]: On master: Close
[0m15:26:33.990270 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:26:33.990970 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:26:33.991747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:26:33.992186 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:26:34.001603 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:26:34.003872 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:26:34.048605 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:26:34.050572 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:26:34.051108 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:26:34.051887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:34.052873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:26:34.053395 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:26:34.053918 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:26:34.055630 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:26:34.056193 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:26:34.056775 [debug] [Thread-1 (]: On model.VEXIN_03.dm: ROLLBACK
[0m15:26:34.058672 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.dm'
[0m15:26:34.060117 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:26:34.061579 [debug] [Thread-1 (]: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:26:34.064808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7acb4f9-2a96-4ef0-9507-80a8a7a98f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12aeb79a80>]}
[0m15:26:34.065777 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.dm ................................... [[31mERROR[0m in 0.07s]
[0m15:26:34.066761 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:26:34.067493 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.dm' to be skipped because of status 'error'.  Reason: Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^.
[0m15:26:34.069316 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:34.069799 [debug] [MainThread]: On master: BEGIN
[0m15:26:34.070256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:34.071077 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:26:34.071428 [debug] [MainThread]: On master: COMMIT
[0m15:26:34.071762 [debug] [MainThread]: Using duckdb connection "master"
[0m15:26:34.072100 [debug] [MainThread]: On master: COMMIT
[0m15:26:34.072610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:26:34.073580 [debug] [MainThread]: On master: Close
[0m15:26:34.074250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:34.074664 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:26:34.075403 [info ] [MainThread]: 
[0m15:26:34.076684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:26:34.078538 [debug] [MainThread]: Command end result
[0m15:26:34.130946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:26:34.135347 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:26:34.153015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:26:34.153970 [info ] [MainThread]: 
[0m15:26:34.154664 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:26:34.155181 [info ] [MainThread]: 
[0m15:26:34.155926 [error] [MainThread]: [31mFailure in model dm (models/sdtm/dm.sql)[0m
[0m15:26:34.156577 [error] [MainThread]:   Runtime Error in model dm (models/sdtm/dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "siteid"
  
  Candidate bindings: : "SITE", "SEX"
  
  LINE 52:     ,raw_dm.siteid AS SITEID
                ^
[0m15:26:34.157302 [info ] [MainThread]: 
[0m15:26:34.158011 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/dm.sql
[0m15:26:34.158582 [info ] [MainThread]: 
[0m15:26:34.159897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:26:34.161156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6348248, "process_in_blocks": "0", "process_kernel_time": 0.626921, "process_mem_max_rss": "152876", "process_out_blocks": "2784", "process_user_time": 4.497115}
[0m15:26:34.161793 [debug] [MainThread]: Command `dbt run` failed at 15:26:34.161652 after 3.64 seconds
[0m15:26:34.162190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12aeab35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12af607610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b12ae91ada0>]}
[0m15:26:34.162520 [debug] [MainThread]: Flushing usage events
[0m15:26:34.475501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:54.667041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fd3ab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fc1c83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fc1c8340>]}


============================== 15:28:54.670034 | 51ff1b08-aa6f-497e-a8ee-162187fbb902 ==============================
[0m15:28:54.670034 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:28:54.670780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:28:54.963550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fd1daad0>]}
[0m15:28:55.041901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fc19a5c0>]}
[0m15:28:55.045573 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:28:55.206296 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:28:55.425278 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:28:55.426340 [debug] [MainThread]: previous checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, current checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d
[0m15:28:55.426955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fca09cc0>]}
[0m15:28:57.815804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12f776a470>]}
[0m15:28:58.058938 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:28:58.061797 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:28:58.075766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12f79d4430>]}
[0m15:28:58.076370 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:28:58.077027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12f79bca60>]}
[0m15:28:58.078699 [info ] [MainThread]: 
[0m15:28:58.079230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:58.079714 [info ] [MainThread]: 
[0m15:28:58.080353 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:28:58.081293 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:28:58.139099 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:28:58.139988 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:28:58.140557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:58.173531 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:28:58.175880 [debug] [ThreadPool]: On list_dev: Close
[0m15:28:58.177100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:28:58.177986 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:28:58.186862 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:28:58.187376 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:28:58.187791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:58.188750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:28:58.190280 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:28:58.190718 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:28:58.191114 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:28:58.191476 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:28:58.191796 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:28:58.192196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:28:58.192959 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:28:58.193229 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:28:58.193550 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:28:58.194095 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:28:58.194431 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:28:58.201827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:28:58.208321 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:28:58.208758 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:28:58.209054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:58.211042 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:28:58.211893 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:28:58.212664 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:28:58.239365 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:28:58.242279 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:28:58.245163 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:28:58.245886 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:28:58.248832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fe848fd0>]}
[0m15:28:58.250051 [debug] [MainThread]: Using duckdb connection "master"
[0m15:28:58.250807 [debug] [MainThread]: On master: BEGIN
[0m15:28:58.251105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:58.252321 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:28:58.253707 [debug] [MainThread]: On master: COMMIT
[0m15:28:58.254595 [debug] [MainThread]: Using duckdb connection "master"
[0m15:28:58.255244 [debug] [MainThread]: On master: COMMIT
[0m15:28:58.256296 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:28:58.257024 [debug] [MainThread]: On master: Close
[0m15:28:58.261123 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m15:28:58.262379 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m15:28:58.264328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m15:28:58.265258 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m15:28:58.266147 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m15:28:58.330259 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:28:58.331078 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

      drop table if exists "dev"."main"."raw_dm" cascade
    
[0m15:28:58.331731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:58.342665 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:28:58.365972 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:28:58.367203 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m15:28:58.368632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:28:58.370304 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:28:58.371756 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"SITEID" integer,"SUBJECT" integer,"SUBJID" integer,"RESCREENNUM_RAW" integer,"PREVSTUDY" text,"PREVSUBJ" integer,"RFICDTC" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m15:28:58.373556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:28:58.393601 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:28:58.394313 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:28:58.403149 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:28:58.408715 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m15:28:58.441259 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m15:28:58.442956 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m15:28:58.444684 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m15:28:58.453953 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:28:58.459208 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m15:28:58.463710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51ff1b08-aa6f-497e-a8ee-162187fbb902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fea635e0>]}
[0m15:28:58.465263 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mCREATE 40[0m in 0.20s]
[0m15:28:58.467288 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m15:28:58.469274 [debug] [MainThread]: Using duckdb connection "master"
[0m15:28:58.470081 [debug] [MainThread]: On master: BEGIN
[0m15:28:58.470800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:58.471968 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:28:58.472532 [debug] [MainThread]: On master: COMMIT
[0m15:28:58.473050 [debug] [MainThread]: Using duckdb connection "master"
[0m15:28:58.473577 [debug] [MainThread]: On master: COMMIT
[0m15:28:58.474300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:28:58.474866 [debug] [MainThread]: On master: Close
[0m15:28:58.475603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:58.476780 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m15:28:58.477343 [info ] [MainThread]: 
[0m15:28:58.478108 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:28:58.479038 [debug] [MainThread]: Command end result
[0m15:28:58.530232 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:28:58.533272 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:28:58.548059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:28:58.548843 [info ] [MainThread]: 
[0m15:28:58.550218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:58.551088 [info ] [MainThread]: 
[0m15:28:58.551835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:28:58.553438 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.956197, "process_in_blocks": "0", "process_kernel_time": 0.760376, "process_mem_max_rss": "155284", "process_out_blocks": "2768", "process_user_time": 4.868064}
[0m15:28:58.554698 [debug] [MainThread]: Command `dbt seed` succeeded at 15:28:58.554377 after 3.96 seconds
[0m15:28:58.557960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fd3ab4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fd1daad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12fd2e2f80>]}
[0m15:28:58.558983 [debug] [MainThread]: Flushing usage events
[0m15:28:58.900118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:05.320081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cbeb35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cac3d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cac3d510>]}


============================== 15:29:05.325681 | f27d8a9e-2c64-4625-a21f-2a170de1394f ==============================
[0m15:29:05.325681 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:29:05.326530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:29:05.652604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cae61540>]}
[0m15:29:05.751230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cac06500>]}
[0m15:29:05.754044 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:29:05.939896 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:29:06.106942 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:29:06.107882 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m15:29:06.108453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cb46fa60>]}
[0m15:29:08.563698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c629a650>]}
[0m15:29:08.875374 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:29:08.879510 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:29:08.907931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6303970>]}
[0m15:29:08.909026 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:29:08.910399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6303010>]}
[0m15:29:08.913865 [info ] [MainThread]: 
[0m15:29:08.915548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:08.916856 [info ] [MainThread]: 
[0m15:29:08.918287 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:29:08.920460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:29:09.019925 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:29:09.020611 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:29:09.020965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:09.041121 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:29:09.043471 [debug] [ThreadPool]: On list_dev: Close
[0m15:29:09.045196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:29:09.046423 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:29:09.065238 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:09.065777 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:29:09.066219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:09.067465 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:29:09.068638 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:09.068918 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:29:09.069428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:29:09.069660 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:09.069941 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:29:09.070395 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:29:09.071862 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:29:09.072760 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:29:09.073100 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:29:09.073550 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:29:09.073827 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:29:09.079355 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:29:09.084780 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:29:09.085213 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:29:09.085539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:09.086270 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:29:09.086558 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:29:09.086833 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:29:09.095687 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:29:09.097027 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:29:09.097609 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:29:09.097953 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:29:09.099037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6303460>]}
[0m15:29:09.099448 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:09.099686 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.099879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:09.100368 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:29:09.100688 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.100899 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:09.101118 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.101563 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:29:09.101824 [debug] [MainThread]: On master: Close
[0m15:29:09.103726 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:29:09.104270 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:29:09.105016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now model.VEXIN_03.dm)
[0m15:29:09.105432 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:29:09.113248 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:29:09.115590 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:29:09.155539 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:29:09.157808 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:29:09.158431 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:29:09.159039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:09.160273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:29:09.160778 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:29:09.161250 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE TRY_CAST(STRPTIME(DMDTC_RAW, '%m/%d/%Y') AS DATE)
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:29:09.163160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:29:09.170713 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:29:09.171138 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m15:29:09.172041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:29:09.186780 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:29:09.188019 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:29:09.190158 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:29:09.198154 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:29:09.213109 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:29:09.214336 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m15:29:09.215832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:29:09.222579 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:29:09.227136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d8a9e-2c64-4625-a21f-2a170de1394f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c64e1d80>]}
[0m15:29:09.228830 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.12s]
[0m15:29:09.230473 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:29:09.233324 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:09.234270 [debug] [MainThread]: On master: BEGIN
[0m15:29:09.235092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:09.236389 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:29:09.237195 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.238008 [debug] [MainThread]: Using duckdb connection "master"
[0m15:29:09.238742 [debug] [MainThread]: On master: COMMIT
[0m15:29:09.239817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:29:09.240597 [debug] [MainThread]: On master: Close
[0m15:29:09.242416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:09.243186 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:29:09.243771 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:29:09.244520 [info ] [MainThread]: 
[0m15:29:09.245604 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:29:09.247463 [debug] [MainThread]: Command end result
[0m15:29:09.290028 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:29:09.295692 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:29:09.304169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:29:09.304708 [info ] [MainThread]: 
[0m15:29:09.305581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:09.306090 [info ] [MainThread]: 
[0m15:29:09.306605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:09.307611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.135746, "process_in_blocks": "0", "process_kernel_time": 0.719001, "process_mem_max_rss": "150996", "process_out_blocks": "2808", "process_user_time": 4.966126}
[0m15:29:09.308133 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:09.308024 after 4.14 seconds
[0m15:29:09.308701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cbeb35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185cbb77c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7185c6a6ce50>]}
[0m15:29:09.309672 [debug] [MainThread]: Flushing usage events
[0m15:29:09.654359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:14.149275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b33af580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b2131480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b2131420>]}


============================== 15:40:14.152255 | 3fc3f9da-d399-436b-abb5-9c8665cc07fa ==============================
[0m15:40:14.152255 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:40:14.153072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m15:40:14.532264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b3070400>]}
[0m15:40:14.637158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b20fed70>]}
[0m15:40:14.640746 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:40:14.920942 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:40:15.225143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:15.226152 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://macros/convert_us_to_iso8601.sql
[0m15:40:15.802044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b22d6b90>]}
[0m15:40:15.953921 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:40:15.958828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:40:15.983865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665addd4580>]}
[0m15:40:15.985143 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:40:15.986424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665addd4b20>]}
[0m15:40:15.990696 [info ] [MainThread]: 
[0m15:40:15.992449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:15.993518 [info ] [MainThread]: 
[0m15:40:15.994955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:40:15.997391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:40:16.091687 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:40:16.092465 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:40:16.093363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:16.127565 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m15:40:16.131509 [debug] [ThreadPool]: On list_dev: Close
[0m15:40:16.133464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:40:16.134808 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:40:16.165477 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:16.166163 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:40:16.166687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:16.168054 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:40:16.169575 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:16.170435 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:40:16.170952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:16.172357 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:16.173312 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:40:16.174775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:16.176877 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:40:16.177704 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:16.178519 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:40:16.179531 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:16.180330 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:40:16.195852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:40:16.210110 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:40:16.211077 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:40:16.211854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:16.213342 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:40:16.214548 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:40:16.215417 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:40:16.239282 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m15:40:16.241903 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:40:16.243161 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:40:16.243978 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:40:16.247770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665add4aa40>]}
[0m15:40:16.248855 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:16.249660 [debug] [MainThread]: On master: BEGIN
[0m15:40:16.250399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:16.251696 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:40:16.252501 [debug] [MainThread]: On master: COMMIT
[0m15:40:16.253258 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:16.253987 [debug] [MainThread]: On master: COMMIT
[0m15:40:16.255076 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:40:16.255809 [debug] [MainThread]: On master: Close
[0m15:40:16.259655 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:40:16.260805 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:40:16.262065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:40:16.262891 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:40:16.284359 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:40:16.287062 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:40:16.358386 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:40:16.361406 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.362530 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:40:16.363856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:16.365530 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:16.366101 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.367105 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:40:16.370615 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:16.382337 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.383654 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m15:40:16.386210 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:40:16.392613 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.393046 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m15:40:16.394347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:40:16.431194 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:40:16.432418 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.433358 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:40:16.444793 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:40:16.458205 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:16.459699 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m15:40:16.468021 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:40:16.473825 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:40:16.478108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fc3f9da-d399-436b-abb5-9c8665cc07fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665adc9c130>]}
[0m15:40:16.479728 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.21s]
[0m15:40:16.482012 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:40:16.484289 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:16.485261 [debug] [MainThread]: On master: BEGIN
[0m15:40:16.486176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:16.487605 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:40:16.488760 [debug] [MainThread]: On master: COMMIT
[0m15:40:16.489359 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:16.489903 [debug] [MainThread]: On master: COMMIT
[0m15:40:16.491262 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:40:16.493321 [debug] [MainThread]: On master: Close
[0m15:40:16.494689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:16.495563 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:40:16.496452 [info ] [MainThread]: 
[0m15:40:16.497637 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:40:16.499496 [debug] [MainThread]: Command end result
[0m15:40:16.563460 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:40:16.568297 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:40:16.576515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:40:16.577181 [info ] [MainThread]: 
[0m15:40:16.577890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:16.578441 [info ] [MainThread]: 
[0m15:40:16.578935 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:40:16.579991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5374384, "process_in_blocks": "0", "process_kernel_time": 0.70137, "process_mem_max_rss": "147740", "process_out_blocks": "2816", "process_user_time": 3.676149}
[0m15:40:16.580566 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:16.580459 after 2.54 seconds
[0m15:40:16.580966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b33af580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b3221600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7665b49ba2f0>]}
[0m15:40:16.581407 [debug] [MainThread]: Flushing usage events
[0m15:40:16.936490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:05.966489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06036bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602445480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0602445420>]}


============================== 15:40:05.973318 | 6b33e459-fbf2-4c87-a64a-7883d46313e0 ==============================
[0m15:40:05.973318 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:40:05.974127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m15:40:06.362644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0604c5a2f0>]}
[0m15:40:06.446550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060240e920>]}
[0m15:40:06.451309 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:40:06.640551 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:40:06.979606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:06.980224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:07.057279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fe079ab0>]}
[0m15:40:07.203886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:40:07.209462 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:40:07.245675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fe0793f0>]}
[0m15:40:07.246201 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:40:07.246895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fe079450>]}
[0m15:40:07.248318 [info ] [MainThread]: 
[0m15:40:07.248925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:07.249263 [info ] [MainThread]: 
[0m15:40:07.249908 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:40:07.250709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:40:07.415300 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:40:07.416188 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:40:07.416878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:07.589573 [debug] [ThreadPool]: SQL status: OK in 0.173 seconds
[0m15:40:07.591180 [debug] [ThreadPool]: On list_dev: Close
[0m15:40:07.592141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:40:07.592748 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:40:07.600431 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:07.600897 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:40:07.601253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:07.602322 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:40:07.603667 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:07.604043 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:40:07.604584 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:07.604929 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:07.605253 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:40:07.605795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:07.606648 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:40:07.606919 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:40:07.607155 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:40:07.607563 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:40:07.607913 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:40:07.614131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:40:07.619576 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:40:07.619914 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:40:07.620622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:07.621344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:40:07.621724 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:40:07.622112 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:40:07.637771 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:40:07.639738 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:40:07.641858 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:40:07.642278 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:40:07.643759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fe07a530>]}
[0m15:40:07.644244 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:07.644600 [debug] [MainThread]: On master: BEGIN
[0m15:40:07.644884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:07.645559 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:40:07.645858 [debug] [MainThread]: On master: COMMIT
[0m15:40:07.646148 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:07.646432 [debug] [MainThread]: On master: COMMIT
[0m15:40:07.646894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:40:07.647183 [debug] [MainThread]: On master: Close
[0m15:40:07.650944 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:40:07.651620 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:40:07.652644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m15:40:07.653100 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:40:07.662504 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:40:07.674601 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:40:07.731789 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:40:07.734257 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.735262 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:40:07.736120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:07.737646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:40:07.739014 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.739422 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    ,raw_dm.rficdtc AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:40:07.743203 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:40:07.760190 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.761422 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m15:40:07.763496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:40:07.769735 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.771373 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m15:40:07.773173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:40:07.793587 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:40:07.794196 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.794738 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:40:07.803079 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:40:07.812840 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:40:07.818108 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m15:40:07.823543 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:40:07.829070 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:40:07.833354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b33e459-fbf2-4c87-a64a-7883d46313e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0604c5b670>]}
[0m15:40:07.835075 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.18s]
[0m15:40:07.836676 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:40:07.838754 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:07.839498 [debug] [MainThread]: On master: BEGIN
[0m15:40:07.840123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:07.841138 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:40:07.841526 [debug] [MainThread]: On master: COMMIT
[0m15:40:07.842034 [debug] [MainThread]: Using duckdb connection "master"
[0m15:40:07.842486 [debug] [MainThread]: On master: COMMIT
[0m15:40:07.843096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:40:07.843449 [debug] [MainThread]: On master: Close
[0m15:40:07.844018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:07.844388 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m15:40:07.844765 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:40:07.845208 [info ] [MainThread]: 
[0m15:40:07.862586 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:40:07.865527 [debug] [MainThread]: Command end result
[0m15:40:07.923233 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:40:07.927534 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:40:07.941798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:40:07.942586 [info ] [MainThread]: 
[0m15:40:07.943620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:07.944337 [info ] [MainThread]: 
[0m15:40:07.945031 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:40:07.948696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1042564, "process_in_blocks": "115952", "process_kernel_time": 3.396155, "process_mem_max_rss": "144332", "process_out_blocks": "1936", "process_user_time": 0.93416}
[0m15:40:07.949455 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:07.949319 after 2.11 seconds
[0m15:40:07.950260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06036bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0603529600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05fe028dc0>]}
[0m15:40:07.950901 [debug] [MainThread]: Flushing usage events
[0m15:40:08.289710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:48.518787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a56c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a4445420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a44453c0>]}


============================== 15:49:48.521971 | d371e432-2ed8-4aeb-a8c2-a9a712ff75f4 ==============================
[0m15:49:48.521971 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:49:48.522853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:48.872066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a4c05930>]}
[0m15:49:48.969389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a6aa7b20>]}
[0m15:49:48.973690 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:49:49.175686 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m15:49:49.428165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:49.429191 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/dm.sql
[0m15:49:49.993715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a466b250>]}
[0m15:49:50.124146 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:49:50.127610 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:49:50.145162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a0046860>]}
[0m15:49:50.145651 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:49:50.146336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a0022ec0>]}
[0m15:49:50.147614 [info ] [MainThread]: 
[0m15:49:50.148146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:50.148658 [info ] [MainThread]: 
[0m15:49:50.149330 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:49:50.150317 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:49:50.184322 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:49:50.185549 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:49:50.186526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:50.214709 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m15:49:50.218580 [debug] [ThreadPool]: On list_dev: Close
[0m15:49:50.220652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:49:50.222077 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:49:50.242743 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:49:50.243807 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:49:50.244580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:50.246559 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:49:50.249836 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:49:50.250708 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:49:50.251837 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:49:50.252666 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:49:50.253423 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:49:50.254500 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:49:50.256298 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:49:50.257138 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:49:50.257916 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:49:50.259599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:49:50.260397 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:49:50.273050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m15:49:50.284142 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:49:50.284857 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:49:50.285210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:50.286183 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:49:50.286717 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:49:50.287244 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:49:50.299065 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:49:50.300554 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:49:50.301521 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:49:50.301955 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:49:50.303436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a00470d0>]}
[0m15:49:50.303898 [debug] [MainThread]: Using duckdb connection "master"
[0m15:49:50.304209 [debug] [MainThread]: On master: BEGIN
[0m15:49:50.304459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:50.305024 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:49:50.305336 [debug] [MainThread]: On master: COMMIT
[0m15:49:50.305620 [debug] [MainThread]: Using duckdb connection "master"
[0m15:49:50.305975 [debug] [MainThread]: On master: COMMIT
[0m15:49:50.306386 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:49:50.306704 [debug] [MainThread]: On master: Close
[0m15:49:50.308548 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m15:49:50.309139 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m15:49:50.309684 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.VEXIN_03.dm'
[0m15:49:50.310054 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m15:49:50.324588 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m15:49:50.330116 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m15:49:50.406352 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m15:49:50.410339 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.411515 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m15:49:50.412497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:50.414275 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:49:50.415311 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.416573 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m15:49:50.420408 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:49:50.432953 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.433627 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m15:49:50.434697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:49:50.442683 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.443786 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m15:49:50.445508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:49:50.484964 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:49:50.485707 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.486265 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m15:49:50.491756 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:49:50.499856 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m15:49:50.500743 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m15:49:50.504936 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:49:50.508598 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m15:49:50.511301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd371e432-2ed8-4aeb-a8c2-a9a712ff75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a03107f0>]}
[0m15:49:50.512386 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.20s]
[0m15:49:50.513497 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m15:49:50.515376 [debug] [MainThread]: Using duckdb connection "master"
[0m15:49:50.516063 [debug] [MainThread]: On master: BEGIN
[0m15:49:50.516668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:50.517871 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:49:50.518505 [debug] [MainThread]: On master: COMMIT
[0m15:49:50.519167 [debug] [MainThread]: Using duckdb connection "master"
[0m15:49:50.519753 [debug] [MainThread]: On master: COMMIT
[0m15:49:50.520625 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:49:50.521159 [debug] [MainThread]: On master: Close
[0m15:49:50.522062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:50.522617 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:49:50.523132 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m15:49:50.523735 [info ] [MainThread]: 
[0m15:49:50.526380 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:49:50.528011 [debug] [MainThread]: Command end result
[0m15:49:50.568038 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m15:49:50.572401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m15:49:50.585006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m15:49:50.585907 [info ] [MainThread]: 
[0m15:49:50.586989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:50.588167 [info ] [MainThread]: 
[0m15:49:50.589106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:49:50.590873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.182501, "process_in_blocks": "384", "process_kernel_time": 0.662072, "process_mem_max_rss": "147504", "process_out_blocks": "2832", "process_user_time": 3.251698}
[0m15:49:50.591897 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:50.591694 after 2.18 seconds
[0m15:49:50.592657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a56c3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a4ca0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7965a058e2f0>]}
[0m15:49:50.593416 [debug] [MainThread]: Flushing usage events
[0m15:49:50.930540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:14.803852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a376c3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a36508310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a365082b0>]}


============================== 16:33:14.808284 | 1a340875-63e8-4f51-878c-146e966a55b4 ==============================
[0m16:33:14.808284 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:33:14.809358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:14.822617 [info ] [MainThread]: dbt version: 1.10.4
[0m16:33:14.823818 [info ] [MainThread]: python version: 3.10.12
[0m16:33:14.824807 [info ] [MainThread]: python path: /home/mlogan/projects/baas/adapters/tests/odm_json/.venv/bin/python3
[0m16:33:14.825703 [info ] [MainThread]: os info: Linux-6.8.0-64-generic-x86_64-with-glibc2.35
[0m16:33:14.964157 [info ] [MainThread]: Using profiles dir at /home/mlogan/.dbt
[0m16:33:14.965565 [info ] [MainThread]: Using profiles.yml file at /home/mlogan/.dbt/profiles.yml
[0m16:33:14.966146 [info ] [MainThread]: Using dbt_project.yml file at /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml
[0m16:33:14.967629 [info ] [MainThread]: adapter type: duckdb
[0m16:33:14.968056 [info ] [MainThread]: adapter version: 1.9.4
[0m16:33:15.132683 [info ] [MainThread]: Configuration:
[0m16:33:15.133537 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:33:15.136249 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:33:15.137847 [info ] [MainThread]: Required dependencies:
[0m16:33:15.138941 [debug] [MainThread]: Executing "git --help"
[0m16:33:15.147819 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:33:15.148896 [debug] [MainThread]: STDERR: "b''"
[0m16:33:15.149736 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:33:15.150756 [info ] [MainThread]: Connection:
[0m16:33:15.151717 [info ] [MainThread]:   database: dev
[0m16:33:15.152560 [info ] [MainThread]:   schema: main
[0m16:33:15.153485 [info ] [MainThread]:   path: dev.duckdb
[0m16:33:15.154393 [info ] [MainThread]:   config_options: None
[0m16:33:15.155354 [info ] [MainThread]:   extensions: None
[0m16:33:15.156794 [info ] [MainThread]:   settings: {}
[0m16:33:15.158182 [info ] [MainThread]:   external_root: .
[0m16:33:15.158955 [info ] [MainThread]:   use_credential_provider: None
[0m16:33:15.159908 [info ] [MainThread]:   attach: None
[0m16:33:15.160789 [info ] [MainThread]:   filesystems: None
[0m16:33:15.161660 [info ] [MainThread]:   remote: None
[0m16:33:15.162561 [info ] [MainThread]:   plugins: None
[0m16:33:15.163436 [info ] [MainThread]:   disable_transactions: False
[0m16:33:15.164684 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:33:15.329675 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:33:15.372623 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:33:15.373739 [debug] [MainThread]: On debug: select 1 as id
[0m16:33:15.374582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:15.392018 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m16:33:15.392979 [debug] [MainThread]: On debug: Close
[0m16:33:15.393489 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:33:15.394115 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:33:15.395129 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6663433, "process_in_blocks": "80", "process_kernel_time": 0.425158, "process_mem_max_rss": "136508", "process_out_blocks": "16", "process_user_time": 2.440409}
[0m16:33:15.395708 [debug] [MainThread]: Command `dbt debug` succeeded at 16:33:15.395606 after 0.67 seconds
[0m16:33:15.396172 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:33:15.396586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a376c3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a325b85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773a374535b0>]}
[0m16:33:15.397030 [debug] [MainThread]: Flushing usage events
[0m16:33:15.735905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:02.005556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2918dcf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2917be45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2917be4580>]}


============================== 16:34:02.008926 | 20b7f1eb-2529-4759-b9eb-f5b34d0bc61e ==============================
[0m16:34:02.008926 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:34:02.009846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:02.195217 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'VEXIN_03' in "<unicode string>", line 42, column 3 in file `/home
/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml`
[0m16:34:02.200421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2917aa6c50>]}
[0m16:34:02.353433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2917aa5c00>]}
[0m16:34:02.481865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2917f5bd90>]}
[0m16:34:02.483701 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:34:02.642804 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:34:02.851419 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:34:02.852310 [debug] [MainThread]: previous checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, current checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d
[0m16:34:02.852698 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:34:02.853234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2918431360>]}
[0m16:34:04.882394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.raw_dm.column_types
[0m16:34:04.888590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d29131a6560>]}
[0m16:34:05.097170 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:34:05.107560 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:34:05.160025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d29133f0760>]}
[0m16:34:05.161742 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:34:05.164225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d29133db2e0>]}
[0m16:34:05.166795 [info ] [MainThread]: 
[0m16:34:05.172013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:05.172841 [info ] [MainThread]: 
[0m16:34:05.179897 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:34:05.184533 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:34:05.272350 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:34:05.273009 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:34:05.273539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:05.289425 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m16:34:05.291531 [debug] [ThreadPool]: On list_dev: Close
[0m16:34:05.292529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:34:05.293187 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:34:05.301963 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:34:05.302480 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:34:05.302811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:05.304245 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:34:05.306677 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:34:05.307547 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:34:05.308541 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:34:05.309257 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:34:05.309939 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:34:05.311735 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:34:05.313469 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:34:05.314303 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:34:05.314618 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:34:05.315569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:34:05.316330 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:34:05.330765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:34:05.346934 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:34:05.347994 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:34:05.348817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:05.350258 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:34:05.351044 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:34:05.351806 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:34:05.372735 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m16:34:05.374692 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:34:05.375719 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:34:05.376200 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:34:05.377611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d29133f3280>]}
[0m16:34:05.378099 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:05.378416 [debug] [MainThread]: On master: BEGIN
[0m16:34:05.378692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:05.379322 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:34:05.379642 [debug] [MainThread]: On master: COMMIT
[0m16:34:05.379934 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:05.380250 [debug] [MainThread]: On master: COMMIT
[0m16:34:05.380691 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:34:05.381017 [debug] [MainThread]: On master: Close
[0m16:34:05.383082 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m16:34:05.383563 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m16:34:05.384653 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.VEXIN_03.raw_dm'
[0m16:34:05.385443 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m16:34:05.386723 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m16:34:05.467063 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:34:05.468509 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

      drop table if exists "dev"."main"."raw_dm" cascade
    
[0m16:34:05.469713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:05.477382 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:34:05.492371 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:34:05.494058 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m16:34:05.495643 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:34:05.496524 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:34:05.497334 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"SITEID" integer,"SUBJECT" integer,"SUBJID" integer,"RESCREENNUM_RAW" integer,"PREVSTUDY" text,"PREVSUBJ" integer,"RFICDTC" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m16:34:05.498810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:34:05.535823 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:34:05.539269 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:34:05.573071 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m16:34:05.585694 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m16:34:05.616264 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:34:05.617103 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:34:05.617606 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:34:05.623022 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:34:05.625214 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m16:34:05.627277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b7f1eb-2529-4759-b9eb-f5b34d0bc61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d291362e110>]}
[0m16:34:05.627943 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mCREATE 40[0m in 0.24s]
[0m16:34:05.628873 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m16:34:05.630017 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:05.630475 [debug] [MainThread]: On master: BEGIN
[0m16:34:05.630824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:05.631401 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:34:05.631764 [debug] [MainThread]: On master: COMMIT
[0m16:34:05.632534 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:05.632904 [debug] [MainThread]: On master: COMMIT
[0m16:34:05.633432 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:34:05.633781 [debug] [MainThread]: On master: Close
[0m16:34:05.634291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:05.634625 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:34:05.634953 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m16:34:05.635286 [info ] [MainThread]: 
[0m16:34:05.636197 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:34:05.637076 [debug] [MainThread]: Command end result
[0m16:34:05.667794 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:34:05.671809 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:34:05.691451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:34:05.692676 [info ] [MainThread]: 
[0m16:34:05.694510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:05.695944 [info ] [MainThread]: 
[0m16:34:05.698300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:34:05.703201 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:34:05.705040 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.7683842, "process_in_blocks": "2240", "process_kernel_time": 0.827874, "process_mem_max_rss": "155248", "process_out_blocks": "2768", "process_user_time": 4.439682}
[0m16:34:05.712046 [debug] [MainThread]: Command `dbt seed` succeeded at 16:34:05.706105 after 3.77 seconds
[0m16:34:05.713624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2918dcf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2913122320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2918cfacb0>]}
[0m16:34:05.714826 [debug] [MainThread]: Flushing usage events
[0m16:34:06.058274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:11.001779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c1eb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c0c24490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c0c24430>]}


============================== 16:34:11.006035 | e2400af6-33dc-489f-a04c-d1036ee6abab ==============================
[0m16:34:11.006035 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:34:11.007211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:34:11.017549 [info ] [MainThread]: dbt version: 1.10.4
[0m16:34:11.019104 [info ] [MainThread]: python version: 3.10.12
[0m16:34:11.019786 [info ] [MainThread]: python path: /home/mlogan/projects/baas/adapters/tests/odm_json/.venv/bin/python3
[0m16:34:11.020442 [info ] [MainThread]: os info: Linux-6.8.0-64-generic-x86_64-with-glibc2.35
[0m16:34:11.153933 [info ] [MainThread]: Using profiles dir at /home/mlogan/.dbt
[0m16:34:11.155721 [info ] [MainThread]: Using profiles.yml file at /home/mlogan/.dbt/profiles.yml
[0m16:34:11.157030 [info ] [MainThread]: Using dbt_project.yml file at /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml
[0m16:34:11.160489 [info ] [MainThread]: adapter type: duckdb
[0m16:34:11.161266 [info ] [MainThread]: adapter version: 1.9.4
[0m16:34:11.339497 [info ] [MainThread]: Configuration:
[0m16:34:11.340418 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:34:11.340984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:34:11.341569 [info ] [MainThread]: Required dependencies:
[0m16:34:11.342108 [debug] [MainThread]: Executing "git --help"
[0m16:34:11.345713 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:34:11.346298 [debug] [MainThread]: STDERR: "b''"
[0m16:34:11.346717 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:34:11.347639 [info ] [MainThread]: Connection:
[0m16:34:11.348207 [info ] [MainThread]:   database: dev
[0m16:34:11.348713 [info ] [MainThread]:   schema: main
[0m16:34:11.349205 [info ] [MainThread]:   path: dev.duckdb
[0m16:34:11.349648 [info ] [MainThread]:   config_options: None
[0m16:34:11.350103 [info ] [MainThread]:   extensions: None
[0m16:34:11.350547 [info ] [MainThread]:   settings: {}
[0m16:34:11.351005 [info ] [MainThread]:   external_root: .
[0m16:34:11.351443 [info ] [MainThread]:   use_credential_provider: None
[0m16:34:11.351891 [info ] [MainThread]:   attach: None
[0m16:34:11.352325 [info ] [MainThread]:   filesystems: None
[0m16:34:11.352781 [info ] [MainThread]:   remote: None
[0m16:34:11.353227 [info ] [MainThread]:   plugins: None
[0m16:34:11.353660 [info ] [MainThread]:   disable_transactions: False
[0m16:34:11.354306 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:34:11.517893 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:34:11.569754 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:34:11.571662 [debug] [MainThread]: On debug: select 1 as id
[0m16:34:11.572948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:11.610276 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m16:34:11.612252 [debug] [MainThread]: On debug: Close
[0m16:34:11.613061 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:34:11.613943 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:34:11.615675 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.70635104, "process_in_blocks": "0", "process_kernel_time": 0.372956, "process_mem_max_rss": "136528", "process_out_blocks": "8", "process_user_time": 2.026937}
[0m16:34:11.616838 [debug] [MainThread]: Command `dbt debug` succeeded at 16:34:11.616621 after 0.71 seconds
[0m16:34:11.617756 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:34:11.618796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c1eb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c14c71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b01c0a91300>]}
[0m16:34:11.619891 [debug] [MainThread]: Flushing usage events
[0m16:34:11.945069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:58.116549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f24cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f124d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f124d3c0>]}


============================== 16:36:58.123457 | ebce9481-2f8e-470e-b161-5dc68e8adda7 ==============================
[0m16:36:58.123457 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:36:58.125044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:58.277008 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'VEXIN_03' in "<unicode string>", line 42, column 3 in file `/home
/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/dbt_project.yml`
[0m16:36:58.278108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed31f1c0>]}
[0m16:36:58.516756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed291150>]}
[0m16:36:58.647493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f1adaf50>]}
[0m16:36:58.650933 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:36:58.897354 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m16:36:59.137815 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:36:59.140760 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m16:36:59.146127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f1a81ea0>]}
[0m16:37:01.546317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.raw_dm.column_types
[0m16:37:01.557476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ec8a6590>]}
[0m16:37:01.820083 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:37:01.827223 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:37:01.846745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ec92e560>]}
[0m16:37:01.847483 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:37:01.848307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ec91a920>]}
[0m16:37:01.849945 [info ] [MainThread]: 
[0m16:37:01.850655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:01.851767 [info ] [MainThread]: 
[0m16:37:01.852492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:37:01.853809 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:37:01.954835 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:37:01.961378 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:37:01.962254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:01.996272 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m16:37:01.999009 [debug] [ThreadPool]: On list_dev: Close
[0m16:37:02.002475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:37:02.003725 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:37:02.026104 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:02.026806 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:37:02.027056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:02.028513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:37:02.030649 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:02.030914 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:37:02.031512 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:02.031988 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:02.032962 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:37:02.033722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:02.034631 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:37:02.034952 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:37:02.035361 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:37:02.035897 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:02.036337 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:37:02.042718 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:37:02.048512 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:37:02.048885 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:37:02.049171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:02.049858 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:37:02.050178 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:37:02.050462 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:37:02.073876 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:37:02.077190 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:37:02.078821 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:37:02.079835 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:37:02.083462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ec92d150>]}
[0m16:37:02.084757 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:02.085873 [debug] [MainThread]: On master: BEGIN
[0m16:37:02.087428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:02.088976 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:37:02.089895 [debug] [MainThread]: On master: COMMIT
[0m16:37:02.090774 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:02.091605 [debug] [MainThread]: On master: COMMIT
[0m16:37:02.092818 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:37:02.093703 [debug] [MainThread]: On master: Close
[0m16:37:02.097261 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m16:37:02.098040 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m16:37:02.099724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m16:37:02.100619 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m16:37:02.124129 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m16:37:02.127078 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m16:37:02.203099 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m16:37:02.206150 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.206821 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m16:37:02.207457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:02.208669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:02.209362 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.209920 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m16:37:02.211939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:02.224630 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.226384 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m16:37:02.228140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:02.235201 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.236814 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m16:37:02.238541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:02.263532 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:37:02.264407 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.265424 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:37:02.280873 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:37:02.298405 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:37:02.299798 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m16:37:02.310432 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:37:02.315723 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m16:37:02.318710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebce9481-2f8e-470e-b161-5dc68e8adda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f3b27610>]}
[0m16:37:02.320246 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.22s]
[0m16:37:02.323032 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m16:37:02.325233 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:02.326086 [debug] [MainThread]: On master: BEGIN
[0m16:37:02.326687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:02.328319 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:37:02.329116 [debug] [MainThread]: On master: COMMIT
[0m16:37:02.329776 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:02.330072 [debug] [MainThread]: On master: COMMIT
[0m16:37:02.330706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:37:02.331423 [debug] [MainThread]: On master: Close
[0m16:37:02.336427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:02.337335 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m16:37:02.338133 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m16:37:02.338978 [info ] [MainThread]: 
[0m16:37:02.340151 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:37:02.341954 [debug] [MainThread]: Command end result
[0m16:37:02.410846 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:37:02.413987 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:37:02.428152 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:37:02.429535 [info ] [MainThread]: 
[0m16:37:02.430956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:02.432057 [info ] [MainThread]: 
[0m16:37:02.433137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:37:02.434548 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:37:02.437006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4136953, "process_in_blocks": "0", "process_kernel_time": 0.966017, "process_mem_max_rss": "150820", "process_out_blocks": "2832", "process_user_time": 5.106094}
[0m16:37:02.438118 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:02.437892 after 4.42 seconds
[0m16:37:02.439820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f24cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f2146500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f2ec9660>]}
[0m16:37:02.440727 [debug] [MainThread]: Flushing usage events
[0m16:37:02.794337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:10.399825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946f3c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946e144280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946e144220>]}


============================== 16:39:10.405518 | 97825a49-2fb2-4afb-b88d-3d92f74818fd ==============================
[0m16:39:10.405518 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:39:10.412595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'fail_fast': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:10.869534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946e043160>]}
[0m16:39:11.014796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946e145e40>]}
[0m16:39:11.017019 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:39:11.197285 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m16:39:11.384404 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:39:11.386383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946e97eb90>]}
[0m16:39:13.797646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.VEXIN_03.raw_dm.column_types
[0m16:39:13.814332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94697a65f0>]}
[0m16:39:14.139916 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:39:14.145203 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:39:14.170041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946983be80>]}
[0m16:39:14.171284 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:39:14.172920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946983beb0>]}
[0m16:39:14.175365 [info ] [MainThread]: 
[0m16:39:14.176299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:14.176950 [info ] [MainThread]: 
[0m16:39:14.177984 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:39:14.179868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:39:14.251385 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:39:14.252104 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:39:14.252539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:14.269942 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:39:14.271882 [debug] [ThreadPool]: On list_dev: Close
[0m16:39:14.272922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:39:14.273599 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:39:14.282278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:39:14.282762 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:39:14.283200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:14.284345 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:14.285855 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:39:14.286298 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:39:14.286883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:14.287281 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:39:14.287653 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:39:14.288498 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:14.289471 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:39:14.289917 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:39:14.290301 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:39:14.290829 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:39:14.291247 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:39:14.298322 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:39:14.305067 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:39:14.305491 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:39:14.305822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:14.306516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:39:14.306874 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:39:14.307207 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:39:14.317987 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:39:14.319642 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:39:14.321608 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:39:14.322124 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:39:14.323736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946983a620>]}
[0m16:39:14.324340 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:14.324700 [debug] [MainThread]: On master: BEGIN
[0m16:39:14.325043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:14.325726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:39:14.326289 [debug] [MainThread]: On master: COMMIT
[0m16:39:14.326715 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:14.327042 [debug] [MainThread]: On master: COMMIT
[0m16:39:14.327732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:14.328353 [debug] [MainThread]: On master: Close
[0m16:39:14.334157 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m16:39:14.335570 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m16:39:14.336737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now model.VEXIN_03.dm)
[0m16:39:14.339493 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m16:39:14.362956 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m16:39:14.365658 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m16:39:14.412220 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m16:39:14.414932 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.415423 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m16:39:14.415873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:14.416836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:39:14.417264 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.418026 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m16:39:14.419789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:39:14.429822 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.431168 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m16:39:14.433184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:39:14.439615 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.441215 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m16:39:14.442667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:39:14.465914 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:39:14.467074 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.467953 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:39:14.476569 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:39:14.492249 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:39:14.493541 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m16:39:14.501342 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:39:14.507259 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m16:39:14.511571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97825a49-2fb2-4afb-b88d-3d92f74818fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c94709cf670>]}
[0m16:39:14.513170 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.17s]
[0m16:39:14.516989 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m16:39:14.519311 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:14.520242 [debug] [MainThread]: On master: BEGIN
[0m16:39:14.521053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:14.522439 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:39:14.523261 [debug] [MainThread]: On master: COMMIT
[0m16:39:14.524032 [debug] [MainThread]: Using duckdb connection "master"
[0m16:39:14.525856 [debug] [MainThread]: On master: COMMIT
[0m16:39:14.526668 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:39:14.527492 [debug] [MainThread]: On master: Close
[0m16:39:14.528488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:14.529155 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m16:39:14.529773 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:39:14.530369 [info ] [MainThread]: 
[0m16:39:14.531654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:39:14.533455 [debug] [MainThread]: Command end result
[0m16:39:14.585465 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:39:14.594152 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:39:14.612210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:39:14.612667 [info ] [MainThread]: 
[0m16:39:14.613778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:14.614628 [info ] [MainThread]: 
[0m16:39:14.615261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:39:14.616992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.357194, "process_in_blocks": "0", "process_kernel_time": 0.887347, "process_mem_max_rss": "150916", "process_out_blocks": "2824", "process_user_time": 5.533367}
[0m16:39:14.618241 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:14.617951 after 4.36 seconds
[0m16:39:14.619173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946f3c3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c946f1d9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9469d94370>]}
[0m16:39:14.620130 [debug] [MainThread]: Flushing usage events
[0m16:39:14.969059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:57.791595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2400bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23ee38610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23ee385b0>]}


============================== 16:44:57.794783 | 0f67de9f-0fc9-464a-abbc-1676bac5a429 ==============================
[0m16:44:57.794783 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:44:57.795659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:58.107982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23ee0e200>]}
[0m16:44:58.204814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23ee3b1f0>]}
[0m16:44:58.206950 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:44:58.363389 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:44:58.562845 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:44:58.563795 [debug] [MainThread]: previous checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, current checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d
[0m16:44:58.564788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23f676b90>]}
[0m16:45:00.924468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.VEXIN_03.raw_dm.column_types
[0m16:45:00.945041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a4664d0>]}
[0m16:45:01.200072 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:45:01.203599 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:45:01.221115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a503820>]}
[0m16:45:01.221762 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:45:01.222623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a6e9c00>]}
[0m16:45:01.224457 [info ] [MainThread]: 
[0m16:45:01.225035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:01.225447 [info ] [MainThread]: 
[0m16:45:01.226050 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:45:01.226932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:45:01.276298 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:45:01.277042 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:45:01.277452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:01.300558 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:45:01.303063 [debug] [ThreadPool]: On list_dev: Close
[0m16:45:01.305955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:45:01.306877 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:45:01.317357 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:01.318343 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:45:01.319168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:01.321403 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:45:01.322781 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:01.323264 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:45:01.324788 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:45:01.325415 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:01.325854 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:45:01.326579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:45:01.327538 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:45:01.327910 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:01.328192 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:45:01.328860 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:45:01.329377 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:45:01.337263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:45:01.342940 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:45:01.343408 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:45:01.343757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:01.344517 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:45:01.344862 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:45:01.345551 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:45:01.355475 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:45:01.358986 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:45:01.360411 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:45:01.361453 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:45:01.364750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a69c0a0>]}
[0m16:45:01.365951 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:01.367479 [debug] [MainThread]: On master: BEGIN
[0m16:45:01.368320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:01.369465 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:45:01.370160 [debug] [MainThread]: On master: COMMIT
[0m16:45:01.370888 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:01.371545 [debug] [MainThread]: On master: COMMIT
[0m16:45:01.372252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:45:01.372811 [debug] [MainThread]: On master: Close
[0m16:45:01.376543 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m16:45:01.378534 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m16:45:01.380276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m16:45:01.381349 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m16:45:01.382334 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m16:45:01.487054 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:45:01.490151 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

      drop table if exists "dev"."main"."raw_dm" cascade
    
[0m16:45:01.492861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:01.506198 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:45:01.525315 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:45:01.526585 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m16:45:01.529342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:45:01.530278 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:45:01.531285 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"SITEID" integer,"SUBJECT" integer,"SUBJID" integer,"RESCREENNUM_RAW" integer,"PREVSTUDY" text,"PREVSUBJ" integer,"RFICDTC" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m16:45:01.532912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:45:01.565849 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:45:01.571801 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:45:01.588618 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m16:45:01.618305 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m16:45:01.684225 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:45:01.686941 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:45:01.690010 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:45:01.702499 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:45:01.709154 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m16:45:01.718154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f67de9f-0fc9-464a-abbc-1676bac5a429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a945bd0>]}
[0m16:45:01.722134 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mCREATE 40[0m in 0.34s]
[0m16:45:01.725639 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m16:45:01.732812 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:01.734643 [debug] [MainThread]: On master: BEGIN
[0m16:45:01.735495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:01.736911 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:45:01.737859 [debug] [MainThread]: On master: COMMIT
[0m16:45:01.741291 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:01.743075 [debug] [MainThread]: On master: COMMIT
[0m16:45:01.743977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:45:01.744382 [debug] [MainThread]: On master: Close
[0m16:45:01.745156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:01.745563 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m16:45:01.746102 [info ] [MainThread]: 
[0m16:45:01.746764 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m16:45:01.747609 [debug] [MainThread]: Command end result
[0m16:45:01.777366 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:45:01.785730 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:45:01.800719 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:45:01.801419 [info ] [MainThread]: 
[0m16:45:01.807019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:01.810258 [info ] [MainThread]: 
[0m16:45:01.811854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:45:01.815265 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.1613445, "process_in_blocks": "0", "process_kernel_time": 0.825123, "process_mem_max_rss": "155180", "process_out_blocks": "2776", "process_user_time": 5.192442}
[0m16:45:01.818566 [debug] [MainThread]: Command `dbt seed` succeeded at 16:45:01.818274 after 4.17 seconds
[0m16:45:01.819892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2400bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23ff29600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d23a62d2d0>]}
[0m16:45:01.821337 [debug] [MainThread]: Flushing usage events
[0m16:45:02.174881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:41.773927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd60eb75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5fce0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5fce02b0>]}


============================== 16:45:41.779204 | 108b1dc2-92e4-48d8-aed3-fbc9152d8a08 ==============================
[0m16:45:41.779204 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:45:41.780656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:45:42.146381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd624cd9f0>]}
[0m16:45:42.249294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5fce1ed0>]}
[0m16:45:42.252629 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:45:42.439364 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m16:45:42.603581 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:45:42.604512 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m16:45:42.605084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd6051ba60>]}
[0m16:45:44.952516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.VEXIN_03.raw_dm.column_types
[0m16:45:44.960444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b27a650>]}
[0m16:45:45.269532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:45:45.274094 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:45:45.299246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b4ed810>]}
[0m16:45:45.300508 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:45:45.301733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b4ed7b0>]}
[0m16:45:45.304527 [info ] [MainThread]: 
[0m16:45:45.305643 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:45.306642 [info ] [MainThread]: 
[0m16:45:45.310578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:45:45.312498 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:45:45.387669 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:45:45.388725 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:45:45.389077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:45.421828 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m16:45:45.424499 [debug] [ThreadPool]: On list_dev: Close
[0m16:45:45.425332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:45:45.426221 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:45:45.436956 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:45.437492 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:45:45.437871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:45.439105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:45:45.440605 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:45.441023 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:45:45.441486 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:45:45.441758 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:45.442117 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:45:45.442574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:45:45.443332 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:45:45.443627 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:45:45.443928 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:45:45.444325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:45:45.444617 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:45:45.451860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:45:45.458859 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:45:45.459543 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:45:45.459903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:45.462445 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:45:45.462917 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:45:45.463320 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:45:45.485922 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m16:45:45.490289 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:45:45.491311 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:45:45.491725 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:45:45.493441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b4edf60>]}
[0m16:45:45.494278 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:45.494797 [debug] [MainThread]: On master: BEGIN
[0m16:45:45.495258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:45.495994 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:45:45.496330 [debug] [MainThread]: On master: COMMIT
[0m16:45:45.496785 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:45.497105 [debug] [MainThread]: On master: COMMIT
[0m16:45:45.497585 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:45:45.497967 [debug] [MainThread]: On master: Close
[0m16:45:45.500000 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m16:45:45.500678 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m16:45:45.501455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m16:45:45.501894 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m16:45:45.523538 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m16:45:45.526442 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m16:45:45.577801 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m16:45:45.584120 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.585276 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m16:45:45.586116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:45.587737 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:45:45.588592 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.589637 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m16:45:45.593156 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:45:45.607780 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.608962 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m16:45:45.610902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:45:45.613992 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.614602 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m16:45:45.615580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:45:45.631865 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:45:45.633210 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.634313 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:45:45.643543 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:45:45.656510 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:45:45.657580 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m16:45:45.669516 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:45:45.675334 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m16:45:45.678924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '108b1dc2-92e4-48d8-aed3-fbc9152d8a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b46b910>]}
[0m16:45:45.682227 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.18s]
[0m16:45:45.684036 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m16:45:45.685873 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:45.686576 [debug] [MainThread]: On master: BEGIN
[0m16:45:45.687161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:45.688337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:45:45.689015 [debug] [MainThread]: On master: COMMIT
[0m16:45:45.689701 [debug] [MainThread]: Using duckdb connection "master"
[0m16:45:45.691442 [debug] [MainThread]: On master: COMMIT
[0m16:45:45.692701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:45:45.693584 [debug] [MainThread]: On master: Close
[0m16:45:45.694715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:45.695385 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m16:45:45.695948 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m16:45:45.696637 [info ] [MainThread]: 
[0m16:45:45.697845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:45:45.699566 [debug] [MainThread]: Command end result
[0m16:45:45.744161 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:45:45.747918 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:45:45.755524 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:45:45.756005 [info ] [MainThread]: 
[0m16:45:45.756838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:45.757897 [info ] [MainThread]: 
[0m16:45:45.759157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:45:45.760702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.089242, "process_in_blocks": "0", "process_kernel_time": 0.931091, "process_mem_max_rss": "150912", "process_out_blocks": "2832", "process_user_time": 5.200689}
[0m16:45:45.761290 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:45.761190 after 4.09 seconds
[0m16:45:45.761776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd60eb75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b70ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbd5b708be0>]}
[0m16:45:45.762167 [debug] [MainThread]: Flushing usage events
[0m16:45:46.087111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:58.115850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b126abf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b12582c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b12582c130>]}


============================== 16:48:58.122061 | 074bd947-1b2a-496b-b4a8-0b9cff2f62db ==============================
[0m16:48:58.122061 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:48:58.123278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:58.352851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '074bd947-1b2a-496b-b4a8-0b9cff2f62db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b125833ac0>]}
[0m16:48:58.397245 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.39657488, "process_in_blocks": "8", "process_kernel_time": 0.386658, "process_mem_max_rss": "98636", "process_out_blocks": "8", "process_user_time": 2.160241}
[0m16:48:58.398342 [debug] [MainThread]: Command `dbt clean` succeeded at 16:48:58.398123 after 0.40 seconds
[0m16:48:58.399115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b126abf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b125833c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b125833ac0>]}
[0m16:48:58.399922 [debug] [MainThread]: Flushing usage events
[0m16:48:58.744749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:05.572711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89ba0b7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b8e30400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b8e303a0>]}


============================== 16:49:05.576180 | 46c693b0-13e6-4f42-ac85-bb5d463668e4 ==============================
[0m16:49:05.576180 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:49:05.577019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:05.907533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b8e33430>]}
[0m16:49:06.061467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b8e33340>]}
[0m16:49:06.066920 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:49:06.259814 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:49:06.261389 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:49:06.262876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b4ee8d90>]}
[0m16:49:08.849511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b443d3c0>]}
[0m16:49:09.028235 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:49:09.029551 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:49:09.039124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b4415cf0>]}
[0m16:49:09.039666 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:49:09.040188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b44aaf20>]}
[0m16:49:09.041911 [info ] [MainThread]: 
[0m16:49:09.042711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:09.043094 [info ] [MainThread]: 
[0m16:49:09.043715 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:49:09.044496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:49:09.210111 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:49:09.211142 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:49:09.214184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:09.238650 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:49:09.240460 [debug] [ThreadPool]: On list_dev: Close
[0m16:49:09.241491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:49:09.242181 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:49:09.256900 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:49:09.257975 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:49:09.258783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:09.260911 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:49:09.263606 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:49:09.264915 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:49:09.266200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:09.267296 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:49:09.268291 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:49:09.269505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:09.271265 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:49:09.272037 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:49:09.272811 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:49:09.273871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:49:09.274704 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:49:09.287333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:49:09.298595 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:49:09.299721 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:49:09.300175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:09.301405 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:49:09.302302 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:49:09.302636 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:49:09.316285 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:49:09.317678 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:49:09.318747 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:49:09.319180 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:49:09.320571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b4697850>]}
[0m16:49:09.321064 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:09.321380 [debug] [MainThread]: On master: BEGIN
[0m16:49:09.321650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:09.322238 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:49:09.322540 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.322819 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:09.323126 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.323557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:09.323879 [debug] [MainThread]: On master: Close
[0m16:49:09.325843 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m16:49:09.326434 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m16:49:09.327007 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.VEXIN_03.raw_dm'
[0m16:49:09.327366 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m16:49:09.327707 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m16:49:09.388751 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:49:09.390059 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

      drop table if exists "dev"."main"."raw_dm" cascade
    
[0m16:49:09.391226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:09.400724 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:49:09.427177 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:49:09.428554 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m16:49:09.430109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:49:09.431024 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:49:09.431957 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"SITEID" text,"SUBJECT" text,"SUBJID" integer,"RESCREENNUM_RAW" text,"PREVSTUDY" text,"PREVSUBJ" text,"RFICDTC" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m16:49:09.433657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:49:09.480866 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:49:09.482625 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:49:09.499523 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m16:49:09.513361 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m16:49:09.538591 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:49:09.539358 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m16:49:09.539848 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m16:49:09.548882 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:49:09.551465 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m16:49:09.554802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46c693b0-13e6-4f42-ac85-bb5d463668e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b46be680>]}
[0m16:49:09.555555 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mCREATE 40[0m in 0.23s]
[0m16:49:09.556471 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m16:49:09.559025 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:09.559533 [debug] [MainThread]: On master: BEGIN
[0m16:49:09.559929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:09.560822 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:49:09.561204 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.561697 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:09.562061 [debug] [MainThread]: On master: COMMIT
[0m16:49:09.562676 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:49:09.562991 [debug] [MainThread]: On master: Close
[0m16:49:09.563422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:09.564389 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m16:49:09.568217 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m16:49:09.568937 [info ] [MainThread]: 
[0m16:49:09.570216 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:49:09.572237 [debug] [MainThread]: Command end result
[0m16:49:09.631139 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:49:09.633603 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:49:09.640987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:49:09.641505 [info ] [MainThread]: 
[0m16:49:09.641879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:09.643117 [info ] [MainThread]: 
[0m16:49:09.644235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:09.645796 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.1492796, "process_in_blocks": "0", "process_kernel_time": 0.615488, "process_mem_max_rss": "155824", "process_out_blocks": "2776", "process_user_time": 5.210576}
[0m16:49:09.646518 [debug] [MainThread]: Command `dbt seed` succeeded at 16:49:09.646421 after 4.15 seconds
[0m16:49:09.646921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89ba0b7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b9ecad70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d89b4bbf880>]}
[0m16:49:09.648062 [debug] [MainThread]: Flushing usage events
[0m16:49:09.974074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:10.982750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128cecbb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128cda40280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128cda40220>]}


============================== 16:50:10.985891 | 9289208e-bc6b-45a2-b5d7-8da7a348dc1d ==============================
[0m16:50:10.985891 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:50:10.986773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m16:50:11.385636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c9b8b160>]}
[0m16:50:11.509739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128cda41e40>]}
[0m16:50:11.513623 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:50:11.757754 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m16:50:12.015416 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:50:12.016464 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m16:50:12.016983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128ce276b90>]}
[0m16:50:14.530100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c90c25f0>]}
[0m16:50:14.795487 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:50:14.802273 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:50:14.825991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c911db10>]}
[0m16:50:14.826677 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m16:50:14.827379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c911dab0>]}
[0m16:50:14.828814 [info ] [MainThread]: 
[0m16:50:14.829375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:14.829831 [info ] [MainThread]: 
[0m16:50:14.830476 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:50:14.831376 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:50:14.874663 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:50:14.875369 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:50:14.875728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:14.893068 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:50:14.895001 [debug] [ThreadPool]: On list_dev: Close
[0m16:50:14.896112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:50:14.896848 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:50:14.911666 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:50:14.912772 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:50:14.913558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:14.915474 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:50:14.917815 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:50:14.918377 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:50:14.920933 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:50:14.921584 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:50:14.922064 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:50:14.922947 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:50:14.924266 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:50:14.924922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:50:14.925327 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:50:14.925857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:50:14.926245 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:50:14.934169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:50:14.941533 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:50:14.942025 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:50:14.942449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:14.943238 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:50:14.943692 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:50:14.944098 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:50:14.959630 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:50:14.963053 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:50:14.964319 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:50:14.965039 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:50:14.968251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c911e080>]}
[0m16:50:14.969299 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:14.970086 [debug] [MainThread]: On master: BEGIN
[0m16:50:14.970805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:14.971998 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:50:14.974811 [debug] [MainThread]: On master: COMMIT
[0m16:50:14.975686 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:14.976397 [debug] [MainThread]: On master: COMMIT
[0m16:50:14.977395 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:50:14.978134 [debug] [MainThread]: On master: Close
[0m16:50:14.981623 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m16:50:14.982882 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m16:50:14.984956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m16:50:14.986092 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m16:50:15.010048 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m16:50:15.013699 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m16:50:15.091021 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m16:50:15.092984 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.093879 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m16:50:15.094612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:15.096098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:50:15.096896 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.097833 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m16:50:15.102167 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:50:15.116658 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.117140 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m16:50:15.118415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:50:15.125335 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.126235 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m16:50:15.127454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:50:15.140350 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:50:15.140892 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.141361 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m16:50:15.148324 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:50:15.166774 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m16:50:15.167609 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m16:50:15.175129 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:50:15.180524 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m16:50:15.184176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9289208e-bc6b-45a2-b5d7-8da7a348dc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c92aab60>]}
[0m16:50:15.186740 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.20s]
[0m16:50:15.188774 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m16:50:15.191472 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:15.192633 [debug] [MainThread]: On master: BEGIN
[0m16:50:15.193663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:15.195778 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:50:15.198001 [debug] [MainThread]: On master: COMMIT
[0m16:50:15.199045 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:15.200032 [debug] [MainThread]: On master: COMMIT
[0m16:50:15.201151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:50:15.201899 [debug] [MainThread]: On master: Close
[0m16:50:15.203036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:15.203782 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m16:50:15.204670 [info ] [MainThread]: 
[0m16:50:15.205649 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:50:15.210495 [debug] [MainThread]: Command end result
[0m16:50:15.252307 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m16:50:15.258651 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m16:50:15.278435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m16:50:15.279455 [info ] [MainThread]: 
[0m16:50:15.280476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:15.281717 [info ] [MainThread]: 
[0m16:50:15.287421 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:50:15.289068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4157104, "process_in_blocks": "0", "process_kernel_time": 0.775467, "process_mem_max_rss": "150900", "process_out_blocks": "2832", "process_user_time": 5.436796}
[0m16:50:15.289770 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:15.289632 after 4.42 seconds
[0m16:50:15.290351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128cecbb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128ceb2ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7128c92a3ee0>]}
[0m16:50:15.290950 [debug] [MainThread]: Flushing usage events
[0m16:50:15.640448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:05.011151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7732180b3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773216e3c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773216e3c220>]}


============================== 17:35:05.017826 | e2dd4a91-c574-46e5-a16f-33680af1c505 ==============================
[0m17:35:05.017826 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:35:05.018595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:35:05.292613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212f87160>]}
[0m17:35:05.349130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773216e3de40>]}
[0m17:35:05.353237 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m17:35:05.476980 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m17:35:05.679048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:05.679535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:05.738700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212a71ab0>]}
[0m17:35:05.829130 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m17:35:05.833195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m17:35:05.863202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212a71750>]}
[0m17:35:05.863681 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m17:35:05.864397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212a717b0>]}
[0m17:35:05.865443 [info ] [MainThread]: 
[0m17:35:05.865951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:05.866341 [info ] [MainThread]: 
[0m17:35:05.866865 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:05.867585 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:35:05.965550 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:35:05.966015 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:35:05.966307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:06.110685 [debug] [ThreadPool]: SQL status: OK in 0.144 seconds
[0m17:35:06.112066 [debug] [ThreadPool]: On list_dev: Close
[0m17:35:06.112844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:35:06.113307 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:35:06.118718 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:35:06.119054 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:35:06.119314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:06.120642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:35:06.121592 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:35:06.121866 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:35:06.122253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.122534 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:35:06.122768 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:35:06.123143 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.123759 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:35:06.123985 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:35:06.124178 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:35:06.124515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:06.124727 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:35:06.129216 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m17:35:06.135038 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:35:06.135410 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:35:06.135674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:06.136215 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:35:06.136475 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:35:06.136720 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:35:06.150123 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m17:35:06.151818 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:35:06.153537 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:35:06.153849 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:35:06.154916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212a72530>]}
[0m17:35:06.155276 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.155516 [debug] [MainThread]: On master: BEGIN
[0m17:35:06.155715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:06.156167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.156398 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.156643 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.156836 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.157152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.157368 [debug] [MainThread]: On master: Close
[0m17:35:06.160706 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m17:35:06.161181 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m17:35:06.161854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m17:35:06.162170 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m17:35:06.169965 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m17:35:06.173075 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m17:35:06.200715 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m17:35:06.203430 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.203831 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m17:35:06.204160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:06.204851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:06.205628 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.206020 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m17:35:06.208335 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:06.214281 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.214686 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m17:35:06.215449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:06.219160 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.219509 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m17:35:06.220082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:06.233651 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m17:35:06.234244 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.234614 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m17:35:06.241112 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:35:06.245848 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m17:35:06.246233 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m17:35:06.251066 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:06.253293 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m17:35:06.256081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2dd4a91-c574-46e5-a16f-33680af1c505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77321968b670>]}
[0m17:35:06.256708 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.09s]
[0m17:35:06.257506 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m17:35:06.258670 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.258984 [debug] [MainThread]: On master: BEGIN
[0m17:35:06.259225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:06.259801 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:06.260070 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.260323 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:06.260554 [debug] [MainThread]: On master: COMMIT
[0m17:35:06.260943 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:06.261196 [debug] [MainThread]: On master: Close
[0m17:35:06.261564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:06.261812 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m17:35:06.262027 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m17:35:06.262269 [info ] [MainThread]: 
[0m17:35:06.262724 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:35:06.263336 [debug] [MainThread]: Command end result
[0m17:35:06.288507 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m17:35:06.294961 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m17:35:06.302060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m17:35:06.302447 [info ] [MainThread]: 
[0m17:35:06.303114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:06.303580 [info ] [MainThread]: 
[0m17:35:06.303997 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:35:06.306476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3598306, "process_in_blocks": "115784", "process_kernel_time": 2.008699, "process_mem_max_rss": "144288", "process_out_blocks": "1944", "process_user_time": 0.382089}
[0m17:35:06.307159 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:06.307027 after 1.36 seconds
[0m17:35:06.308311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7732180b3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773212a26b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773217697640>]}
[0m17:35:06.308768 [debug] [MainThread]: Flushing usage events
[0m17:35:06.675400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:27.021792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9b4c34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9a234280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9a234220>]}


============================== 18:43:27.025617 | c67449c7-2e69-40c2-8242-0fa3dd3c9a13 ==============================
[0m18:43:27.025617 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:43:27.026068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:27.159530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c67449c7-2e69-40c2-8242-0fa3dd3c9a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9a23a140>]}
[0m18:43:27.192750 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22529216, "process_in_blocks": "29336", "process_kernel_time": 1.353016, "process_mem_max_rss": "98600", "process_out_blocks": "16", "process_user_time": 0.195592}
[0m18:43:27.193693 [debug] [MainThread]: Command `dbt clean` succeeded at 18:43:27.193543 after 0.23 seconds
[0m18:43:27.194263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9b4c34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9a239990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74af9a23a140>]}
[0m18:43:27.194830 [debug] [MainThread]: Flushing usage events
[0m18:43:27.536976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:37.619124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb77db5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb65f45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb65f4580>]}


============================== 18:43:37.621628 | f4fd9f16-2f5c-43a4-b809-133f215caf26 ==============================
[0m18:43:37.621628 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:43:37.622334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:43:37.889898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb64b2320>]}
[0m18:43:37.971102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb64b3610>]}
[0m18:43:37.975779 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m18:43:38.126445 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:43:38.127274 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:43:38.127889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb25e1720>]}
[0m18:43:39.967644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb1b39480>]}
[0m18:43:40.119859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m18:43:40.121486 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m18:43:40.143124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb1b10f40>]}
[0m18:43:40.143694 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m18:43:40.144393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb1b3b280>]}
[0m18:43:40.145966 [info ] [MainThread]: 
[0m18:43:40.146456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:40.146863 [info ] [MainThread]: 
[0m18:43:40.147383 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:43:40.148217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:43:40.266065 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:43:40.266563 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:43:40.267161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:40.283250 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m18:43:40.284775 [debug] [ThreadPool]: On list_dev: Close
[0m18:43:40.285570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:43:40.286045 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:43:40.297553 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:40.298084 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:43:40.298379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:40.300068 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:43:40.301193 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:40.301481 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:43:40.301870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:40.302117 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:40.302375 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:43:40.302753 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:40.303474 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:43:40.303739 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:40.303969 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:43:40.304311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:40.304599 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:43:40.313677 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m18:43:40.318974 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:43:40.319415 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:43:40.319716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:40.323284 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:43:40.323633 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:43:40.323967 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:43:40.334597 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:43:40.336178 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:43:40.338509 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:43:40.338868 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:43:40.340063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb1b820e0>]}
[0m18:43:40.340506 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:40.340774 [debug] [MainThread]: On master: BEGIN
[0m18:43:40.341006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:40.342070 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:40.342346 [debug] [MainThread]: On master: COMMIT
[0m18:43:40.342600 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:40.342805 [debug] [MainThread]: On master: COMMIT
[0m18:43:40.343137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:40.343362 [debug] [MainThread]: On master: Close
[0m18:43:40.346616 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m18:43:40.347098 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m18:43:40.347751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m18:43:40.348070 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m18:43:40.348404 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m18:43:40.382139 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m18:43:40.382701 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m18:43:40.383043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:40.386397 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:43:40.386863 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m18:43:40.387209 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m18:43:40.389895 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:43:40.401836 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m18:43:40.402434 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:43:40.419890 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m18:43:40.425659 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m18:43:40.434154 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m18:43:40.434610 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m18:43:40.434955 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m18:43:40.457167 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m18:43:40.459308 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m18:43:40.462281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd9f16-2f5c-43a4-b809-133f215caf26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb204eef0>]}
[0m18:43:40.462853 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mINSERT 40[0m in 0.11s]
[0m18:43:40.463558 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m18:43:40.464606 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:40.464863 [debug] [MainThread]: On master: BEGIN
[0m18:43:40.465105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:40.465639 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:40.465862 [debug] [MainThread]: On master: COMMIT
[0m18:43:40.466087 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:40.466279 [debug] [MainThread]: On master: COMMIT
[0m18:43:40.466616 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:40.466840 [debug] [MainThread]: On master: Close
[0m18:43:40.467209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:40.467406 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m18:43:40.467578 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m18:43:40.467777 [info ] [MainThread]: 
[0m18:43:40.468277 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:43:40.468903 [debug] [MainThread]: Command end result
[0m18:43:40.493682 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m18:43:40.496341 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m18:43:40.504677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m18:43:40.505694 [info ] [MainThread]: 
[0m18:43:40.506553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:40.506963 [info ] [MainThread]: 
[0m18:43:40.507354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:40.508191 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.9817927, "process_in_blocks": "7432", "process_kernel_time": 2.650702, "process_mem_max_rss": "162072", "process_out_blocks": "2752", "process_user_time": 1.485946}
[0m18:43:40.508881 [debug] [MainThread]: Command `dbt seed` succeeded at 18:43:40.508729 after 2.98 seconds
[0m18:43:40.509890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb77db5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb1b10f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77adb7512cb0>]}
[0m18:43:40.510698 [debug] [MainThread]: Flushing usage events
[0m18:43:40.829848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:47.971867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e49bd7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e489f8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e489f8220>]}


============================== 18:43:47.974097 | f5b6f2be-477e-4761-a348-fcd3ba8386aa ==============================
[0m18:43:47.974097 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:43:47.974770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m18:43:48.169549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4995b3a0>]}
[0m18:43:48.225183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4925ea10>]}
[0m18:43:48.228329 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m18:43:48.335903 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m18:43:48.442809 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:43:48.443701 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m18:43:48.444121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e49235ea0>]}
[0m18:43:49.724592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e43fb6590>]}
[0m18:43:49.872399 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m18:43:49.874874 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m18:43:49.885199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4400d000>]}
[0m18:43:49.885708 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m18:43:49.886238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4400d060>]}
[0m18:43:49.887336 [info ] [MainThread]: 
[0m18:43:49.887769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:49.888097 [info ] [MainThread]: 
[0m18:43:49.888578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:43:49.889282 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:43:49.930099 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:43:49.930736 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:43:49.931162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:49.946357 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:43:49.949645 [debug] [ThreadPool]: On list_dev: Close
[0m18:43:49.950535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:43:49.951086 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:43:49.959828 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:49.961610 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:43:49.962014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:43:49.963099 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:43:49.964385 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:49.964738 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:43:49.965234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:49.965560 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:49.965861 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:43:49.966317 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:49.967064 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:43:49.967377 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:43:49.967615 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:43:49.967963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:43:49.970423 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:43:49.976023 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m18:43:49.982498 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:43:49.982937 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:43:49.983253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:49.983912 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:43:49.984226 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:43:49.984515 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:43:49.994032 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:43:49.995307 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:43:49.995844 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:43:49.996167 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:43:49.997327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4400e8f0>]}
[0m18:43:49.997756 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:49.998025 [debug] [MainThread]: On master: BEGIN
[0m18:43:49.998278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:49.998748 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:49.999011 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.999274 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:49.999511 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.999861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:50.000140 [debug] [MainThread]: On master: Close
[0m18:43:50.004638 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m18:43:50.005194 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m18:43:50.005886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m18:43:50.006344 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m18:43:50.016541 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m18:43:50.017514 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m18:43:50.062708 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m18:43:50.069154 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.069589 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m18:43:50.069839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:50.070502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:43:50.070785 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.071097 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
-- This SELECT block builds the SDTM-compliant domain using:
--  - Direct mappings from source columns
--  - Standard derivation snippets (injected)
--  - Custom derivation snippets (injected per domain)
--  - Null placeholders for unmapped variables (with TODO comments)
-- Column order is based on SDTMIG metadata
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID
    ,NULL AS VISIT  -- TODO: Standard derivation file missing for VISIT
    ,NULL AS VISITDY  -- TODO: Standard derivation file missing for VISITDY

FROM "dev"."main"."raw_dm"
  );

[0m18:43:50.072641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:43:50.082965 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.088662 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m18:43:50.090498 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:43:50.093013 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.093374 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m18:43:50.093936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:43:50.104082 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m18:43:50.104524 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.104837 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m18:43:50.114054 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:43:50.118874 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m18:43:50.119379 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m18:43:50.122997 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:43:50.125002 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m18:43:50.126610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f2be-477e-4761-a348-fcd3ba8386aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e441ac400>]}
[0m18:43:50.127175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.12s]
[0m18:43:50.128540 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m18:43:50.129474 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:50.129732 [debug] [MainThread]: On master: BEGIN
[0m18:43:50.129931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:50.130484 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:43:50.130727 [debug] [MainThread]: On master: COMMIT
[0m18:43:50.130931 [debug] [MainThread]: Using duckdb connection "master"
[0m18:43:50.131119 [debug] [MainThread]: On master: COMMIT
[0m18:43:50.131441 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:43:50.131656 [debug] [MainThread]: On master: Close
[0m18:43:50.131970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:50.132164 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m18:43:50.132390 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m18:43:50.132604 [info ] [MainThread]: 
[0m18:43:50.133061 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:43:50.133675 [debug] [MainThread]: Command end result
[0m18:43:50.164726 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/manifest.json
[0m18:43:50.167372 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/semantic_manifest.json
[0m18:43:50.183015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/adapters/tests/odm_json/dbt/VEXIN_03/target/run_results.json
[0m18:43:50.183406 [info ] [MainThread]: 
[0m18:43:50.186816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:43:50.187195 [info ] [MainThread]: 
[0m18:43:50.187929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:43:50.189923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2713149, "process_in_blocks": "0", "process_kernel_time": 2.069012, "process_mem_max_rss": "150784", "process_out_blocks": "2816", "process_user_time": 1.260743}
[0m18:43:50.190279 [debug] [MainThread]: Command `dbt run` succeeded at 18:43:50.190203 after 2.27 seconds
[0m18:43:50.190582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e49bd7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e49916500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4995b9a0>]}
[0m18:43:50.190875 [debug] [MainThread]: Flushing usage events
[0m18:43:50.512472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:36.999056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6b2ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6a02d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6a02d240>]}


============================== 14:32:37.003238 | 33025593-c426-4e11-9df4-f7cf9f1ac659 ==============================
[0m14:32:37.003238 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:32:37.004091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:37.113150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33025593-c426-4e11-9df4-f7cf9f1ac659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69ff88b0>]}
[0m14:32:37.126979 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1975939, "process_in_blocks": "24", "process_kernel_time": 0.104542, "process_mem_max_rss": "98724", "process_out_blocks": "16", "process_user_time": 1.045427}
[0m14:32:37.127452 [debug] [MainThread]: Command `dbt clean` succeeded at 14:32:37.127371 after 0.20 seconds
[0m14:32:37.127753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d6b2ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69ffafe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d69ffb640>]}
[0m14:32:37.128079 [debug] [MainThread]: Flushing usage events
[0m14:32:37.469260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:38.836974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5c2ab5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5b0d1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5b0d14e0>]}


============================== 14:32:38.839830 | 29c0f083-2238-4420-94c7-46e5fa4afced ==============================
[0m14:32:38.839830 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:32:38.840547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:32:39.086397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5b17a320>]}
[0m14:32:39.147094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5b17b610>]}
[0m14:32:39.149101 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:32:39.267387 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:32:39.268132 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:32:39.268742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc570a9720>]}
[0m14:32:40.487902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc567dd480>]}
[0m14:32:40.573500 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:32:40.576237 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:32:40.588494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc56608f40>]}
[0m14:32:40.589067 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:32:40.589642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc567df280>]}
[0m14:32:40.591105 [info ] [MainThread]: 
[0m14:32:40.591564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:40.591929 [info ] [MainThread]: 
[0m14:32:40.592418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:32:40.593201 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:32:40.708642 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:32:40.709164 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:32:40.709543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:40.729197 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m14:32:40.730524 [debug] [ThreadPool]: On list_dev: Close
[0m14:32:40.731263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:32:40.731687 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:32:40.738659 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:32:40.739212 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:32:40.739501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:40.740541 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:32:40.741664 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:32:40.741972 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:32:40.742388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:32:40.742670 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:32:40.742919 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:32:40.743319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:32:40.744001 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:32:40.744280 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:32:40.744524 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:32:40.769965 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:32:40.770394 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:32:40.794075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:32:40.807566 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:32:40.808127 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:32:40.808462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:40.812659 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:32:40.813337 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:32:40.813700 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:32:40.826808 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:32:40.828424 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:32:40.829085 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:32:40.829432 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:32:40.831270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5663e0e0>]}
[0m14:32:40.831773 [debug] [MainThread]: Using duckdb connection "master"
[0m14:32:40.832033 [debug] [MainThread]: On master: BEGIN
[0m14:32:40.832279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:40.832875 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:32:40.833131 [debug] [MainThread]: On master: COMMIT
[0m14:32:40.833386 [debug] [MainThread]: Using duckdb connection "master"
[0m14:32:40.833602 [debug] [MainThread]: On master: COMMIT
[0m14:32:40.833981 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:32:40.834243 [debug] [MainThread]: On master: Close
[0m14:32:40.838453 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:32:40.839086 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:32:40.839857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m14:32:40.840246 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:32:40.840667 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:32:40.881012 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:32:40.882230 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:32:40.882930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:40.885390 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:32:40.887928 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:32:40.888307 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m14:32:40.889617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:32:40.901584 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:32:40.902466 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:32:40.920167 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m14:32:40.921405 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:32:40.922361 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: ROLLBACK
[0m14:32:40.939957 [debug] [Thread-1 (]: Failed to rollback 'seed.VEXIN_03.raw_dm'
[0m14:32:40.940589 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:32:40.942045 [debug] [Thread-1 (]: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:32:40.944156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29c0f083-2238-4420-94c7-46e5fa4afced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc56d9a650>]}
[0m14:32:40.944788 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.raw_dm ..................................... [[31mERROR[0m in 0.10s]
[0m14:32:40.946093 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:32:40.946771 [debug] [Thread-4 (]: Marking all children of 'seed.VEXIN_03.raw_dm' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m14:32:40.948636 [debug] [MainThread]: Using duckdb connection "master"
[0m14:32:40.949031 [debug] [MainThread]: On master: BEGIN
[0m14:32:40.949396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:40.950139 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:32:40.950501 [debug] [MainThread]: On master: COMMIT
[0m14:32:40.950839 [debug] [MainThread]: Using duckdb connection "master"
[0m14:32:40.951174 [debug] [MainThread]: On master: COMMIT
[0m14:32:40.951682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:32:40.952026 [debug] [MainThread]: On master: Close
[0m14:32:40.952555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:40.952882 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:32:40.953244 [info ] [MainThread]: 
[0m14:32:40.953785 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:32:40.954866 [debug] [MainThread]: Command end result
[0m14:32:40.981155 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:32:40.986210 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:32:40.994773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:32:40.995207 [info ] [MainThread]: 
[0m14:32:40.995828 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:40.996453 [info ] [MainThread]: 
[0m14:32:40.997133 [error] [MainThread]: [31mFailure in seed raw_dm (seeds/raw_dm.csv)[0m
[0m14:32:40.999320 [error] [MainThread]:   Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:32:41.001062 [info ] [MainThread]: 
[0m14:32:41.001640 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:32:41.002700 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.2160642, "process_in_blocks": "1456", "process_kernel_time": 0.44609, "process_mem_max_rss": "157696", "process_out_blocks": "2752", "process_user_time": 2.587327}
[0m14:32:41.003154 [debug] [MainThread]: Command `dbt seed` failed at 14:32:41.003062 after 2.22 seconds
[0m14:32:41.003544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5c2ab5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc5dbdc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cc56d97760>]}
[0m14:32:41.003905 [debug] [MainThread]: Flushing usage events
[0m14:32:41.334026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:16.679764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03d3b7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03c1312a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03c131240>]}


============================== 14:36:16.682278 | 58b2b9a7-682d-4f84-9ffb-36503f111bef ==============================
[0m14:36:16.682278 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:36:16.682970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:16.798067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b2b9a7-682d-4f84-9ffb-36503f111bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03c1008b0>]}
[0m14:36:16.808594 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17796998, "process_in_blocks": "0", "process_kernel_time": 0.186418, "process_mem_max_rss": "98728", "process_out_blocks": "8", "process_user_time": 1.008354}
[0m14:36:16.809013 [debug] [MainThread]: Command `dbt clean` succeeded at 14:36:16.808934 after 0.18 seconds
[0m14:36:16.809368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03d3b7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03c103a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea03c102fe0>]}
[0m14:36:16.809665 [debug] [MainThread]: Flushing usage events
[0m14:36:17.168618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:18.821844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b145b75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1333d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1333d510>]}


============================== 14:36:18.824565 | f2cbd279-61a9-4dc5-b013-d1d5a78a2840 ==============================
[0m14:36:18.824565 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:36:18.825278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:19.010621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b132fe200>]}
[0m14:36:19.062002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b1333f130>]}
[0m14:36:19.063697 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:36:19.185105 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:36:19.185846 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:36:19.186399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0f3e23e0>]}
[0m14:36:20.320463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0e939450>]}
[0m14:36:20.399939 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:36:20.402911 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:36:20.415221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0e926380>]}
[0m14:36:20.415786 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:36:20.416411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0e938d60>]}
[0m14:36:20.417813 [info ] [MainThread]: 
[0m14:36:20.418261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:20.418614 [info ] [MainThread]: 
[0m14:36:20.419118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:36:20.419877 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:36:20.516920 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:36:20.517586 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:36:20.517998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:20.535166 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:36:20.536902 [debug] [ThreadPool]: On list_dev: Close
[0m14:36:20.537785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:36:20.538346 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:36:20.544784 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:36:20.545354 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:36:20.545841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:20.547452 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:36:20.548615 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:36:20.548936 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:36:20.549334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:36:20.549569 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:36:20.549765 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:36:20.550165 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:36:20.550781 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:36:20.551056 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:36:20.551259 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:36:20.551623 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:36:20.551875 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:36:20.557730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:36:20.562399 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:36:20.562815 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:36:20.563170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:20.563855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:36:20.564141 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:36:20.564408 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:36:20.579260 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:36:20.582136 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:36:20.582923 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:36:20.583281 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:36:20.584970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0e927e50>]}
[0m14:36:20.585607 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:20.586006 [debug] [MainThread]: On master: BEGIN
[0m14:36:20.586267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:36:20.586911 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:36:20.587307 [debug] [MainThread]: On master: COMMIT
[0m14:36:20.587962 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:20.588249 [debug] [MainThread]: On master: COMMIT
[0m14:36:20.588768 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:36:20.589111 [debug] [MainThread]: On master: Close
[0m14:36:20.591037 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:36:20.591793 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:36:20.592671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m14:36:20.593117 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:36:20.593541 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:36:20.632637 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:36:20.634215 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:36:20.634924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:20.636834 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:36:20.637146 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:36:20.637420 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m14:36:20.638212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:36:20.648316 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:36:20.649100 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:36:20.653114 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m14:36:20.653538 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:36:20.654102 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: ROLLBACK
[0m14:36:20.655547 [debug] [Thread-1 (]: Failed to rollback 'seed.VEXIN_03.raw_dm'
[0m14:36:20.655913 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:36:20.657058 [debug] [Thread-1 (]: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:36:20.658513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cbd279-61a9-4dc5-b013-d1d5a78a2840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0ef9aad0>]}
[0m14:36:20.659084 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.raw_dm ..................................... [[31mERROR[0m in 0.06s]
[0m14:36:20.660243 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:36:20.660811 [debug] [Thread-4 (]: Marking all children of 'seed.VEXIN_03.raw_dm' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m14:36:20.662291 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:20.662675 [debug] [MainThread]: On master: BEGIN
[0m14:36:20.663132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:20.663822 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:36:20.664103 [debug] [MainThread]: On master: COMMIT
[0m14:36:20.664366 [debug] [MainThread]: Using duckdb connection "master"
[0m14:36:20.664648 [debug] [MainThread]: On master: COMMIT
[0m14:36:20.665045 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:36:20.665338 [debug] [MainThread]: On master: Close
[0m14:36:20.665797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:20.666054 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:36:20.666317 [info ] [MainThread]: 
[0m14:36:20.667176 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:36:20.667889 [debug] [MainThread]: Command end result
[0m14:36:20.695735 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:36:20.700609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:36:20.707942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:36:20.708570 [info ] [MainThread]: 
[0m14:36:20.713603 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:20.717676 [info ] [MainThread]: 
[0m14:36:20.720577 [error] [MainThread]: [31mFailure in seed raw_dm (seeds/raw_dm.csv)[0m
[0m14:36:20.721118 [error] [MainThread]:   Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 22. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:36:20.723226 [info ] [MainThread]: 
[0m14:36:20.724548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:36:20.728896 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.9627838, "process_in_blocks": "8", "process_kernel_time": 0.29394, "process_mem_max_rss": "157688", "process_out_blocks": "2744", "process_user_time": 2.705982}
[0m14:36:20.734580 [debug] [MainThread]: Command `dbt seed` failed at 14:36:20.734271 after 1.97 seconds
[0m14:36:20.738829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b145b75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0ef74a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5b0ef74f40>]}
[0m14:36:20.739382 [debug] [MainThread]: Flushing usage events
[0m14:36:21.091161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:41.002554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786a00a97580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869ff8bd2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869ff8bd240>]}


============================== 14:37:41.004823 | 4948f4b3-e7b4-4ec7-9a5b-a019c65bc3ac ==============================
[0m14:37:41.004823 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:37:41.005479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:41.114781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4948f4b3-e7b4-4ec7-9a5b-a019c65bc3ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869ff8888b0>]}
[0m14:37:41.125523 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16768171, "process_in_blocks": "0", "process_kernel_time": 0.1561, "process_mem_max_rss": "98720", "process_out_blocks": "8", "process_user_time": 1.031998}
[0m14:37:41.125975 [debug] [MainThread]: Command `dbt clean` succeeded at 14:37:41.125895 after 0.17 seconds
[0m14:37:41.126358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786a00a97580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869ff88afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7869ff88b640>]}
[0m14:37:41.127280 [debug] [MainThread]: Flushing usage events
[0m14:37:41.498684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:46.551687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92b4ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92a2315d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92a231570>]}


============================== 14:37:46.553995 | 80495ee0-0182-4b5b-b6cd-2c269dc5bfcc ==============================
[0m14:37:46.553995 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:37:46.554673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:46.762104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da926326320>]}
[0m14:37:46.819646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da926327610>]}
[0m14:37:46.822220 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:37:46.941588 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:37:46.943072 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:37:46.944867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da9262d5720>]}
[0m14:37:48.076864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da925831480>]}
[0m14:37:48.222722 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:37:48.224543 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:37:48.235501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92580cf40>]}
[0m14:37:48.236071 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:37:48.236720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da925833280>]}
[0m14:37:48.238207 [info ] [MainThread]: 
[0m14:37:48.238707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:48.239088 [info ] [MainThread]: 
[0m14:37:48.239635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:37:48.240451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:37:48.355312 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:37:48.355859 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:37:48.356263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:48.368615 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:37:48.370301 [debug] [ThreadPool]: On list_dev: Close
[0m14:37:48.371083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:37:48.371564 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:37:48.378389 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:37:48.378800 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:37:48.379128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:48.380949 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:37:48.382152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:37:48.382492 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:37:48.382961 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:37:48.383220 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:37:48.383458 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:37:48.383918 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:37:48.384629 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:37:48.384913 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:37:48.385161 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:37:48.385529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:37:48.385812 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:37:48.392958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:37:48.400300 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:37:48.400779 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:37:48.401136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:48.402069 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:37:48.403296 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:37:48.403688 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:37:48.412359 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:37:48.413779 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:37:48.414423 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:37:48.414746 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:37:48.415991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92586a0e0>]}
[0m14:37:48.416416 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:48.416685 [debug] [MainThread]: On master: BEGIN
[0m14:37:48.417014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:48.417523 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:48.417810 [debug] [MainThread]: On master: COMMIT
[0m14:37:48.418065 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:48.418303 [debug] [MainThread]: On master: COMMIT
[0m14:37:48.418665 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:48.418976 [debug] [MainThread]: On master: Close
[0m14:37:48.420714 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:37:48.421218 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:37:48.421977 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.VEXIN_03.raw_dm'
[0m14:37:48.422392 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:37:48.423112 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:37:48.461742 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:37:48.462491 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:37:48.463210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:48.464831 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:37:48.465258 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:37:48.465578 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m14:37:48.468144 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:37:48.481031 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:37:48.481830 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:37:48.484926 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m14:37:48.485378 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:37:48.485892 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: ROLLBACK
[0m14:37:48.487979 [debug] [Thread-1 (]: Failed to rollback 'seed.VEXIN_03.raw_dm'
[0m14:37:48.488357 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:37:48.489649 [debug] [Thread-1 (]: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:37:48.491253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80495ee0-0182-4b5b-b6cd-2c269dc5bfcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da925fa6230>]}
[0m14:37:48.491882 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.raw_dm ..................................... [[31mERROR[0m in 0.07s]
[0m14:37:48.492667 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:37:48.493202 [debug] [Thread-4 (]: Marking all children of 'seed.VEXIN_03.raw_dm' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m14:37:48.494597 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:48.494943 [debug] [MainThread]: On master: BEGIN
[0m14:37:48.495238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:48.496050 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:37:48.496381 [debug] [MainThread]: On master: COMMIT
[0m14:37:48.496696 [debug] [MainThread]: Using duckdb connection "master"
[0m14:37:48.496977 [debug] [MainThread]: On master: COMMIT
[0m14:37:48.497414 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:37:48.498631 [debug] [MainThread]: On master: Close
[0m14:37:48.501057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:48.501573 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:37:48.503190 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:37:48.503643 [info ] [MainThread]: 
[0m14:37:48.504186 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:37:48.505036 [debug] [MainThread]: Command end result
[0m14:37:48.539884 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:37:48.542506 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:37:48.548486 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:37:48.548912 [info ] [MainThread]: 
[0m14:37:48.549627 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:37:48.550026 [info ] [MainThread]: 
[0m14:37:48.550433 [error] [MainThread]: [31mFailure in seed raw_dm (seeds/raw_dm.csv)[0m
[0m14:37:48.551418 [error] [MainThread]:   Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:37:48.552041 [info ] [MainThread]: 
[0m14:37:48.552404 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:37:48.553203 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.0467587, "process_in_blocks": "0", "process_kernel_time": 0.302988, "process_mem_max_rss": "157544", "process_out_blocks": "2752", "process_user_time": 2.55857}
[0m14:37:48.553607 [debug] [MainThread]: Command `dbt seed` failed at 14:37:48.553530 after 2.05 seconds
[0m14:37:48.553897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92b4ab5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92a3cb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da92a3cb130>]}
[0m14:37:48.554178 [debug] [MainThread]: Flushing usage events
[0m14:37:48.900049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:22.996706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cd7b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cc539390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cc539330>]}


============================== 14:42:22.999046 | 71e357da-a88b-45dc-a9ac-4afcebaa61ec ==============================
[0m14:42:22.999046 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:42:22.999715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:23.118777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e357da-a88b-45dc-a9ac-4afcebaa61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122ced822f0>]}
[0m14:42:23.130701 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18301502, "process_in_blocks": "0", "process_kernel_time": 0.126753, "process_mem_max_rss": "98720", "process_out_blocks": "16", "process_user_time": 1.123878}
[0m14:42:23.131199 [debug] [MainThread]: Command `dbt clean` succeeded at 14:42:23.131111 after 0.18 seconds
[0m14:42:23.131574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cd7b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cc531780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7122cc530940>]}
[0m14:42:23.131979 [debug] [MainThread]: Flushing usage events
[0m14:42:23.471808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:26.041897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d669b7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d65735420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d657353c0>]}


============================== 14:42:26.044790 | 9e81ef90-74a0-4534-833f-7d8d1d22d31b ==============================
[0m14:42:26.044790 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:42:26.045587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:42:26.227036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d65efd990>]}
[0m14:42:26.278126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d656fed40>]}
[0m14:42:26.279900 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:42:26.367132 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:42:26.367693 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:42:26.368926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d617e3f10>]}
[0m14:42:27.627261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d60d60130>]}
[0m14:42:27.727982 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:42:27.729643 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:42:27.748993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d60da2c80>]}
[0m14:42:27.749771 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:42:27.752069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d6738a860>]}
[0m14:42:27.753598 [info ] [MainThread]: 
[0m14:42:27.754057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:27.754404 [info ] [MainThread]: 
[0m14:42:27.755459 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:42:27.756227 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:42:27.846845 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:42:27.847335 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:42:27.847674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:27.859633 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:42:27.861246 [debug] [ThreadPool]: On list_dev: Close
[0m14:42:27.861943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:42:27.862367 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:42:27.867980 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:42:27.868348 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:42:27.868618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:27.869439 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:42:27.870350 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:42:27.870612 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:42:27.870967 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:42:27.871714 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:42:27.871976 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:42:27.872525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:42:27.873242 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:42:27.873536 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:42:27.873752 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:42:27.874098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:42:27.874337 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:42:27.879180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:42:27.884114 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:42:27.884520 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:42:27.884814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:27.885396 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:42:27.885695 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:42:27.885966 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:42:27.894649 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:42:27.895831 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:42:27.896387 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:42:27.896677 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:42:27.897759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d60d0e230>]}
[0m14:42:27.898153 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:27.898383 [debug] [MainThread]: On master: BEGIN
[0m14:42:27.898589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:27.899059 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:42:27.899305 [debug] [MainThread]: On master: COMMIT
[0m14:42:27.899524 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:27.899727 [debug] [MainThread]: On master: COMMIT
[0m14:42:27.900123 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:42:27.900351 [debug] [MainThread]: On master: Close
[0m14:42:27.901902 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:42:27.902319 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:42:27.904207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now seed.VEXIN_03.raw_dm)
[0m14:42:27.904837 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:42:27.905365 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:42:27.930735 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:42:27.931279 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:42:27.931626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:27.932368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:42:27.932699 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:42:27.933019 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m14:42:27.934162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:42:27.942588 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:42:27.942967 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:42:27.946075 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m14:42:27.946584 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:42:27.947050 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: ROLLBACK
[0m14:42:27.948523 [debug] [Thread-1 (]: Failed to rollback 'seed.VEXIN_03.raw_dm'
[0m14:42:27.948854 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:42:27.949863 [debug] [Thread-1 (]: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:42:27.951358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e81ef90-74a0-4534-833f-7d8d1d22d31b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d61374e80>]}
[0m14:42:27.951905 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.raw_dm ..................................... [[31mERROR[0m in 0.05s]
[0m14:42:27.952654 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:42:27.953158 [debug] [Thread-4 (]: Marking all children of 'seed.VEXIN_03.raw_dm' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m14:42:27.954492 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:27.955722 [debug] [MainThread]: On master: BEGIN
[0m14:42:27.956052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:27.956833 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:42:27.957193 [debug] [MainThread]: On master: COMMIT
[0m14:42:27.957472 [debug] [MainThread]: Using duckdb connection "master"
[0m14:42:27.957770 [debug] [MainThread]: On master: COMMIT
[0m14:42:27.958264 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:42:27.958592 [debug] [MainThread]: On master: Close
[0m14:42:27.959226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:27.959525 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:42:27.959758 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m14:42:27.960025 [info ] [MainThread]: 
[0m14:42:27.960892 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:42:27.962210 [debug] [MainThread]: Command end result
[0m14:42:27.992003 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:42:27.994906 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:42:28.002482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:42:28.002929 [info ] [MainThread]: 
[0m14:42:28.003521 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:42:28.003919 [info ] [MainThread]: 
[0m14:42:28.004301 [error] [MainThread]: [31mFailure in seed raw_dm (seeds/raw_dm.csv)[0m
[0m14:42:28.004728 [error] [MainThread]:   Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:42:28.005472 [info ] [MainThread]: 
[0m14:42:28.005801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:42:28.006634 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.0240827, "process_in_blocks": "0", "process_kernel_time": 0.334361, "process_mem_max_rss": "157684", "process_out_blocks": "2752", "process_user_time": 2.760624}
[0m14:42:28.007020 [debug] [MainThread]: Command `dbt seed` failed at 14:42:28.006941 after 2.02 seconds
[0m14:42:28.007368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d669b7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d69707f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7d67d6f610>]}
[0m14:42:28.007709 [debug] [MainThread]: Flushing usage events
[0m14:42:28.359282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:19.243738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ae9d3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ad751270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ad751210>]}


============================== 14:43:19.246374 | d49fc6c9-2734-4f2f-898b-9e8548e722e1 ==============================
[0m14:43:19.246374 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:43:19.247043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:43:19.248086 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'seeds' in "<unicode string>", line 42, column 1 in file
`/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/dbt_project.yml`
[0m14:43:19.248612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd49fc6c9-2734-4f2f-898b-9e8548e722e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ad751990>]}
[0m14:43:19.368628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd49fc6c9-2734-4f2f-898b-9e8548e722e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209b002e2f0>]}
[0m14:43:19.380096 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:43:19.381099 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18569584, "process_in_blocks": "0", "process_kernel_time": 0.018345, "process_mem_max_rss": "98856", "process_out_blocks": "16", "process_user_time": 1.184749}
[0m14:43:19.382078 [debug] [MainThread]: Command `dbt clean` succeeded at 14:43:19.381491 after 0.19 seconds
[0m14:43:19.382879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ae9d3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209b002e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7209ad74ae60>]}
[0m14:43:19.383349 [debug] [MainThread]: Flushing usage events
[0m14:43:19.729186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:32.623412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00feb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00ec352a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00ec35240>]}


============================== 14:43:32.626006 | 2b56336b-f3d4-448a-bc0c-75be60836f4f ==============================
[0m14:43:32.626006 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:43:32.626754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:32.740229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b56336b-f3d4-448a-bc0c-75be60836f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00ec35390>]}
[0m14:43:32.749009 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18199657, "process_in_blocks": "0", "process_kernel_time": 0.154369, "process_mem_max_rss": "98708", "process_out_blocks": "8", "process_user_time": 1.207716}
[0m14:43:32.749490 [debug] [MainThread]: Command `dbt clean` succeeded at 14:43:32.749404 after 0.18 seconds
[0m14:43:32.749884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00feb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00ec35390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d00ec35ab0>]}
[0m14:43:32.750251 [debug] [MainThread]: Flushing usage events
[0m14:43:33.083605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:36.590543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982b9af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982a734280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982a734220>]}


============================== 14:43:36.593143 | d68703fd-5616-4a24-a130-951d8358b073 ==============================
[0m14:43:36.593143 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:43:36.593796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:43:36.776316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982afc3b50>]}
[0m14:43:36.829837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982a95d540>]}
[0m14:43:36.831424 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:43:36.945263 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:43:36.947748 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:43:36.949416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398267e0700>]}
[0m14:43:38.334066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739825d58130>]}
[0m14:43:38.452323 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:43:38.454523 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:43:38.465604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739825da6cb0>]}
[0m14:43:38.466157 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:43:38.466765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982c352920>]}
[0m14:43:38.468685 [info ] [MainThread]: 
[0m14:43:38.469434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:38.470892 [info ] [MainThread]: 
[0m14:43:38.471635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:43:38.472788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:43:38.567854 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:43:38.568374 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:43:38.568714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:38.580543 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:43:38.581900 [debug] [ThreadPool]: On list_dev: Close
[0m14:43:38.582690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:43:38.583171 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:43:38.589946 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:38.590337 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:43:38.590707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:38.591596 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:43:38.592674 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:38.592976 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:43:38.593395 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:43:38.593708 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:38.593975 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:43:38.594373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:43:38.595082 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:43:38.595389 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:43:38.595719 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:43:38.596101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:43:38.596397 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:43:38.602277 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:43:38.607417 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:43:38.607725 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:43:38.607971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:38.608560 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:43:38.608825 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:43:38.609068 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:43:38.617539 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m14:43:38.618878 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:43:38.619412 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:43:38.619719 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:43:38.627304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739825d3d270>]}
[0m14:43:38.628052 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:38.628415 [debug] [MainThread]: On master: BEGIN
[0m14:43:38.628666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:38.629459 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:43:38.629741 [debug] [MainThread]: On master: COMMIT
[0m14:43:38.629975 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:38.630248 [debug] [MainThread]: On master: COMMIT
[0m14:43:38.630660 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:43:38.630931 [debug] [MainThread]: On master: Close
[0m14:43:38.634029 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:43:38.634613 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:43:38.635331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m14:43:38.635644 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:43:38.635951 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:43:38.658841 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:43:38.659348 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:43:38.659672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:38.660365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:43:38.660680 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:43:38.660957 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */
truncate table "dev"."main"."raw_dm"
[0m14:43:38.661647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:43:38.669822 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:43:38.670218 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:43:38.675415 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m14:43:38.675939 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:43:38.676361 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: ROLLBACK
[0m14:43:38.680425 [debug] [Thread-1 (]: Failed to rollback 'seed.VEXIN_03.raw_dm'
[0m14:43:38.680746 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:43:38.681780 [debug] [Thread-1 (]: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:43:38.683116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd68703fd-5616-4a24-a130-951d8358b073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739825fcd5a0>]}
[0m14:43:38.683594 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.raw_dm ..................................... [[31mERROR[0m in 0.05s]
[0m14:43:38.685324 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:43:38.685894 [debug] [Thread-4 (]: Marking all children of 'seed.VEXIN_03.raw_dm' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m14:43:38.687566 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:38.688242 [debug] [MainThread]: On master: BEGIN
[0m14:43:38.688588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:38.689229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:43:38.689512 [debug] [MainThread]: On master: COMMIT
[0m14:43:38.689771 [debug] [MainThread]: Using duckdb connection "master"
[0m14:43:38.690013 [debug] [MainThread]: On master: COMMIT
[0m14:43:38.690630 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:43:38.691095 [debug] [MainThread]: On master: Close
[0m14:43:38.692028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:38.692578 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m14:43:38.692971 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:43:38.693382 [info ] [MainThread]: 
[0m14:43:38.695625 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:43:38.697809 [debug] [MainThread]: Command end result
[0m14:43:38.724995 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:43:38.727406 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:43:38.733304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:43:38.733694 [info ] [MainThread]: 
[0m14:43:38.734277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:43:38.734662 [info ] [MainThread]: 
[0m14:43:38.735092 [error] [MainThread]: [31mFailure in seed raw_dm (seeds/raw_dm.csv)[0m
[0m14:43:38.735515 [error] [MainThread]:   Runtime Error in seed raw_dm (seeds/raw_dm.csv)
  Invalid Input Error: Error when sniffing file "/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv".
  It was not possible to automatically detect the CSV Parsing dialect/types
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'PROJECT' : 'VARCHAR', 'STUDYID' : 'VARCHAR', 'DOMAIN' : 'VARCHAR', 'SITEID' : 'VARCHAR', 'SUBJECT' : 'VARCHAR', 'SUBJID' : 'INTEGER', 'RESCREENNUM_RAW' : 'VARCHAR', 'PREVSTUDY' : 'VARCHAR', 'PREVSUBJ' : 'VARCHAR', 'RFICDTC' : 'VARCHAR', 'BRTHDTC_RAW' : 'VARCHAR', 'SEX' : 'VARCHAR', 'RACE' : 'VARCHAR', 'RACE_WHITE' : 'INTEGER', 'RACE_BLACK' : 'INTEGER', 'RACE_ASIAN' : 'INTEGER', 'RACE_NHPI' : 'INTEGER', 'RACE_AIAN' : 'INTEGER', 'RACE_OTHER' : 'INTEGER', 'RACEOTH' : 'VARCHAR', 'ETHNIC' : 'VARCHAR', 'COUNTRY' : 'VARCHAR', 'DMDTC_RAW' : 'VARCHAR'}", and they contain: 23 columns. It does not match the number of columns found by the sniffer: 24. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m14:43:38.735945 [info ] [MainThread]: 
[0m14:43:38.736327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:43:38.737172 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.195145, "process_in_blocks": "0", "process_kernel_time": 0.205252, "process_mem_max_rss": "157532", "process_out_blocks": "2752", "process_user_time": 2.855688}
[0m14:43:38.737562 [debug] [MainThread]: Command `dbt seed` failed at 14:43:38.737482 after 2.20 seconds
[0m14:43:38.738277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982b9af5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982a8d30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73982a8d3100>]}
[0m14:43:38.738761 [debug] [MainThread]: Flushing usage events
[0m14:43:39.069122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:56.780022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033580ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703356e28220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703356e281c0>]}


============================== 14:44:56.782504 | e5d3e414-b696-4914-b75f-a20f7b1e4573 ==============================
[0m14:44:56.782504 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:44:56.783215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:44:56.899834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d3e414-b696-4914-b75f-a20f7b1e4573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703357f18430>]}
[0m14:44:56.912327 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18184227, "process_in_blocks": "0", "process_kernel_time": 0.095711, "process_mem_max_rss": "98712", "process_out_blocks": "8", "process_user_time": 1.148534}
[0m14:44:56.913381 [debug] [MainThread]: Command `dbt clean` succeeded at 14:44:56.912757 after 0.18 seconds
[0m14:44:56.914116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7033580ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703357f18430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703356d80520>]}
[0m14:44:56.914536 [debug] [MainThread]: Flushing usage events
[0m14:44:57.259940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:13.829518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a65bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a533d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a533d3c0>]}


============================== 14:45:13.831914 | e6f6457c-1046-476b-8415-5b0c7b08f16c ==============================
[0m14:45:13.831914 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:45:13.832628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:45:14.030713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a5b01990>]}
[0m14:45:14.082603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a52fed40>]}
[0m14:45:14.084508 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:45:14.178193 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:45:14.178891 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:45:14.181301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a13ebf10>]}
[0m14:45:15.432754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a0964130>]}
[0m14:45:15.515839 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:45:15.523203 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:45:15.535357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a09a6c80>]}
[0m14:45:15.535881 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:45:15.536425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a6f8e860>]}
[0m14:45:15.537762 [info ] [MainThread]: 
[0m14:45:15.538693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:15.539026 [info ] [MainThread]: 
[0m14:45:15.539482 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:15.540220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:45:15.637668 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:45:15.638266 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:45:15.638694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:15.655686 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:45:15.658048 [debug] [ThreadPool]: On list_dev: Close
[0m14:45:15.659405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:45:15.660295 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:45:15.671365 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:15.672226 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:45:15.672796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:15.674309 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:15.676384 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:15.676871 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:45:15.677535 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:15.678043 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:15.678530 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:45:15.679236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:15.680876 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:45:15.681246 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:15.681517 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:45:15.681956 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:15.682221 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:45:15.688786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:45:15.693430 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:45:15.693850 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:45:15.694084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:15.694737 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:15.695013 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:45:15.695240 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:45:15.712102 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:45:15.713651 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:45:15.714252 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:45:15.714609 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:45:15.715292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a0a48730>]}
[0m14:45:15.715762 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:15.716016 [debug] [MainThread]: On master: BEGIN
[0m14:45:15.716247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:15.716928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:15.717218 [debug] [MainThread]: On master: COMMIT
[0m14:45:15.718316 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:15.718976 [debug] [MainThread]: On master: COMMIT
[0m14:45:15.719633 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:15.720055 [debug] [MainThread]: On master: Close
[0m14:45:15.722123 [debug] [Thread-1 (]: Began running node seed.VEXIN_03.raw_dm
[0m14:45:15.722838 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_dm ............................................. [RUN]
[0m14:45:15.723676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.VEXIN_03.raw_dm)
[0m14:45:15.724070 [debug] [Thread-1 (]: Began compiling node seed.VEXIN_03.raw_dm
[0m14:45:15.724463 [debug] [Thread-1 (]: Began executing node seed.VEXIN_03.raw_dm
[0m14:45:15.752235 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:45:15.752925 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: BEGIN
[0m14:45:15.753430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:15.754364 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:15.754708 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:45:15.754998 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "seed.VEXIN_03.raw_dm"} */

    create table "dev"."main"."raw_dm" ("PROJECT" text,"STUDYID" text,"DOMAIN" text,"DATAPAGENAME" text,"RECORDID" integer,"SITEID" text,"SUBJECT" text,"RESCREENNUM_RAW" text,"PREVSTUDY" text,"PREVSUBJ" text,"RFICDTC_RAW" text,"BRTHDTC_RAW" text,"SEX" text,"RACE" text,"RACE_WHITE" integer,"RACE_BLACK" integer,"RACE_ASIAN" integer,"RACE_NHPI" integer,"RACE_AIAN" integer,"RACE_OTHER" integer,"RACEOTH" text,"ETHNIC" text,"COUNTRY" text,"DMDTC_RAW" text)
  
[0m14:45:15.755791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:15.767381 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:45:15.768228 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: 
          COPY "dev"."main"."raw_dm" FROM '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/seeds/raw_dm.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:45:15.782457 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m14:45:15.787283 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.VEXIN_03.raw_dm"
[0m14:45:15.799385 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m14:45:15.800123 [debug] [Thread-1 (]: Using duckdb connection "seed.VEXIN_03.raw_dm"
[0m14:45:15.800479 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: COMMIT
[0m14:45:15.808650 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:45:15.810795 [debug] [Thread-1 (]: On seed.VEXIN_03.raw_dm: Close
[0m14:45:15.812616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f6457c-1046-476b-8415-5b0c7b08f16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a0b49cc0>]}
[0m14:45:15.813711 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_dm ......................................... [[32mINSERT 40[0m in 0.09s]
[0m14:45:15.816378 [debug] [Thread-1 (]: Finished running node seed.VEXIN_03.raw_dm
[0m14:45:15.817522 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:15.817842 [debug] [MainThread]: On master: BEGIN
[0m14:45:15.818060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:15.818641 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:15.818870 [debug] [MainThread]: On master: COMMIT
[0m14:45:15.819076 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:15.819269 [debug] [MainThread]: On master: COMMIT
[0m14:45:15.819660 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:15.819886 [debug] [MainThread]: On master: Close
[0m14:45:15.820232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:15.820433 [debug] [MainThread]: Connection 'seed.VEXIN_03.raw_dm' was properly closed.
[0m14:45:15.820673 [info ] [MainThread]: 
[0m14:45:15.821156 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:45:15.821807 [debug] [MainThread]: Command end result
[0m14:45:15.842428 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:45:15.844821 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:45:15.850284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:45:15.850624 [info ] [MainThread]: 
[0m14:45:15.851213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:15.851624 [info ] [MainThread]: 
[0m14:45:15.852011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:45:15.852799 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.0715723, "process_in_blocks": "0", "process_kernel_time": 0.340295, "process_mem_max_rss": "155792", "process_out_blocks": "2776", "process_user_time": 2.622767}
[0m14:45:15.853224 [debug] [MainThread]: Command `dbt seed` succeeded at 14:45:15.853142 after 2.07 seconds
[0m14:45:15.853565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a65bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a0b9f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d26a0b9d5d0>]}
[0m14:45:15.853931 [debug] [MainThread]: Flushing usage events
[0m14:45:16.198334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:25.704836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f27b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f153d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f153d420>]}


============================== 14:45:25.707293 | 60b69dbc-ee80-490a-9111-6440553d3121 ==============================
[0m14:45:25.707293 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:45:25.709220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:45:25.913959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f13f7b50>]}
[0m14:45:25.974913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f14fdf90>]}
[0m14:45:25.976663 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:45:26.077217 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:45:26.195298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:26.195858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:26.246779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ed15da80>]}
[0m14:45:26.325215 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:45:26.329006 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:45:26.340192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ed15d7b0>]}
[0m14:45:26.340734 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m14:45:26.341310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ed15d840>]}
[0m14:45:26.342729 [info ] [MainThread]: 
[0m14:45:26.343207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:26.343548 [info ] [MainThread]: 
[0m14:45:26.344247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:26.348513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:45:26.438371 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:45:26.443528 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:45:26.443832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:26.456319 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:45:26.457834 [debug] [ThreadPool]: On list_dev: Close
[0m14:45:26.458832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:45:26.459346 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:45:26.466748 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:26.467323 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:45:26.467689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:26.468867 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:26.470351 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:26.470710 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:45:26.471233 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:26.471540 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:26.471813 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:45:26.472495 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:26.473293 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:45:26.473640 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:45:26.473952 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:45:26.474442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:26.474755 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:45:26.476174 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m14:45:26.481957 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:45:26.482438 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:45:26.482757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:26.483507 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:26.483817 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:45:26.484121 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:45:26.493390 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:45:26.494808 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:45:26.495331 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:45:26.495662 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:45:26.496464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f3eaf160>]}
[0m14:45:26.496983 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:26.497520 [debug] [MainThread]: On master: BEGIN
[0m14:45:26.497925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:26.498806 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:26.499180 [debug] [MainThread]: On master: COMMIT
[0m14:45:26.499536 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:26.499940 [debug] [MainThread]: On master: COMMIT
[0m14:45:26.500501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:26.500816 [debug] [MainThread]: On master: Close
[0m14:45:26.506028 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m14:45:26.506738 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:45:26.507468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m14:45:26.508017 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m14:45:26.517212 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.518237 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m14:45:26.548107 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.549128 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.549587 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m14:45:26.549926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:26.550708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:26.551016 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.551327 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:45:26.552179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:26.559327 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.560368 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:45:26.562220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:26.578509 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m14:45:26.579137 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.579832 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m14:45:26.586292 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:45:26.592576 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m14:45:26.593075 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m14:45:26.593814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:26.596296 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m14:45:26.598554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f3dcb6a0>]}
[0m14:45:26.599213 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m14:45:26.599972 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m14:45:26.600390 [debug] [Thread-1 (]: Began running node model.VEXIN_03.scaffold_dm
[0m14:45:26.600998 [info ] [Thread-1 (]: 2 of 3 START sql view model main.scaffold_dm ................................... [RUN]
[0m14:45:26.601595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.scaffold_dm)
[0m14:45:26.601951 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.scaffold_dm
[0m14:45:26.606707 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.scaffold_dm"
[0m14:45:26.608990 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.scaffold_dm
[0m14:45:26.633051 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.scaffold_dm"
[0m14:45:26.634079 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m14:45:26.634513 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: BEGIN
[0m14:45:26.634831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:26.635587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:26.635935 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m14:45:26.636375 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
        WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
            CASE
                WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                    -- ERROR: prevstudy is null but prevsubj is not
                    NULL
                WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                    CONCAT(project, '-', rescreennum_raw)
                ELSE
                    CONCAT(project, '-', subject)
            END
        ELSE
            CASE
                WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                    -- ERROR: prevstudy not null but prevsubj is null
                    NULL
                ELSE
                    CONCAT(prevstudy, '-', prevsubj)
            END
        END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m14:45:26.638077 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
        WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
            CASE
                WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                    -- ERROR: prevstudy is null but prevsubj is not
                    NULL
                WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                    CONCAT(project, '-', rescreennum_raw)
                ELSE
                    CONCAT(project, '-', subject)
            END
        ELSE
            CASE
                WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                    -- ERROR: prevstudy not null but prevsubj is null
                    NULL
                ELSE
                    CONCAT(prevstudy, '-', prevsubj)
            END
        END AS USUBJID
    ,raw_dm.subjid AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m14:45:26.638550 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:45:26.639744 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: ROLLBACK
[0m14:45:26.641330 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.scaffold_dm'
[0m14:45:26.641784 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: Close
[0m14:45:26.642713 [debug] [Thread-1 (]: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "subjid"
  
  Candidate bindings: : "SUBJECT"
  
  LINE 35:     ,raw_dm.subjid AS SUBJID
                ^
[0m14:45:26.643242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f1447c10>]}
[0m14:45:26.643928 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.scaffold_dm .......................... [[31mERROR[0m in 0.04s]
[0m14:45:26.644677 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.scaffold_dm
[0m14:45:26.645070 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m14:45:26.645510 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.scaffold_dm' to be skipped because of status 'error'.  Reason: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "subjid"
  
  Candidate bindings: : "SUBJECT"
  
  LINE 35:     ,raw_dm.subjid AS SUBJID
                ^.
[0m14:45:26.646103 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:45:26.648450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.scaffold_dm, now model.VEXIN_03.my_second_dbt_model)
[0m14:45:26.648888 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m14:45:26.653530 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.654190 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m14:45:26.656698 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.657171 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.657446 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m14:45:26.657681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:26.658354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:26.658607 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.658848 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:45:26.659477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:26.662771 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.663190 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:45:26.663849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:26.664855 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m14:45:26.665233 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.665529 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m14:45:26.668607 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:45:26.673976 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m14:45:26.674531 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m14:45:26.675315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:26.676500 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m14:45:26.677184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60b69dbc-ee80-490a-9111-6440553d3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ec097250>]}
[0m14:45:26.677779 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m14:45:26.678418 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m14:45:26.679794 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:26.682290 [debug] [MainThread]: On master: BEGIN
[0m14:45:26.682696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:26.683394 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:26.683775 [debug] [MainThread]: On master: COMMIT
[0m14:45:26.684102 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:26.684396 [debug] [MainThread]: On master: COMMIT
[0m14:45:26.685147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:26.685586 [debug] [MainThread]: On master: Close
[0m14:45:26.686171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:26.686569 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m14:45:26.686804 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m14:45:26.687127 [info ] [MainThread]: 
[0m14:45:26.687933 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:45:26.688840 [debug] [MainThread]: Command end result
[0m14:45:26.719308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m14:45:26.722748 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m14:45:26.736072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m14:45:26.736677 [info ] [MainThread]: 
[0m14:45:26.737925 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:45:26.739857 [info ] [MainThread]: 
[0m14:45:26.740456 [error] [MainThread]: [31mFailure in model scaffold_dm (models/sdtm/scaffold_dm.sql)[0m
[0m14:45:26.740932 [error] [MainThread]:   Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Table "raw_dm" does not have a column named "subjid"
  
  Candidate bindings: : "SUBJECT"
  
  LINE 35:     ,raw_dm.subjid AS SUBJID
                ^
[0m14:45:26.741347 [info ] [MainThread]: 
[0m14:45:26.741732 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/scaffold_dm.sql
[0m14:45:26.742135 [info ] [MainThread]: 
[0m14:45:26.742507 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:45:26.743410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1142231, "process_in_blocks": "0", "process_kernel_time": 0.271613, "process_mem_max_rss": "149136", "process_out_blocks": "1968", "process_user_time": 1.685402}
[0m14:45:26.744164 [debug] [MainThread]: Command `dbt run` failed at 14:45:26.743814 after 1.12 seconds
[0m14:45:26.744524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f27b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f13f5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3f247c430>]}
[0m14:45:26.744880 [debug] [MainThread]: Flushing usage events
[0m14:45:27.101097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:22.715771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d70142d35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d70130553f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7013055390>]}


============================== 15:04:22.718130 | c64122fc-794b-4d5c-bb4f-0c7c562dfd55 ==============================
[0m15:04:22.718130 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:04:22.718817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:04:22.834097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c64122fc-794b-4d5c-bb4f-0c7c562dfd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d701304d030>]}
[0m15:04:22.850785 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18151939, "process_in_blocks": "240", "process_kernel_time": 0.121288, "process_mem_max_rss": "98592", "process_out_blocks": "8", "process_user_time": 1.152236}
[0m15:04:22.851415 [debug] [MainThread]: Command `dbt clean` succeeded at 15:04:22.851299 after 0.18 seconds
[0m15:04:22.851864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d70142d35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d701304ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d701304d030>]}
[0m15:04:22.852302 [debug] [MainThread]: Flushing usage events
[0m15:04:23.199919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:30.903247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8ec9b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8dac0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8dac01f0>]}


============================== 15:04:30.906406 | bcfd92ae-a209-403a-85a0-cac4f88dac00 ==============================
[0m15:04:30.906406 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:04:30.907187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'profiles_dir': '/home/mlogan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:31.120084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d903562f0>]}
[0m15:04:31.182915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8dc62350>]}
[0m15:04:31.186325 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:04:31.292910 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:04:31.293559 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:04:31.294099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d89aa0820>]}
[0m15:04:32.606488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d89040130>]}
[0m15:04:32.741039 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:04:32.742569 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:04:32.751535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8eef3610>]}
[0m15:04:32.752067 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:04:32.752616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8f8c81f0>]}
[0m15:04:32.753963 [info ] [MainThread]: 
[0m15:04:32.754377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:32.754737 [info ] [MainThread]: 
[0m15:04:32.755465 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:04:32.759625 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:04:32.860822 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:04:32.861390 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:04:32.861741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:32.873472 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:04:32.874954 [debug] [ThreadPool]: On list_dev: Close
[0m15:04:32.875735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:04:32.876225 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:04:32.883596 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:32.884027 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:04:32.884349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:32.885324 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:32.886493 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:32.886822 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:04:32.887289 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:32.887590 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:32.887895 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:04:32.888334 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:32.889098 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:32.889417 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:04:32.889697 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:04:32.890118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:04:32.890443 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:04:32.891840 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:04:32.897476 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:32.897881 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:04:32.898193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:32.898812 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:04:32.899133 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:04:32.899435 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:04:32.908394 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:04:32.909821 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:04:32.910402 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:04:32.910728 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:04:32.911938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d89108760>]}
[0m15:04:32.913747 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:32.914213 [debug] [MainThread]: On master: BEGIN
[0m15:04:32.914582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:32.915648 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:04:32.917311 [debug] [MainThread]: On master: COMMIT
[0m15:04:32.917699 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:32.918010 [debug] [MainThread]: On master: COMMIT
[0m15:04:32.918550 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:32.918834 [debug] [MainThread]: On master: Close
[0m15:04:32.920639 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m15:04:32.921189 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:04:32.921900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m15:04:32.922286 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m15:04:32.931323 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.932453 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m15:04:32.965025 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.966236 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.967801 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m15:04:32.968240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:32.969274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:32.969709 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.970115 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:04:32.971318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:32.981610 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.983132 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:04:32.984362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:32.989942 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:32.990499 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:04:32.991322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:33.007029 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:04:33.007693 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:33.008095 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:04:33.013318 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:04:33.019095 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:04:33.019546 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m15:04:33.023312 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:33.025662 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m15:04:33.027384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d90357610>]}
[0m15:04:33.028023 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m15:04:33.028725 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m15:04:33.029161 [debug] [Thread-1 (]: Began running node model.VEXIN_03.scaffold_dm
[0m15:04:33.029731 [info ] [Thread-1 (]: 2 of 3 START sql view model main.scaffold_dm ................................... [RUN]
[0m15:04:33.030289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.scaffold_dm)
[0m15:04:33.031751 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.scaffold_dm
[0m15:04:33.035205 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.scaffold_dm"
[0m15:04:33.035902 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.scaffold_dm
[0m15:04:33.050503 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.scaffold_dm"
[0m15:04:33.051504 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:04:33.052639 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: BEGIN
[0m15:04:33.053041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:33.053789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:33.054126 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:04:33.054508 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:04:33.056956 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:04:33.057424 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:04:33.057895 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: ROLLBACK
[0m15:04:33.059318 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.scaffold_dm'
[0m15:04:33.059673 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: Close
[0m15:04:33.060479 [debug] [Thread-1 (]: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:04:33.060977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d89658c70>]}
[0m15:04:33.061535 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.scaffold_dm .......................... [[31mERROR[0m in 0.03s]
[0m15:04:33.062248 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.scaffold_dm
[0m15:04:33.062932 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m15:04:33.063287 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.scaffold_dm' to be skipped because of status 'error'.  Reason: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m15:04:33.063727 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:04:33.065154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.scaffold_dm, now model.VEXIN_03.my_second_dbt_model)
[0m15:04:33.065488 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m15:04:33.068020 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.068610 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m15:04:33.071181 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.071790 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.072110 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m15:04:33.072398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:33.073064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:33.073371 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.075814 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:04:33.077049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:33.082234 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.082764 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:04:33.083780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:04:33.088673 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.089125 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:04:33.089863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:04:33.091044 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:04:33.091396 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.091692 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:04:33.095507 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:04:33.101980 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:04:33.102667 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m15:04:33.116551 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:04:33.118465 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m15:04:33.119286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfd92ae-a209-403a-85a0-cac4f88dac00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8ed61a20>]}
[0m15:04:33.119940 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m15:04:33.120748 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m15:04:33.121798 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:33.122156 [debug] [MainThread]: On master: BEGIN
[0m15:04:33.122459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:33.123104 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:04:33.123408 [debug] [MainThread]: On master: COMMIT
[0m15:04:33.123707 [debug] [MainThread]: Using duckdb connection "master"
[0m15:04:33.124038 [debug] [MainThread]: On master: COMMIT
[0m15:04:33.124480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:04:33.124788 [debug] [MainThread]: On master: Close
[0m15:04:33.125233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:33.125527 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m15:04:33.125787 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m15:04:33.126174 [info ] [MainThread]: 
[0m15:04:33.126621 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:04:33.127764 [debug] [MainThread]: Command end result
[0m15:04:33.160911 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:04:33.164850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:04:33.174765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m15:04:33.175535 [info ] [MainThread]: 
[0m15:04:33.176091 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:33.176549 [info ] [MainThread]: 
[0m15:04:33.176950 [error] [MainThread]: [31mFailure in model scaffold_dm (models/sdtm/scaffold_dm.sql)[0m
[0m15:04:33.177345 [error] [MainThread]:   Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:04:33.177690 [info ] [MainThread]: 
[0m15:04:33.178038 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/scaffold_dm.sql
[0m15:04:33.178414 [info ] [MainThread]: 
[0m15:04:33.178744 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:04:33.179713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3341117, "process_in_blocks": "144", "process_kernel_time": 0.391691, "process_mem_max_rss": "155076", "process_out_blocks": "2864", "process_user_time": 2.875182}
[0m15:04:33.180144 [debug] [MainThread]: Command `dbt run` failed at 15:04:33.180040 after 2.33 seconds
[0m15:04:33.180780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8ec9b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8931a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3d8ebd2530>]}
[0m15:04:33.181143 [debug] [MainThread]: Flushing usage events
[0m15:04:33.510923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:18.013275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db15b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db0334280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db0334220>]}


============================== 15:09:18.015755 | cd2bcc8b-530c-421f-a73e-a1fee975d381 ==============================
[0m15:09:18.015755 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:09:18.016458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:09:18.203120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db0bc7b50>]}
[0m15:09:18.265819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db02425f0>]}
[0m15:09:18.267677 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:09:18.358053 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:09:18.474057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:18.474543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:18.526709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708dabf59ab0>]}
[0m15:09:18.605778 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:09:18.609021 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:09:18.622054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708dabf597b0>]}
[0m15:09:18.622670 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:09:18.623239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708dabf59810>]}
[0m15:09:18.624660 [info ] [MainThread]: 
[0m15:09:18.625318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:18.625696 [info ] [MainThread]: 
[0m15:09:18.626244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:18.630749 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:09:18.717345 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:09:18.718093 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:09:18.718490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:18.733525 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:09:18.735101 [debug] [ThreadPool]: On list_dev: Close
[0m15:09:18.735957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:09:18.736442 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:09:18.743821 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:09:18.744335 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:09:18.744680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:18.745832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:18.747180 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:09:18.747536 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:09:18.748008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:18.748302 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:09:18.748594 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:09:18.749018 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:18.749756 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:09:18.750066 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:09:18.750343 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:09:18.750763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:09:18.751067 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:09:18.752461 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:09:18.757803 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:09:18.758189 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:09:18.758515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:18.759047 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:09:18.759349 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:09:18.759599 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:09:18.767633 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:09:18.768946 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:09:18.769533 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:09:18.769850 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:09:18.770884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db2cab160>]}
[0m15:09:18.771349 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:18.771613 [debug] [MainThread]: On master: BEGIN
[0m15:09:18.771846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:18.772351 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:18.772612 [debug] [MainThread]: On master: COMMIT
[0m15:09:18.772855 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:18.773109 [debug] [MainThread]: On master: COMMIT
[0m15:09:18.773451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:18.773714 [debug] [MainThread]: On master: Close
[0m15:09:18.776424 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m15:09:18.777119 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:09:18.777840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m15:09:18.778176 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m15:09:18.787326 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.791058 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m15:09:18.823864 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.825249 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.825695 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m15:09:18.826013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:18.826740 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:18.827127 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.827644 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:09:18.828637 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:18.833432 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.833809 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:09:18.834461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:18.836610 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.837065 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:09:18.837584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:18.856705 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:09:18.857380 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.857727 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:09:18.862815 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:09:18.867201 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:09:18.867564 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m15:09:18.870647 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:09:18.872659 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m15:09:18.874227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db2bc76a0>]}
[0m15:09:18.874782 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m15:09:18.875459 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m15:09:18.875795 [debug] [Thread-1 (]: Began running node model.VEXIN_03.scaffold_dm
[0m15:09:18.876327 [info ] [Thread-1 (]: 2 of 3 START sql view model main.scaffold_dm ................................... [RUN]
[0m15:09:18.876820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.scaffold_dm)
[0m15:09:18.877208 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.scaffold_dm
[0m15:09:18.887365 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.scaffold_dm"
[0m15:09:18.895122 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.scaffold_dm
[0m15:09:18.916691 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.scaffold_dm"
[0m15:09:18.918189 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:09:18.918637 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: BEGIN
[0m15:09:18.918946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:18.919698 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:18.920011 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:09:18.920358 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:09:18.921837 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:09:18.922204 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:09:18.922857 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: ROLLBACK
[0m15:09:18.924267 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.scaffold_dm'
[0m15:09:18.924688 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: Close
[0m15:09:18.925496 [debug] [Thread-1 (]: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:09:18.925969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db1321c30>]}
[0m15:09:18.926572 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.scaffold_dm .......................... [[31mERROR[0m in 0.05s]
[0m15:09:18.927239 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.scaffold_dm
[0m15:09:18.927618 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m15:09:18.927955 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.scaffold_dm' to be skipped because of status 'error'.  Reason: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m15:09:18.928452 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:09:18.929684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.scaffold_dm, now model.VEXIN_03.my_second_dbt_model)
[0m15:09:18.930021 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m15:09:18.932444 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.933587 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m15:09:18.936082 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.939528 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.940005 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m15:09:18.940329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:18.941059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:09:18.941389 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.941675 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:09:18.942342 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:18.946630 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.947147 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:09:18.947856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:18.950157 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.950491 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:09:18.951063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:09:18.952071 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:09:18.952407 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.952664 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:09:18.956804 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:09:18.958889 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:09:18.959242 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m15:09:18.962349 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:09:18.963570 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m15:09:18.964209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd2bcc8b-530c-421f-a73e-a1fee975d381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db1601a80>]}
[0m15:09:18.964797 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.03s]
[0m15:09:18.965240 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m15:09:18.966608 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:18.966876 [debug] [MainThread]: On master: BEGIN
[0m15:09:18.967099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:18.967618 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:18.967863 [debug] [MainThread]: On master: COMMIT
[0m15:09:18.968088 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:18.968301 [debug] [MainThread]: On master: COMMIT
[0m15:09:18.968681 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:09:18.968916 [debug] [MainThread]: On master: Close
[0m15:09:18.969247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:18.969479 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m15:09:18.969666 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m15:09:18.969921 [info ] [MainThread]: 
[0m15:09:18.970399 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:09:18.971190 [debug] [MainThread]: Command end result
[0m15:09:18.993502 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:09:18.996463 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:09:19.006484 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m15:09:19.007057 [info ] [MainThread]: 
[0m15:09:19.007717 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:19.008120 [info ] [MainThread]: 
[0m15:09:19.008505 [error] [MainThread]: [31mFailure in model scaffold_dm (models/sdtm/scaffold_dm.sql)[0m
[0m15:09:19.009084 [error] [MainThread]:   Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:09:19.009429 [info ] [MainThread]: 
[0m15:09:19.009790 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/scaffold_dm.sql
[0m15:09:19.010098 [info ] [MainThread]: 
[0m15:09:19.010415 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:09:19.011213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0468749, "process_in_blocks": "0", "process_kernel_time": 0.327807, "process_mem_max_rss": "148968", "process_out_blocks": "2000", "process_user_time": 1.718992}
[0m15:09:19.011636 [debug] [MainThread]: Command `dbt run` failed at 15:09:19.011531 after 1.05 seconds
[0m15:09:19.012170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708db15b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708dabf16440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708dab242470>]}
[0m15:09:19.013460 [debug] [MainThread]: Flushing usage events
[0m15:09:19.364469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:40.205789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478888b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747887634250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478876341f0>]}


============================== 15:10:40.208264 | 8b671244-9e50-4663-b102-b1d716ae76a2 ==============================
[0m15:10:40.208264 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:10:40.208956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:40.387026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747889e562f0>]}
[0m15:10:40.436755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478875d2350>]}
[0m15:10:40.438429 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:10:40.520663 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:10:40.655723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:40.656261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:40.720025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747883255a20>]}
[0m15:10:40.817718 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:10:40.819935 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:10:40.829239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747883255780>]}
[0m15:10:40.829771 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:10:40.830325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478832557b0>]}
[0m15:10:40.831714 [info ] [MainThread]: 
[0m15:10:40.832160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:40.832486 [info ] [MainThread]: 
[0m15:10:40.832997 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:10:40.837798 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:10:40.924747 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:10:40.925319 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:10:40.925668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:40.937165 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:10:40.938553 [debug] [ThreadPool]: On list_dev: Close
[0m15:10:40.939345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:10:40.939861 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:10:40.947394 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:10:40.947856 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:10:40.948186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:40.949162 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:10:40.950324 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:10:40.950666 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:10:40.951108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:10:40.951435 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:10:40.951723 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:10:40.952148 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:10:40.952853 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:10:40.953138 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:10:40.953416 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:10:40.954200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:10:40.954541 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:10:40.955972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:10:40.961189 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:10:40.961553 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:10:40.961858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:40.962456 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:10:40.962797 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:10:40.963107 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:10:40.972735 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m15:10:40.974195 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:10:40.975884 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:10:40.976237 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:10:40.979213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747889f670d0>]}
[0m15:10:40.979849 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:40.980211 [debug] [MainThread]: On master: BEGIN
[0m15:10:40.980537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:40.981230 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:10:40.981549 [debug] [MainThread]: On master: COMMIT
[0m15:10:40.981803 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:40.982038 [debug] [MainThread]: On master: COMMIT
[0m15:10:40.982460 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:10:40.982730 [debug] [MainThread]: On master: Close
[0m15:10:40.984466 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m15:10:40.984959 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:10:40.986843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m15:10:40.987379 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m15:10:40.994953 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m15:10:40.996607 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m15:10:41.028171 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.030866 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.031418 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m15:10:41.031803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:41.032642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:10:41.033053 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.033571 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:10:41.035203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:10:41.042924 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.043460 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:10:41.044306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:10:41.048677 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.049301 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:10:41.053198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:10:41.066613 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:10:41.067222 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.067593 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:10:41.072439 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:10:41.076828 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:10:41.077230 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m15:10:41.080758 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:10:41.084222 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m15:10:41.085917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747889e57610>]}
[0m15:10:41.086522 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m15:10:41.087227 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m15:10:41.087571 [debug] [Thread-1 (]: Began running node model.VEXIN_03.scaffold_dm
[0m15:10:41.088113 [info ] [Thread-1 (]: 2 of 3 START sql view model main.scaffold_dm ................................... [RUN]
[0m15:10:41.088602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.scaffold_dm)
[0m15:10:41.088934 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.scaffold_dm
[0m15:10:41.092498 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.scaffold_dm"
[0m15:10:41.095589 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.scaffold_dm
[0m15:10:41.109064 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.scaffold_dm"
[0m15:10:41.110264 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:10:41.110638 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: BEGIN
[0m15:10:41.110924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:41.111576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:10:41.111871 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:10:41.112278 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:10:41.113660 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC IS NULL OR TRIM(RFICDTC) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:10:41.114047 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:10:41.114413 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: ROLLBACK
[0m15:10:41.115866 [debug] [Thread-1 (]: Failed to rollback 'model.VEXIN_03.scaffold_dm'
[0m15:10:41.116137 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: Close
[0m15:10:41.116877 [debug] [Thread-1 (]: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:10:41.117348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747882540e80>]}
[0m15:10:41.117845 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.scaffold_dm .......................... [[31mERROR[0m in 0.03s]
[0m15:10:41.118531 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.scaffold_dm
[0m15:10:41.118866 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m15:10:41.119181 [debug] [Thread-4 (]: Marking all children of 'model.VEXIN_03.scaffold_dm' to be skipped because of status 'error'.  Reason: Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m15:10:41.119646 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:10:41.120688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.scaffold_dm, now model.VEXIN_03.my_second_dbt_model)
[0m15:10:41.120961 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m15:10:41.123094 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.124237 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m15:10:41.127465 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.128795 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.129197 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m15:10:41.129571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:41.130284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:10:41.130626 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.130970 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:10:41.131646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:10:41.135372 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.140716 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:10:41.141743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:10:41.153116 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.157667 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:10:41.159712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:10:41.160937 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:10:41.161312 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.161657 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:10:41.167026 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:10:41.170294 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:10:41.170769 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m15:10:41.174261 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:10:41.175646 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m15:10:41.176371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b671244-9e50-4663-b102-b1d716ae76a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747889e57610>]}
[0m15:10:41.177017 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m15:10:41.177773 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m15:10:41.179295 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:41.180096 [debug] [MainThread]: On master: BEGIN
[0m15:10:41.180593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:41.181534 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:10:41.181905 [debug] [MainThread]: On master: COMMIT
[0m15:10:41.182271 [debug] [MainThread]: Using duckdb connection "master"
[0m15:10:41.182606 [debug] [MainThread]: On master: COMMIT
[0m15:10:41.183083 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:10:41.183401 [debug] [MainThread]: On master: Close
[0m15:10:41.183923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:41.184205 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m15:10:41.184485 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m15:10:41.184845 [info ] [MainThread]: 
[0m15:10:41.185355 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:10:41.186299 [debug] [MainThread]: Command end result
[0m15:10:41.219035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:10:41.221368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:10:41.227204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m15:10:41.227497 [info ] [MainThread]: 
[0m15:10:41.228109 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:41.228493 [info ] [MainThread]: 
[0m15:10:41.228849 [error] [MainThread]: [31mFailure in model scaffold_dm (models/sdtm/scaffold_dm.sql)[0m
[0m15:10:41.229450 [error] [MainThread]:   Runtime Error in model scaffold_dm (models/sdtm/scaffold_dm.sql)
  Binder Error: Column "RFICDTC" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m15:10:41.231965 [info ] [MainThread]: 
[0m15:10:41.235387 [info ] [MainThread]:   compiled code at target/compiled/VEXIN_03/models/sdtm/scaffold_dm.sql
[0m15:10:41.236002 [info ] [MainThread]: 
[0m15:10:41.236473 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:10:41.237565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0810679, "process_in_blocks": "0", "process_kernel_time": 0.372027, "process_mem_max_rss": "148960", "process_out_blocks": "1992", "process_user_time": 1.632363}
[0m15:10:41.238063 [debug] [MainThread]: Command `dbt run` failed at 15:10:41.237970 after 1.08 seconds
[0m15:10:41.238536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478888b3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478875d2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747888722530>]}
[0m15:10:41.238955 [debug] [MainThread]: Flushing usage events
[0m15:10:41.586169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:51.802398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39beabf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd845540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd8454e0>]}


============================== 15:11:51.804680 | ac0bbd0f-47f6-4f6c-950f-aa9f8518e456 ==============================
[0m15:11:51.804680 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:11:51.805344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:51.984393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b994bb50>]}
[0m15:11:52.035959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bd805f90>]}
[0m15:11:52.037645 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:11:52.124460 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:11:52.238870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:52.239554 [debug] [MainThread]: Partial parsing: updated file: VEXIN_03://models/sdtm/scaffold_dm.sql
[0m15:11:52.520850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b987bbe0>]}
[0m15:11:52.593947 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:11:52.596095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:11:52.605494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b951a110>]}
[0m15:11:52.606001 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 430 macros
[0m15:11:52.606517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b9518e50>]}
[0m15:11:52.607931 [info ] [MainThread]: 
[0m15:11:52.608359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:52.608736 [info ] [MainThread]: 
[0m15:11:52.609211 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:52.613368 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:11:52.641565 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:11:52.642055 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m15:11:52.642351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:52.657218 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:11:52.658671 [debug] [ThreadPool]: On list_dev: Close
[0m15:11:52.659484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m15:11:52.660003 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m15:11:52.670234 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:52.670792 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m15:11:52.671184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:52.672266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:52.673472 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:52.673783 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m15:11:52.674265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:52.674565 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:52.674853 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m15:11:52.675347 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:52.676153 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:11:52.676470 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m15:11:52.676761 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m15:11:52.677193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:52.677531 [debug] [ThreadPool]: On create_dev_main: Close
[0m15:11:52.680904 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m15:11:52.691359 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:52.691971 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m15:11:52.692321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:52.693070 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:11:52.693389 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m15:11:52.693700 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m15:11:52.701733 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:11:52.703040 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m15:11:52.703623 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m15:11:52.703929 [debug] [ThreadPool]: On list_dev_main: Close
[0m15:11:52.705030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39bda698d0>]}
[0m15:11:52.705544 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:52.705846 [debug] [MainThread]: On master: BEGIN
[0m15:11:52.706154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:52.706703 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:11:52.707008 [debug] [MainThread]: On master: COMMIT
[0m15:11:52.707353 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:52.707625 [debug] [MainThread]: On master: COMMIT
[0m15:11:52.708041 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:11:52.708357 [debug] [MainThread]: On master: Close
[0m15:11:52.710244 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_first_dbt_model
[0m15:11:52.710829 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:11:52.711503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.my_first_dbt_model)
[0m15:11:52.711878 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_first_dbt_model
[0m15:11:52.720291 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.722091 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_first_dbt_model
[0m15:11:52.805316 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.808220 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.808785 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: BEGIN
[0m15:11:52.809220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:52.810132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.810563 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.810957 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:11:52.814058 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:11:52.822495 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.823271 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:11:52.824270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.828606 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.829374 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:11:52.831394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.849540 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:11:52.850318 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.850813 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: COMMIT
[0m15:11:52.858041 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:11:52.864914 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_first_dbt_model"
[0m15:11:52.865551 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_first_dbt_model"} */

      drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m15:11:52.868561 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:11:52.871177 [debug] [Thread-1 (]: On model.VEXIN_03.my_first_dbt_model: Close
[0m15:11:52.873150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39c01236a0>]}
[0m15:11:52.873846 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.16s]
[0m15:11:52.875092 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_first_dbt_model
[0m15:11:52.875487 [debug] [Thread-1 (]: Began running node model.VEXIN_03.scaffold_dm
[0m15:11:52.876124 [info ] [Thread-1 (]: 2 of 3 START sql view model main.scaffold_dm ................................... [RUN]
[0m15:11:52.876669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.my_first_dbt_model, now model.VEXIN_03.scaffold_dm)
[0m15:11:52.877052 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.scaffold_dm
[0m15:11:52.880644 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.scaffold_dm"
[0m15:11:52.882196 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.scaffold_dm
[0m15:11:52.897673 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.scaffold_dm"
[0m15:11:52.899195 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:11:52.899710 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: BEGIN
[0m15:11:52.900125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:52.900915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.901290 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:11:52.901708 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

  
  create view "dev"."main"."scaffold_dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC_RAW IS NULL OR TRIM(RFICDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m15:11:52.903224 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.907146 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:11:52.907811 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */
alter view "dev"."main"."scaffold_dm__dbt_tmp" rename to "scaffold_dm"
[0m15:11:52.909170 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.910674 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: COMMIT
[0m15:11:52.911133 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:11:52.911469 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: COMMIT
[0m15:11:52.915760 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:11:52.919151 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.scaffold_dm"
[0m15:11:52.919837 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.scaffold_dm"} */

      drop view if exists "dev"."main"."scaffold_dm__dbt_backup" cascade
    
[0m15:11:52.921134 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.924153 [debug] [Thread-1 (]: On model.VEXIN_03.scaffold_dm: Close
[0m15:11:52.925101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b84696c0>]}
[0m15:11:52.925785 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.scaffold_dm .............................. [[32mOK[0m in 0.05s]
[0m15:11:52.926521 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.scaffold_dm
[0m15:11:52.926888 [debug] [Thread-1 (]: Began running node model.VEXIN_03.my_second_dbt_model
[0m15:11:52.927569 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:11:52.932341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.VEXIN_03.scaffold_dm, now model.VEXIN_03.my_second_dbt_model)
[0m15:11:52.933313 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.my_second_dbt_model
[0m15:11:52.940215 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.942139 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.my_second_dbt_model
[0m15:11:52.945118 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.947259 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.947945 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: BEGIN
[0m15:11:52.948258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:52.949783 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.950294 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.950792 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:11:52.952071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:11:52.955776 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.956184 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:11:52.956919 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:52.960075 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.960472 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:11:52.961148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:52.962512 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:11:52.963052 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.964923 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: COMMIT
[0m15:11:52.968618 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:11:52.972164 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.my_second_dbt_model"
[0m15:11:52.973126 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.my_second_dbt_model"} */

      drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m15:11:52.978557 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:11:52.982085 [debug] [Thread-1 (]: On model.VEXIN_03.my_second_dbt_model: Close
[0m15:11:52.983342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0bbd0f-47f6-4f6c-950f-aa9f8518e456', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b84696c0>]}
[0m15:11:52.984154 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m15:11:52.985022 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.my_second_dbt_model
[0m15:11:52.986155 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:52.986495 [debug] [MainThread]: On master: BEGIN
[0m15:11:52.986769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:52.987357 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:11:52.987652 [debug] [MainThread]: On master: COMMIT
[0m15:11:52.987932 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:52.988180 [debug] [MainThread]: On master: COMMIT
[0m15:11:52.988613 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:11:52.988881 [debug] [MainThread]: On master: Close
[0m15:11:52.989266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:52.989579 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m15:11:52.989789 [debug] [MainThread]: Connection 'model.VEXIN_03.my_second_dbt_model' was properly closed.
[0m15:11:52.990103 [info ] [MainThread]: 
[0m15:11:52.991169 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:11:52.992095 [debug] [MainThread]: Command end result
[0m15:11:53.020026 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m15:11:53.024649 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m15:11:53.033686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m15:11:53.034418 [info ] [MainThread]: 
[0m15:11:53.044984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:53.045753 [info ] [MainThread]: 
[0m15:11:53.046645 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:11:53.048408 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2936951, "process_in_blocks": "0", "process_kernel_time": 0.392482, "process_mem_max_rss": "149584", "process_out_blocks": "2888", "process_user_time": 1.805418}
[0m15:11:53.049498 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:53.049336 after 1.30 seconds
[0m15:11:53.050040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39beabf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39b9949630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39be783c40>]}
[0m15:11:53.050426 [debug] [MainThread]: Flushing usage events
[0m15:11:53.408787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:57.135163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289bcb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289aa30280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289aa30220>]}


============================== 20:24:57.137730 | c9b06565-2c26-4902-b405-2d2c6d8e7005 ==============================
[0m20:24:57.137730 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:24:57.138379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:57.383154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289b2c3bb0>]}
[0m20:24:57.466630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782896b865f0>]}
[0m20:24:57.470919 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:24:57.723250 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m20:24:57.847591 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:24:57.848353 [debug] [MainThread]: previous checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, current checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2
[0m20:24:57.848715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289b267ac0>]}
[0m20:24:58.863539 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m20:24:58.865513 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m20:24:58.971583 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.VEXIN_03.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m20:24:58.972398 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.VEXIN_03.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m20:24:58.972939 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.VEXIN_03.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:24:58.973352 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.VEXIN_03.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:24:59.056502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.example
[0m20:24:59.061970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828960784f0>]}
[0m20:24:59.212551 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:24:59.217053 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:24:59.229617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828962f3370>]}
[0m20:24:59.230166 [info ] [MainThread]: Found 2 models, 1 seed, 430 macros
[0m20:24:59.230687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289c807580>]}
[0m20:24:59.231871 [info ] [MainThread]: 
[0m20:24:59.232375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:59.232723 [info ] [MainThread]: 
[0m20:24:59.233215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:24:59.234309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:24:59.287810 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:24:59.288642 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:24:59.289105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:59.304560 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:24:59.305998 [debug] [ThreadPool]: On list_dev: Close
[0m20:24:59.306801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:24:59.307276 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:24:59.313686 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:59.314064 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:24:59.314360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:59.315262 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:59.316546 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:59.316872 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:24:59.317335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:59.317652 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:59.317933 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:24:59.318997 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:59.319746 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:24:59.320475 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:24:59.321674 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:24:59.322252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:24:59.322564 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:24:59.327678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m20:24:59.333738 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:59.334232 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:24:59.334559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:59.335236 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:24:59.335563 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:24:59.335803 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:24:59.344466 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:24:59.345645 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:24:59.346154 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:24:59.346483 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:24:59.347671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289d0b09d0>]}
[0m20:24:59.348117 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:59.348433 [debug] [MainThread]: On master: BEGIN
[0m20:24:59.348702 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:59.349231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:59.349564 [debug] [MainThread]: On master: COMMIT
[0m20:24:59.349851 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:59.350147 [debug] [MainThread]: On master: COMMIT
[0m20:24:59.350946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:59.351262 [debug] [MainThread]: On master: Close
[0m20:24:59.352956 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m20:24:59.353500 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m20:24:59.354140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m20:24:59.354491 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m20:24:59.362407 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m20:24:59.363068 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m20:24:59.405190 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m20:24:59.406177 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:24:59.406575 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m20:24:59.406932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:59.407710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:59.408096 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:24:59.408498 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC_RAW IS NULL OR TRIM(RFICDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m20:24:59.410003 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:24:59.416982 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:24:59.417519 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m20:24:59.418361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:59.428678 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:24:59.429271 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:24:59.429660 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:24:59.436052 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:24:59.440949 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:24:59.441405 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m20:24:59.442092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:24:59.444383 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m20:24:59.446422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9b06565-2c26-4902-b405-2d2c6d8e7005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828965557b0>]}
[0m20:24:59.447048 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.09s]
[0m20:24:59.447723 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m20:24:59.448697 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:59.449030 [debug] [MainThread]: On master: BEGIN
[0m20:24:59.449324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:59.449934 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:24:59.450205 [debug] [MainThread]: On master: COMMIT
[0m20:24:59.450463 [debug] [MainThread]: Using duckdb connection "master"
[0m20:24:59.450704 [debug] [MainThread]: On master: COMMIT
[0m20:24:59.451112 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:24:59.451377 [debug] [MainThread]: On master: Close
[0m20:24:59.451755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:59.452047 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m20:24:59.452282 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m20:24:59.452542 [info ] [MainThread]: 
[0m20:24:59.452981 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m20:24:59.453582 [debug] [MainThread]: Command end result
[0m20:24:59.473132 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:24:59.475743 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:24:59.487323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m20:24:59.487963 [info ] [MainThread]: 
[0m20:24:59.488600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:59.489009 [info ] [MainThread]: 
[0m20:24:59.489403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:24:59.490367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4070194, "process_in_blocks": "0", "process_kernel_time": 0.743294, "process_mem_max_rss": "151724", "process_out_blocks": "2776", "process_user_time": 2.808001}
[0m20:24:59.490789 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:59.490704 after 2.41 seconds
[0m20:24:59.491124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78289bcb3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828968492a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782896299f90>]}
[0m20:24:59.491512 [debug] [MainThread]: Flushing usage events
[0m20:24:59.859774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:03.643379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb42bf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb30482b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb3048250>]}


============================== 20:27:03.645653 | eaa6e367-b389-4ec5-a3a8-6221d6204944 ==============================
[0m20:27:03.645653 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:27:03.646497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/mlogan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'send_anonymous_usage_stats': 'True'}
[0m20:27:03.838489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb412d150>]}
[0m20:27:03.887843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb38a5390>]}
[0m20:27:03.889589 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:27:03.977679 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m20:27:04.104796 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:27:04.169134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.VEXIN_03.example
[0m20:27:04.173991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafaec78d30>]}
[0m20:27:04.256540 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:27:04.258627 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:27:04.267582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafaedd7940>]}
[0m20:27:04.268077 [info ] [MainThread]: Found 2 models, 1 seed, 430 macros
[0m20:27:04.268600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafaedd7850>]}
[0m20:27:04.270016 [info ] [MainThread]: 
[0m20:27:04.270463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:04.270806 [info ] [MainThread]: 
[0m20:27:04.271358 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:27:04.272108 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:27:04.357397 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:27:04.358771 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:27:04.359318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:04.371015 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:27:04.372518 [debug] [ThreadPool]: On list_dev: Close
[0m20:27:04.373313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:27:04.373813 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:27:04.380634 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:27:04.381018 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:27:04.381360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:04.382291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:04.383459 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:27:04.383843 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:27:04.384274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:04.384536 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:27:04.384775 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:27:04.385168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:04.385856 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:27:04.386158 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:27:04.386720 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:27:04.387132 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:27:04.387451 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:27:04.392966 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m20:27:04.398676 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:27:04.399126 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:27:04.399446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:04.400181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:27:04.400525 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:27:04.400831 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:27:04.409240 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:27:04.410598 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:27:04.411145 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:27:04.411470 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:27:04.412748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafaec8cb50>]}
[0m20:27:04.413227 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:04.413501 [debug] [MainThread]: On master: BEGIN
[0m20:27:04.413746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:04.414269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:27:04.414550 [debug] [MainThread]: On master: COMMIT
[0m20:27:04.414809 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:04.415074 [debug] [MainThread]: On master: COMMIT
[0m20:27:04.415437 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:27:04.415708 [debug] [MainThread]: On master: Close
[0m20:27:04.417503 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m20:27:04.418709 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m20:27:04.419343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly create_dev_main, now model.VEXIN_03.dm)
[0m20:27:04.419682 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m20:27:04.431007 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m20:27:04.434350 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m20:27:04.469816 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m20:27:04.471549 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.472022 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m20:27:04.472417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:04.473278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:04.473713 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.474143 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC_RAW IS NULL OR TRIM(RFICDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m20:27:04.475605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:27:04.485533 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.486145 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m20:27:04.487053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:27:04.490009 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.490411 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m20:27:04.491025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:27:04.503083 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:27:04.504023 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.504482 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:27:04.510249 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:27:04.516080 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:27:04.516617 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m20:27:04.519606 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:27:04.522075 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m20:27:04.523890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaa6e367-b389-4ec5-a3a8-6221d6204944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb5923670>]}
[0m20:27:04.524522 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.10s]
[0m20:27:04.525443 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m20:27:04.526446 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:04.526741 [debug] [MainThread]: On master: BEGIN
[0m20:27:04.527022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:04.527573 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:27:04.527863 [debug] [MainThread]: On master: COMMIT
[0m20:27:04.528121 [debug] [MainThread]: Using duckdb connection "master"
[0m20:27:04.528362 [debug] [MainThread]: On master: COMMIT
[0m20:27:04.528756 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:27:04.529032 [debug] [MainThread]: On master: Close
[0m20:27:04.529420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:04.529688 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m20:27:04.529945 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m20:27:04.530205 [info ] [MainThread]: 
[0m20:27:04.530736 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:27:04.531454 [debug] [MainThread]: Command end result
[0m20:27:04.568516 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:27:04.571370 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:27:04.578054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m20:27:04.578434 [info ] [MainThread]: 
[0m20:27:04.579214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:04.579640 [info ] [MainThread]: 
[0m20:27:04.580046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:27:04.580896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9862276, "process_in_blocks": "584", "process_kernel_time": 0.359978, "process_mem_max_rss": "145496", "process_out_blocks": "2728", "process_user_time": 1.607544}
[0m20:27:04.581378 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:04.581292 after 0.99 seconds
[0m20:27:04.581783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb42bf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb59222f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bafb3f81180>]}
[0m20:27:04.582164 [debug] [MainThread]: Flushing usage events
[0m20:27:04.938001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:53.818977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a7773bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a776144430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a7761443d0>]}


============================== 20:28:53.821599 | d1b4e9b8-7837-4433-a89b-f505cdfa0a32 ==============================
[0m20:28:53.821599 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:28:53.822371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/mlogan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dm --vars {domain: "DM"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:28:54.002563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a775fec040>]}
[0m20:28:54.049826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a776365d50>]}
[0m20:28:54.051266 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m20:28:54.139229 [debug] [MainThread]: checksum: 455d2785864b255c1e18478d807791fa13e291e6db4b43cd46302e63ccbd543d, vars: {'domain': 'DM'}, profile: , target: , version: 1.10.4
[0m20:28:54.233436 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:28:54.234240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a771f8a710>]}
[0m20:28:55.176953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a771a7f6d0>]}
[0m20:28:55.234061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:28:55.236003 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:28:55.245677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a771965120>]}
[0m20:28:55.246185 [info ] [MainThread]: Found 2 models, 1 seed, 430 macros
[0m20:28:55.246703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a771ac94b0>]}
[0m20:28:55.247835 [info ] [MainThread]: 
[0m20:28:55.248255 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:55.248593 [info ] [MainThread]: 
[0m20:28:55.249085 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:28:55.249916 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m20:28:55.288369 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m20:28:55.288890 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m20:28:55.289222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:55.305016 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:28:55.306760 [debug] [ThreadPool]: On list_dev: Close
[0m20:28:55.307535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m20:28:55.307988 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m20:28:55.313324 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:55.313659 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m20:28:55.313919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:55.314779 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:28:55.315892 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:55.316278 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m20:28:55.317088 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:55.317384 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:55.317725 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m20:28:55.318134 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:55.318832 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:28:55.319102 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m20:28:55.319338 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m20:28:55.319698 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:28:55.319954 [debug] [ThreadPool]: On create_dev_main: Close
[0m20:28:55.326913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m20:28:55.332566 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:55.332975 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m20:28:55.333352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:55.334096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:28:55.334416 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m20:28:55.334706 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m20:28:55.343309 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:28:55.344850 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m20:28:55.345720 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m20:28:55.346020 [debug] [ThreadPool]: On list_dev_main: Close
[0m20:28:55.347192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a771964a90>]}
[0m20:28:55.347597 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:55.347885 [debug] [MainThread]: On master: BEGIN
[0m20:28:55.348120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:55.348626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:55.349175 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.349421 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:55.349699 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.350159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:55.350419 [debug] [MainThread]: On master: Close
[0m20:28:55.351849 [debug] [Thread-1 (]: Began running node model.VEXIN_03.dm
[0m20:28:55.352377 [info ] [Thread-1 (]: 1 of 1 START sql view model main.dm ............................................ [RUN]
[0m20:28:55.353030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.VEXIN_03.dm)
[0m20:28:55.353466 [debug] [Thread-1 (]: Began compiling node model.VEXIN_03.dm
[0m20:28:55.360516 [debug] [Thread-1 (]: Writing injected SQL for node "model.VEXIN_03.dm"
[0m20:28:55.361894 [debug] [Thread-1 (]: Began executing node model.VEXIN_03.dm
[0m20:28:55.395780 [debug] [Thread-1 (]: Writing runtime sql for node "model.VEXIN_03.dm"
[0m20:28:55.397255 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.397667 [debug] [Thread-1 (]: On model.VEXIN_03.dm: BEGIN
[0m20:28:55.397957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:55.398686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:55.398992 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.399377 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

  
  create view "dev"."main"."dm__dbt_tmp" as (
    


-- ============================================
-- Step 2: Build SDTM Domain Variables
-- ============================================
SELECT
    raw_dm.studyid AS STUDYID
    ,raw_dm.domain AS DOMAIN
    -- Injected custom: derive_usubjid.sql
    ,CASE
    WHEN prevstudy IS NULL OR TRIM(CAST(prevstudy AS VARCHAR)) = '' THEN
        CASE
            WHEN prevsubj IS NOT NULL AND TRIM(CAST(prevsubj AS VARCHAR)) <> '' THEN
                -- ERROR: prevstudy is null but prevsubj is not
                NULL
            WHEN rescreennum_raw IS NOT NULL AND TRIM(CAST(rescreennum_raw AS VARCHAR)) <> '' THEN
                CONCAT(project, '-', rescreennum_raw)
            ELSE
                CONCAT(project, '-', subject)
        END
    ELSE
        CASE
            WHEN prevsubj IS NULL OR TRIM(CAST(prevsubj AS VARCHAR)) = '' THEN
                -- ERROR: prevstudy not null but prevsubj is null
                NULL
            ELSE
                CONCAT(prevstudy, '-', prevsubj)
        END
    END AS USUBJID
    ,raw_dm.subject AS SUBJID
    ,NULL AS RFSTDTC
    ,NULL AS RFENDTC
    ,NULL AS RFXSTDTC
    ,NULL AS RFXENDTC
    ,NULL AS RFCSTDTC
    ,NULL AS RFCENDTC
    -- Injected custom: derive_rficdtc.sql
    ,
    CASE 
        WHEN RFICDTC_RAW IS NULL OR TRIM(RFICDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(RFICDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS RFICDTC
    ,NULL AS RFPENDTC
    ,NULL AS DTHDTC
    ,NULL AS DTHFL
    ,raw_dm.siteid AS SITEID
    ,NULL AS INVID
    ,NULL AS INVNAM
    -- Injected custom: derive_brthdtc.sql
    ,
    CASE 
        WHEN BRTHDTC_RAW IS NULL OR TRIM(BRTHDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(BRTHDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS BRTHDTC
    ,NULL AS AGE  -- TODO: Derived variable AGE needs a derivation
    ,NULL AS AGEU
    ,raw_dm.sex AS SEX
    -- Injected custom: derive_race.sql
    ,CASE
    WHEN COALESCE(raceoth, '') = ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) > 1
                 THEN 'MULTIPLE'
             WHEN race_aian = 1 THEN 'AMERICAN INDIAN OR ALASKA NATIVE'
             WHEN race_asian = 1 THEN 'ASIAN'
             WHEN race_black = 1 THEN 'BLACK OR AFRICAN AMERICAN'
             WHEN race_nhpi = 1 THEN 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER'
             WHEN race_white = 1 THEN 'WHITE'
             ELSE NULL
         END
    WHEN COALESCE(raceoth, '') <> ''
         THEN CASE
             WHEN COALESCE(race_aian, 0) + COALESCE(race_asian, 0) + COALESCE(race_black, 0) + COALESCE(race_nhpi, 0) + COALESCE(race_white, 0) >= 1
                 THEN 'MULTIPLE'
             ELSE 'OTHER'
         END
    END AS RACE
    ,raw_dm.ethnic AS ETHNIC
    ,NULL AS ARMCD  -- TODO: Derived variable ARMCD needs a derivation
    ,NULL AS ARM  -- TODO: Derived variable ARM needs a derivation
    ,NULL AS ACTARMCD  -- TODO: Derived variable ACTARMCD needs a derivation
    ,NULL AS ACTARM  -- TODO: Derived variable ACTARM needs a derivation
    ,NULL AS ARMNRS  -- TODO: Derived variable ARMNRS needs a derivation
    ,NULL AS ACTARMUD  -- TODO: Derived variable ACTARMUD needs a derivation
    ,raw_dm.country AS COUNTRY
    -- Injected custom: derive_dmdtc.sql
    ,
    CASE 
        WHEN DMDTC_RAW IS NULL OR TRIM(DMDTC_RAW) = '' THEN NULL
        ELSE STRFTIME(STRPTIME(DMDTC_RAW, '%m/%d/%Y'), '%Y-%m-%d')
    END
 AS DMDTC
    ,NULL AS DMDY
    ,NULL AS QVAL
    ,NULL AS DY  -- TODO: Standard derivation file missing for DY
    ,NULL AS EPOCH  -- TODO: Standard derivation file missing for EPOCH
    ,NULL AS ISSUE_FLAG_USUBJID  -- TODO: Custom derivation file missing for ISSUE_FLAG_USUBJID

FROM "dev"."main"."raw_dm"
  );

[0m20:28:55.402839 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:28:55.409758 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.410226 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm" rename to "dm__dbt_backup"
[0m20:28:55.411078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:28:55.414263 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.414605 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */
alter view "dev"."main"."dm__dbt_tmp" rename to "dm"
[0m20:28:55.415206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:28:55.475023 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:28:55.475496 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.475769 [debug] [Thread-1 (]: On model.VEXIN_03.dm: COMMIT
[0m20:28:55.481857 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:28:55.486695 [debug] [Thread-1 (]: Using duckdb connection "model.VEXIN_03.dm"
[0m20:28:55.487316 [debug] [Thread-1 (]: On model.VEXIN_03.dm: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "VEXIN_03", "target_name": "dev", "node_id": "model.VEXIN_03.dm"} */

      drop view if exists "dev"."main"."dm__dbt_backup" cascade
    
[0m20:28:55.490372 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:28:55.492375 [debug] [Thread-1 (]: On model.VEXIN_03.dm: Close
[0m20:28:55.494217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b4e9b8-7837-4433-a89b-f505cdfa0a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a777405b10>]}
[0m20:28:55.494831 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.dm ....................................... [[32mOK[0m in 0.14s]
[0m20:28:55.495512 [debug] [Thread-1 (]: Finished running node model.VEXIN_03.dm
[0m20:28:55.496483 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:55.496754 [debug] [MainThread]: On master: BEGIN
[0m20:28:55.496954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:55.497452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:55.498015 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.498265 [debug] [MainThread]: Using duckdb connection "master"
[0m20:28:55.498493 [debug] [MainThread]: On master: COMMIT
[0m20:28:55.498884 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:28:55.499155 [debug] [MainThread]: On master: Close
[0m20:28:55.499533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:55.499848 [debug] [MainThread]: Connection 'model.VEXIN_03.dm' was properly closed.
[0m20:28:55.500131 [info ] [MainThread]: 
[0m20:28:55.500849 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:28:55.501428 [debug] [MainThread]: Command end result
[0m20:28:55.523054 [debug] [MainThread]: Wrote artifact WritableManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/manifest.json
[0m20:28:55.525763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/semantic_manifest.json
[0m20:28:55.532038 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/mlogan/projects/baas/odm-2-0/studies/VEXIN-03/dbt/target/run_results.json
[0m20:28:55.532450 [info ] [MainThread]: 
[0m20:28:55.533306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:55.535091 [info ] [MainThread]: 
[0m20:28:55.535662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:28:55.537027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7709814, "process_in_blocks": "0", "process_kernel_time": 0.459194, "process_mem_max_rss": "151444", "process_out_blocks": "2728", "process_user_time": 2.29597}
[0m20:28:55.537494 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:55.537384 after 1.77 seconds
[0m20:28:55.537863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a7773bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a776901a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a77707d900>]}
[0m20:28:55.538271 [debug] [MainThread]: Flushing usage events
[0m20:28:55.909009 [debug] [MainThread]: An error was encountered while trying to flush usage events
